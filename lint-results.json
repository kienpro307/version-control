[{"filePath":"D:\\VersionControl\\my-version-manager\\eslint.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\VersionControl\\my-version-manager\\mcp-server\\src\\index.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":12,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":12,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[247,250],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[247,250],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"import/no-anonymous-default-export","severity":1,"message":"Assign object to a variable before exporting as module default","line":16,"column":1,"nodeType":"ExportDefaultDeclaration","endLine":105,"endColumn":2},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":95,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":95,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4003,4006],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4003,4006],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":107,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":107,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4373,4376],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4373,4376],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":107,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":107,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4386,4389],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4386,4389],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":107,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":107,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4399,4402],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4399,4402],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":108,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":108,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4423,4426],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4423,4426],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createClient } from '@supabase/supabase-js';\r\n\r\ninterface Env {\r\n    SUPABASE_URL: string;\r\n    SUPABASE_KEY: string;\r\n}\r\n\r\n// Simple JSON-RPC 2.0 Types\r\ninterface JsonRpcRequest {\r\n    jsonrpc: string;\r\n    method: string;\r\n    params?: any;\r\n    id?: number | string;\r\n}\r\n\r\nexport default {\r\n    async fetch(request: Request, env: Env): Promise<Response> {\r\n        // 1. Setup CORS\r\n        if (request.method === \"OPTIONS\") {\r\n            return new Response(null, {\r\n                headers: {\r\n                    \"Access-Control-Allow-Origin\": \"*\",\r\n                    \"Access-Control-Allow-Methods\": \"POST, OPTIONS\",\r\n                    \"Access-Control-Allow-Headers\": \"Content-Type\",\r\n                },\r\n            });\r\n        }\r\n\r\n        // 2. Only allow POST for JSON-RPC\r\n        if (request.method !== \"POST\") {\r\n            return new Response(\"Supabase MCP Bridge Active. Send POST requests.\", { status: 200 });\r\n        }\r\n\r\n        try {\r\n            const supabase = createClient(env.SUPABASE_URL, env.SUPABASE_KEY);\r\n            const body = await request.json() as JsonRpcRequest;\r\n\r\n            // 3. Handle Tools\r\n            if (body.method === \"tools/list\") {\r\n                return jsonRpcResponse(body.id, {\r\n                    tools: [\r\n                        {\r\n                            name: \"list_projects\",\r\n                            description: \"List all projects\",\r\n                            inputSchema: { type: \"object\", properties: {} }\r\n                        },\r\n                        {\r\n                            name: \"get_tasks\",\r\n                            description: \"Get pending tasks for a project\",\r\n                            inputSchema: {\r\n                                type: \"object\",\r\n                                properties: { projectId: { type: \"string\" } },\r\n                                required: [\"projectId\"]\r\n                            }\r\n                        },\r\n                        {\r\n                            name: \"read_context_dump\",\r\n                            description: \"Read latest context dump\",\r\n                            inputSchema: {\r\n                                type: \"object\",\r\n                                properties: { projectId: { type: \"string\" } },\r\n                                required: [\"projectId\"]\r\n                            }\r\n                        }\r\n                    ]\r\n                });\r\n            }\r\n\r\n            if (body.method === \"tools/call\") {\r\n                const { name, arguments: args } = body.params || {};\r\n\r\n                if (name === \"list_projects\") {\r\n                    const { data, error } = await supabase.from('projects').select('*');\r\n                    if (error) throw error;\r\n                    return jsonRpcResponse(body.id, { content: [{ type: \"text\", text: JSON.stringify(data, null, 2) }] });\r\n                }\r\n\r\n                if (name === \"get_tasks\") {\r\n                    const { data, error } = await supabase.from('tasks').select('*').eq('project_id', args.projectId).eq('is_done', false);\r\n                    if (error) throw error;\r\n                    return jsonRpcResponse(body.id, { content: [{ type: \"text\", text: JSON.stringify(data, null, 2) }] });\r\n                }\r\n\r\n                if (name === \"read_context_dump\") {\r\n                    const { data, error } = await supabase.from('context_dumps').select('*').eq('project_id', args.projectId).order('created_at', { ascending: false }).limit(1).single();\r\n                    if (error) return jsonRpcResponse(body.id, { content: [{ type: \"text\", text: \"No dump found\" }] });\r\n                    return jsonRpcResponse(body.id, { content: [{ type: \"text\", text: JSON.stringify(data, null, 2) }] });\r\n                }\r\n\r\n                throw new Error(`Unknown tool: ${name}`);\r\n            }\r\n\r\n            return jsonRpcResponse(body.id, null, { code: -32601, message: \"Method not found\" });\r\n\r\n        } catch (err: any) {\r\n            return new Response(JSON.stringify({\r\n                jsonrpc: \"2.0\",\r\n                error: { code: -32000, message: err.message },\r\n                id: null\r\n            }), {\r\n                headers: { \"Content-Type\": \"application/json\", \"Access-Control-Allow-Origin\": \"*\" }\r\n            });\r\n        }\r\n    }\r\n}\r\n\r\nfunction jsonRpcResponse(id: any, result: any, error?: any) {\r\n    const body: any = { jsonrpc: \"2.0\", id };\r\n    if (error) body.error = error;\r\n    else body.result = result;\r\n\r\n    return new Response(JSON.stringify(body), {\r\n        headers: { \"Content-Type\": \"application/json\", \"Access-Control-Allow-Origin\": \"*\" }\r\n    });\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\VersionControl\\my-version-manager\\next.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\VersionControl\\my-version-manager\\postcss.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\VersionControl\\my-version-manager\\scripts\\check_data.js","messages":[{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":2,"column":26,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":2,"endColumn":58}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Direct Supabase Query\r\nconst { createClient } = require('@supabase/supabase-js');\r\n\r\n// Credentials from local .env.local\r\nconst SUPABASE_URL = 'https://xggrigjnrecjtgfhjpkr.supabase.co';\r\nconst SUPABASE_KEY = 'sb_publishable_nzRdgGAk0Fvj06qJmHTDNQ_ku6K4Uju';\r\n\r\nconst PROJECT_NAME = 'All Translate React Native';\r\n\r\nasync function main() {\r\n    console.log('ðŸ” Checking for DUPLICATE projects via Supabase Direct...');\r\n\r\n    const supabase = createClient(SUPABASE_URL, SUPABASE_KEY);\r\n\r\n    // 1. Find ALL Projects with name\r\n    const { data: projects, error: pErr } = await supabase\r\n        .from('projects')\r\n        .select('*')\r\n        .eq('name', PROJECT_NAME)\r\n        .order('created_at', { ascending: false });\r\n\r\n    if (pErr) return;\r\n\r\n    for (const project of projects) {\r\n        console.log(`\\n------------------------------------------------`);\r\n        console.log(`ðŸ“ Project ID: ${project.id}`);\r\n        console.log(`   Project Created: ${project.created_at}`);\r\n\r\n        // Get Versions\r\n        const { data: versions } = await supabase\r\n            .from('versions')\r\n            .select('*')\r\n            .eq('project_id', project.id)\r\n            .order('created_at', { ascending: false }) // Newest first\r\n            .limit(1);\r\n\r\n        if (versions && versions.length > 0) {\r\n            console.log(`   Latest Version CreatedAt: ${versions[0].created_at}`);\r\n\r\n            const verDate = new Date(versions[0].created_at);\r\n            if (verDate.getFullYear() === 2026 && verDate.getMonth() === 0) { // Jan 2026 implies backdated logic worked (roughly)\r\n                console.log(`   âœ… LOOKS BACKDATED (Good)`);\r\n            } else if (verDate.getFullYear() === 2026 && verDate.getMonth() === 1 && verDate.getDate() === 2) {\r\n                console.log(`   âŒ LOOKS LIKE TODAY (Bad)`);\r\n            } else {\r\n                console.log(`   â“ Unknown date state`);\r\n            }\r\n        } else {\r\n            console.log(`   âš ï¸ NO VERSIONS`);\r\n        }\r\n    }\r\n}\r\n\r\nmain().catch(console.error);\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\VersionControl\\my-version-manager\\scripts\\cleanup.js","messages":[{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":2,"column":26,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":2,"endColumn":58}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Direct Supabase Query\r\nconst { createClient } = require('@supabase/supabase-js');\r\n\r\n// Credentials from local .env.local\r\nconst SUPABASE_URL = 'https://xggrigjnrecjtgfhjpkr.supabase.co';\r\nconst SUPABASE_KEY = 'sb_publishable_nzRdgGAk0Fvj06qJmHTDNQ_ku6K4Uju';\r\n\r\nconst BAD_IDS = [\r\n    '093e7117-dde3-4eac-9d05-db84c9094d42',\r\n    '49a8f371-9bda-4dba-992d-a7e6ce7d5814',\r\n    'a7986f1c-9667-4aea-b40d-906c6af4e46a',\r\n    '5ccdb81a-2ba6-4136-b601-8e9cf298402b'\r\n];\r\n\r\nasync function main() {\r\n    console.log('ðŸ§¹ Cleaning up BAD DUPLICATE projects...');\r\n    const supabase = createClient(SUPABASE_URL, SUPABASE_KEY);\r\n\r\n    for (const id of BAD_IDS) {\r\n        console.log(`Deleting ${id}...`);\r\n        const { error } = await supabase.from('projects').delete().eq('id', id);\r\n        if (error) {\r\n            console.error(`âŒ Failed to delete ${id}:`, error.message);\r\n        } else {\r\n            console.log(`âœ… Deleted ${id}`);\r\n        }\r\n    }\r\n    console.log('ðŸŽ‰ Cleanup complete. Only the good copy remains.');\r\n}\r\n\r\nmain().catch(console.error);\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\VersionControl\\my-version-manager\\scripts\\debug_version_74.js","messages":[{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":2,"column":26,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":2,"endColumn":58}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Direct Supabase Query\r\nconst { createClient } = require('@supabase/supabase-js');\r\n\r\n// Credentials from local .env.local\r\nconst SUPABASE_URL = 'https://xggrigjnrecjtgfhjpkr.supabase.co';\r\nconst SUPABASE_KEY = 'sb_publishable_nzRdgGAk0Fvj06qJmHTDNQ_ku6K4Uju';\r\n\r\nconst PROJECT_NAME = 'All Translate React Native';\r\nconst TARGET_VERSION_NAME = 'Version 74';\r\n\r\nasync function main() {\r\n    console.log('ðŸ” Debugging Version 74 specific linkage...');\r\n\r\n    const supabase = createClient(SUPABASE_URL, SUPABASE_KEY);\r\n\r\n    // 1. Find Project\r\n    const { data: projects } = await supabase\r\n        .from('projects')\r\n        .select('*')\r\n        .eq('name', PROJECT_NAME);\r\n\r\n    if (!projects || projects.length === 0) {\r\n        console.error('âŒ Project not found');\r\n        return;\r\n    }\r\n    // We expect only 1 now\r\n    const project = projects[0];\r\n    console.log(`âœ… Project: ${project.id}`);\r\n\r\n    // 2. Find Version 74\r\n    const { data: versions } = await supabase\r\n        .from('versions')\r\n        .select('*')\r\n        .eq('project_id', project.id)\r\n        .eq('name', TARGET_VERSION_NAME);\r\n\r\n    if (!versions || versions.length === 0) {\r\n        console.error(`âŒ Version \"${TARGET_VERSION_NAME}\" not found`);\r\n        return;\r\n    }\r\n    const version = versions[0];\r\n    console.log(`âœ… Version 74 ID: ${version.id}`);\r\n    console.log(`   Created At:   ${version.created_at}`);\r\n\r\n    // 3. Find Tasks for this Version\r\n    const { data: tasks, error: tErr } = await supabase\r\n        .from('tasks')\r\n        .select('*')\r\n        .eq('version_id', version.id);\r\n\r\n    if (tErr) {\r\n        console.error('âŒ Error fetching tasks:', tErr);\r\n        return;\r\n    }\r\n\r\n    console.log(`âœ… Tasks linked directly to Version 74: ${tasks.length}`);\r\n\r\n    if (tasks.length > 0) {\r\n        console.log('   Sample Task:', tasks[0]);\r\n    } else {\r\n        console.log('   âš ï¸  ZERO TASKS FOUND FOR THIS VERSION ID.');\r\n\r\n        // 4. Broad search: Are there tasks with this version ID but maybe wrong project ID?\r\n        const { data: globalTasks } = await supabase\r\n            .from('tasks')\r\n            .select('id, project_id, version_id')\r\n            .eq('version_id', version.id);\r\n\r\n        console.log(`   Global Search for Version ID ${version.id}: ${globalTasks?.length} tasks found.`);\r\n        if (globalTasks?.length > 0) {\r\n            console.log('   Tasks exist but maybe project_id mismatch?');\r\n            console.log('   Task Project ID:', globalTasks[0].project_id);\r\n            console.log('   Real Project ID:', project.id);\r\n            console.log('   Match:', globalTasks[0].project_id === project.id);\r\n        }\r\n    }\r\n}\r\n\r\nmain().catch(console.error);\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\VersionControl\\my-version-manager\\scripts\\import_data.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\VersionControl\\my-version-manager\\src\\app\\api\\activities\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\VersionControl\\my-version-manager\\src\\app\\api\\groups\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\VersionControl\\my-version-manager\\src\\app\\api\\projects\\[id]\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\VersionControl\\my-version-manager\\src\\app\\api\\projects\\[id]\\tasks\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\VersionControl\\my-version-manager\\src\\app\\api\\projects\\[id]\\versions\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":59,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":59,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1727,1730],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1727,1730],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest } from 'next/server';\r\nimport { supabase } from '@/lib/supabase';\r\nimport { apiSuccess, errors, checkAuth } from '@/lib/api-utils';\r\n\r\n// GET /api/projects/:id/versions - List versions for a project\r\nexport async function GET(\r\n    request: NextRequest,\r\n    { params }: { params: Promise<{ id: string }> }\r\n) {\r\n    const authError = checkAuth(request);\r\n    if (authError) return authError;\r\n\r\n    const { id: projectId } = await params;\r\n\r\n    const { data, error } = await supabase\r\n        .from('versions')\r\n        .select('*')\r\n        .eq('project_id', projectId)\r\n        .order('created_at', { ascending: false });\r\n\r\n    if (error) {\r\n        return errors.serverError(error.message);\r\n    }\r\n\r\n    const versions = (data || []).map(v => ({\r\n        id: v.id,\r\n        projectId: v.project_id,\r\n        name: v.name,\r\n        isActive: v.is_active,\r\n        createdAt: v.created_at,\r\n    }));\r\n\r\n    return apiSuccess(versions, { total: versions.length });\r\n}\r\n\r\n// POST /api/projects/:id/versions - Create a new version\r\nexport async function POST(\r\n    request: NextRequest,\r\n    { params }: { params: Promise<{ id: string }> }\r\n) {\r\n    const authError = checkAuth(request);\r\n    if (authError) return authError;\r\n\r\n    const { id: projectId } = await params;\r\n    const body = await request.json();\r\n    const { name, migratePendingTasks = false } = body;\r\n\r\n    if (!name || typeof name !== 'string') {\r\n        return errors.badRequest('name is required');\r\n    }\r\n\r\n    // Deactivate all other versions\r\n    await supabase\r\n        .from('versions')\r\n        .update({ is_active: false })\r\n        .eq('project_id', projectId);\r\n\r\n    // Create new active version\r\n    const insertData: any = { project_id: projectId, name, is_active: true };\r\n    if (body.createdAt) {\r\n        insertData.created_at = body.createdAt;\r\n    }\r\n\r\n    const { data, error } = await supabase\r\n        .from('versions')\r\n        .insert(insertData)\r\n        .select()\r\n        .single();\r\n\r\n    if (error) {\r\n        return errors.serverError(error.message);\r\n    }\r\n\r\n    // Migrate pending tasks if requested\r\n    if (migratePendingTasks) {\r\n        await supabase\r\n            .from('tasks')\r\n            .update({ version_id: data.id })\r\n            .eq('project_id', projectId)\r\n            .eq('is_done', false);\r\n    }\r\n\r\n    return apiSuccess({\r\n        id: data.id,\r\n        projectId: data.project_id,\r\n        name: data.name,\r\n        isActive: data.is_active,\r\n        createdAt: data.created_at,\r\n        migratedTasks: migratePendingTasks,\r\n    });\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\VersionControl\\my-version-manager\\src\\app\\api\\projects\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\VersionControl\\my-version-manager\\src\\app\\api\\search\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\VersionControl\\my-version-manager\\src\\app\\api\\tasks\\[id]\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\VersionControl\\my-version-manager\\src\\app\\api\\tasks\\bulk\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":67,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":67,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2200,2203],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2200,2203],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest } from 'next/server';\r\nimport { supabase } from '@/lib/supabase';\r\nimport { apiSuccess, errors, checkAuth } from '@/lib/api-utils';\r\n\r\ninterface BulkOperation {\r\n    action: 'create' | 'update' | 'delete';\r\n    id?: string;\r\n    projectId?: string;\r\n    versionId?: string;\r\n    content?: string;\r\n    isDone?: boolean;\r\n    createdAt?: string;\r\n    doneAt?: string;\r\n}\r\n\r\ninterface OperationResult {\r\n    action: string;\r\n    success: boolean;\r\n    id?: string;\r\n    error?: string;\r\n}\r\n\r\n// POST /api/tasks/bulk - Bulk create/update/delete tasks\r\nexport async function POST(request: NextRequest) {\r\n    const authError = checkAuth(request);\r\n    if (authError) return authError;\r\n\r\n    const body = await request.json();\r\n    const { operations } = body as { operations: BulkOperation[] };\r\n\r\n    if (!operations || !Array.isArray(operations)) {\r\n        return errors.badRequest('operations array is required');\r\n    }\r\n\r\n    if (operations.length > 100) {\r\n        return errors.badRequest('Maximum 100 operations per request');\r\n    }\r\n\r\n    const results: OperationResult[] = [];\r\n    let created = 0;\r\n    let updated = 0;\r\n    let deleted = 0;\r\n    let failed = 0;\r\n\r\n    for (const op of operations) {\r\n        try {\r\n            switch (op.action) {\r\n                case 'create': {\r\n                    if (!op.projectId || !op.content) {\r\n                        results.push({ action: 'create', success: false, error: 'projectId and content required' });\r\n                        failed++;\r\n                        continue;\r\n                    }\r\n\r\n                    // Get active version if not provided\r\n                    let targetVersionId = op.versionId;\r\n                    if (!targetVersionId) {\r\n                        const { data: activeVersion } = await supabase\r\n                            .from('versions')\r\n                            .select('id')\r\n                            .eq('project_id', op.projectId)\r\n                            .eq('is_active', true)\r\n                            .single();\r\n                        targetVersionId = activeVersion?.id || undefined;\r\n                    }\r\n\r\n                    const insertData: any = {\r\n                        project_id: op.projectId,\r\n                        version_id: targetVersionId || null,\r\n                        content: op.content,\r\n                        is_done: op.isDone || false,\r\n                    };\r\n\r\n                    if (op.createdAt) insertData.created_at = op.createdAt;\r\n                    if (op.doneAt) insertData.done_at = op.doneAt;\r\n\r\n                    const { data, error } = await supabase\r\n                        .from('tasks')\r\n                        .insert(insertData)\r\n                        .select()\r\n                        .single();\r\n\r\n                    if (error) {\r\n                        results.push({ action: 'create', success: false, error: error.message });\r\n                        failed++;\r\n                    } else {\r\n                        results.push({ action: 'create', success: true, id: data.id });\r\n                        created++;\r\n                    }\r\n                    break;\r\n                }\r\n\r\n                case 'update': {\r\n                    if (!op.id) {\r\n                        results.push({ action: 'update', success: false, error: 'id required' });\r\n                        failed++;\r\n                        continue;\r\n                    }\r\n\r\n                    const updates: Record<string, unknown> = {};\r\n                    if (op.content !== undefined) updates.content = op.content;\r\n                    if (op.isDone !== undefined) {\r\n                        updates.is_done = op.isDone;\r\n                        updates.done_at = op.isDone ? new Date().toISOString() : null;\r\n                    }\r\n\r\n                    if (Object.keys(updates).length === 0) {\r\n                        results.push({ action: 'update', success: false, error: 'No fields to update' });\r\n                        failed++;\r\n                        continue;\r\n                    }\r\n\r\n                    const { error } = await supabase\r\n                        .from('tasks')\r\n                        .update(updates)\r\n                        .eq('id', op.id);\r\n\r\n                    if (error) {\r\n                        results.push({ action: 'update', success: false, id: op.id, error: error.message });\r\n                        failed++;\r\n                    } else {\r\n                        results.push({ action: 'update', success: true, id: op.id });\r\n                        updated++;\r\n                    }\r\n                    break;\r\n                }\r\n\r\n                case 'delete': {\r\n                    if (!op.id) {\r\n                        results.push({ action: 'delete', success: false, error: 'id required' });\r\n                        failed++;\r\n                        continue;\r\n                    }\r\n\r\n                    const { error } = await supabase\r\n                        .from('tasks')\r\n                        .delete()\r\n                        .eq('id', op.id);\r\n\r\n                    if (error) {\r\n                        results.push({ action: 'delete', success: false, id: op.id, error: error.message });\r\n                        failed++;\r\n                    } else {\r\n                        results.push({ action: 'delete', success: true, id: op.id });\r\n                        deleted++;\r\n                    }\r\n                    break;\r\n                }\r\n\r\n                default:\r\n                    results.push({ action: op.action, success: false, error: 'Invalid action. Use create, update, or delete.' });\r\n                    failed++;\r\n            }\r\n        } catch (err) {\r\n            results.push({ action: op.action, success: false, error: String(err) });\r\n            failed++;\r\n        }\r\n    }\r\n\r\n    return apiSuccess({\r\n        created,\r\n        updated,\r\n        deleted,\r\n        failed,\r\n        total: operations.length,\r\n        results,\r\n    });\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\VersionControl\\my-version-manager\\src\\app\\docs\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Code' is defined but never used.","line":1,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":20,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Code"},"fix":{"range":[13,19],"text":""},"desc":"Remove unused variable \"Code\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Search' is defined but never used.","line":1,"column":50,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":56,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Search"},"fix":{"range":[47,55],"text":""},"desc":"Remove unused variable \"Search\"."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":59,"column":85,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[3459,3740],"text":"\r\n                                Hello Agent. This API is your control plane for the &quot;My Version Manager\" system.\r\n                                Your goal is to maintain a perfect synchronization between the codebase state and this tracking system.\r\n                            "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[3459,3740],"text":"\r\n                                Hello Agent. This API is your control plane for the &ldquo;My Version Manager\" system.\r\n                                Your goal is to maintain a perfect synchronization between the codebase state and this tracking system.\r\n                            "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[3459,3740],"text":"\r\n                                Hello Agent. This API is your control plane for the &#34;My Version Manager\" system.\r\n                                Your goal is to maintain a perfect synchronization between the codebase state and this tracking system.\r\n                            "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[3459,3740],"text":"\r\n                                Hello Agent. This API is your control plane for the &rdquo;My Version Manager\" system.\r\n                                Your goal is to maintain a perfect synchronization between the codebase state and this tracking system.\r\n                            "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":59,"column":104,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[3459,3740],"text":"\r\n                                Hello Agent. This API is your control plane for the \"My Version Manager&quot; system.\r\n                                Your goal is to maintain a perfect synchronization between the codebase state and this tracking system.\r\n                            "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[3459,3740],"text":"\r\n                                Hello Agent. This API is your control plane for the \"My Version Manager&ldquo; system.\r\n                                Your goal is to maintain a perfect synchronization between the codebase state and this tracking system.\r\n                            "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[3459,3740],"text":"\r\n                                Hello Agent. This API is your control plane for the \"My Version Manager&#34; system.\r\n                                Your goal is to maintain a perfect synchronization between the codebase state and this tracking system.\r\n                            "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[3459,3740],"text":"\r\n                                Hello Agent. This API is your control plane for the \"My Version Manager&rdquo; system.\r\n                                Your goal is to maintain a perfect synchronization between the codebase state and this tracking system.\r\n                            "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":146,"column":103,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[9033,9129],"text":"Use groups to organize projects (e.g., &quot;Client Work\", \"Open Source\"). Supports infinite nesting."},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[9033,9129],"text":"Use groups to organize projects (e.g., &ldquo;Client Work\", \"Open Source\"). Supports infinite nesting."},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[9033,9129],"text":"Use groups to organize projects (e.g., &#34;Client Work\", \"Open Source\"). Supports infinite nesting."},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[9033,9129],"text":"Use groups to organize projects (e.g., &rdquo;Client Work\", \"Open Source\"). Supports infinite nesting."},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":146,"column":115,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[9033,9129],"text":"Use groups to organize projects (e.g., \"Client Work&quot;, \"Open Source\"). Supports infinite nesting."},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[9033,9129],"text":"Use groups to organize projects (e.g., \"Client Work&ldquo;, \"Open Source\"). Supports infinite nesting."},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[9033,9129],"text":"Use groups to organize projects (e.g., \"Client Work&#34;, \"Open Source\"). Supports infinite nesting."},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[9033,9129],"text":"Use groups to organize projects (e.g., \"Client Work&rdquo;, \"Open Source\"). Supports infinite nesting."},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":146,"column":118,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[9033,9129],"text":"Use groups to organize projects (e.g., \"Client Work\", &quot;Open Source\"). Supports infinite nesting."},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[9033,9129],"text":"Use groups to organize projects (e.g., \"Client Work\", &ldquo;Open Source\"). Supports infinite nesting."},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[9033,9129],"text":"Use groups to organize projects (e.g., \"Client Work\", &#34;Open Source\"). Supports infinite nesting."},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[9033,9129],"text":"Use groups to organize projects (e.g., \"Client Work\", &rdquo;Open Source\"). Supports infinite nesting."},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":146,"column":130,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[9033,9129],"text":"Use groups to organize projects (e.g., \"Client Work\", \"Open Source&quot;). Supports infinite nesting."},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[9033,9129],"text":"Use groups to organize projects (e.g., \"Client Work\", \"Open Source&ldquo;). Supports infinite nesting."},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[9033,9129],"text":"Use groups to organize projects (e.g., \"Client Work\", \"Open Source&#34;). Supports infinite nesting."},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[9033,9129],"text":"Use groups to organize projects (e.g., \"Client Work\", \"Open Source&rdquo;). Supports infinite nesting."},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":186,"column":90,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[11472,11579],"text":" Only one version is &quot;active\" at a time. Creating a new version automatically deactivates the old one. Use "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[11472,11579],"text":" Only one version is &ldquo;active\" at a time. Creating a new version automatically deactivates the old one. Use "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[11472,11579],"text":" Only one version is &#34;active\" at a time. Creating a new version automatically deactivates the old one. Use "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[11472,11579],"text":" Only one version is &rdquo;active\" at a time. Creating a new version automatically deactivates the old one. Use "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":186,"column":97,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[11472,11579],"text":" Only one version is \"active&quot; at a time. Creating a new version automatically deactivates the old one. Use "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[11472,11579],"text":" Only one version is \"active&ldquo; at a time. Creating a new version automatically deactivates the old one. Use "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[11472,11579],"text":" Only one version is \"active&#34; at a time. Creating a new version automatically deactivates the old one. Use "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[11472,11579],"text":" Only one version is \"active&rdquo; at a time. Creating a new version automatically deactivates the old one. Use "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":239,"column":64,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[14617,14770],"text":"\r\n                            Paste this into your other AI Agent&apos;s system instructions to give it full awareness of this tool.\r\n                        "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[14617,14770],"text":"\r\n                            Paste this into your other AI Agent&lsquo;s system instructions to give it full awareness of this tool.\r\n                        "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[14617,14770],"text":"\r\n                            Paste this into your other AI Agent&#39;s system instructions to give it full awareness of this tool.\r\n                        "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[14617,14770],"text":"\r\n                            Paste this into your other AI Agent&rsquo;s system instructions to give it full awareness of this tool.\r\n                        "},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'language' is assigned a value but never used.","line":300,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":300,"endColumn":36}],"suppressedMessages":[],"errorCount":9,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Book, Code, Key, Server, Zap, Workflow, Search, AlertTriangle, MessageSquare } from 'lucide-react';\r\n\r\nexport default function DocsPage() {\r\n    return (\r\n        <div className=\"min-h-screen bg-slate-50 font-sans\">\r\n            {/* Header */}\r\n            <div className=\"bg-gradient-to-br from-slate-900 to-slate-800 text-white border-b border-white/10\">\r\n                <div className=\"max-w-5xl mx-auto px-6 py-16\">\r\n                    <div className=\"flex items-center gap-3 mb-4\">\r\n                        <div className=\"p-2 bg-emerald-500/20 rounded-lg backdrop-blur-sm border border-emerald-500/30\">\r\n                            <Book className=\"w-6 h-6 text-emerald-400\" />\r\n                        </div>\r\n                        <span className=\"text-emerald-400 font-semibold tracking-wide uppercase text-xs\">Developer & Agent Hub</span>\r\n                    </div>\r\n                    <h1 className=\"text-5xl font-bold mb-6 tracking-tight\">My Version Manager API</h1>\r\n                    <p className=\"text-slate-300 text-xl max-w-3xl leading-relaxed\">\r\n                        The definitive interface for AI Agents to autonomously manage project lifecycles.\r\n                        Designed for self-healing workflows, automated changelog tracking, and seamless context synchronization.\r\n                    </p>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"max-w-5xl mx-auto px-6 py-12 grid grid-cols-12 gap-10\">\r\n\r\n                {/* Sidebar Navigation */}\r\n                <div className=\"col-span-3 hidden lg:block\">\r\n                    <div className=\"sticky top-8 space-y-8\">\r\n                        <div>\r\n                            <h3 className=\"text-xs font-bold text-slate-400 uppercase tracking-wider mb-3\">Core Concepts</h3>\r\n                            <nav className=\"space-y-1\">\r\n                                <NavLink href=\"#introduction\">Introduction</NavLink>\r\n                                <NavLink href=\"#authentication\">Authentication</NavLink>\r\n                                <NavLink href=\"#agent-workflow\">Agent Workflow Strategy</NavLink>\r\n                            </nav>\r\n                        </div>\r\n                        <div>\r\n                            <h3 className=\"text-xs font-bold text-slate-400 uppercase tracking-wider mb-3\">API Reference</h3>\r\n                            <nav className=\"space-y-1\">\r\n                                <NavLink href=\"#groups\">Project Groups</NavLink>\r\n                                <NavLink href=\"#projects\">Projects</NavLink>\r\n                                <NavLink href=\"#versions\">Versions</NavLink>\r\n                                <NavLink href=\"#tasks\">Tasks</NavLink>\r\n                            </nav>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Main Content */}\r\n                <div className=\"col-span-12 lg:col-span-9 space-y-16\">\r\n\r\n                    {/* Introduction */}\r\n                    <section id=\"introduction\">\r\n                        <h2 className=\"text-3xl font-bold text-slate-800 mb-6 flex items-center gap-3\">\r\n                            <Zap className=\"w-8 h-8 text-amber-500\" />\r\n                            For AI Agents: Read This First\r\n                        </h2>\r\n                        <div className=\"prose prose-slate max-w-none text-slate-600\">\r\n                            <p className=\"text-lg\">\r\n                                Hello Agent. This API is your control plane for the \"My Version Manager\" system.\r\n                                Your goal is to maintain a perfect synchronization between the codebase state and this tracking system.\r\n                            </p>\r\n                            <div className=\"bg-amber-50 border-l-4 border-amber-500 p-4 my-6\">\r\n                                <h4 className=\"font-bold text-amber-800 m-0 mb-1\">ðŸ’¡ Prime Directive</h4>\r\n                                <p className=\"m-0 text-amber-700\">\r\n                                    Whenever you complete a unit of work (feature, fix, refactor), you <strong>MUST</strong> log it as a Task.\r\n                                    If you are about to start a major refactor or release, you <strong>MUST</strong> check the active Version first.\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n                    </section>\r\n\r\n                    {/* Authentication */}\r\n                    <section id=\"authentication\">\r\n                        <h2 className=\"text-2xl font-bold text-slate-800 mb-6 flex items-center gap-3\">\r\n                            <Key className=\"w-6 h-6 text-blue-500\" />\r\n                            Authentication & Config\r\n                        </h2>\r\n                        <div className=\"bg-white rounded-xl border border-slate-200 p-6 shadow-sm\">\r\n                            <p className=\"text-slate-600 mb-4\">\r\n                                Include the <code className=\"text-blue-600 font-mono\">Authorization</code> header in every request.\r\n                            </p>\r\n                            <CodeBlock\r\n                                language=\"bash\"\r\n                                code={`Authorization: Bearer <API_SECRET_KEY>`}\r\n                            />\r\n                            <div className=\"mt-4 text-sm text-slate-500\">\r\n                                Key location: <code className=\"bg-slate-100 px-1 rounded\">.env.local</code> â†’ <code className=\"text-slate-700\">API_SECRET_KEY</code>\r\n                            </div>\r\n                        </div>\r\n                    </section>\r\n\r\n                    {/* Workflow Strategy - NEW SECTION */}\r\n                    <section id=\"agent-workflow\">\r\n                        <h2 className=\"text-2xl font-bold text-slate-800 mb-6 flex items-center gap-3\">\r\n                            <Workflow className=\"w-6 h-6 text-purple-600\" />\r\n                            Agent Workflow Strategy\r\n                        </h2>\r\n\r\n                        <div className=\"space-y-6\">\r\n                            <WorkflowCard\r\n                                title=\"Scenario A: Starting a New Session\"\r\n                                description=\"When the user asks you to start working on a project:\"\r\n                                steps={[\r\n                                    \"SEARCH: Call GET /api/projects?search=name to find the project ID.\",\r\n                                    \"CONTEXT: Call GET /api/projects/:id/versions to find the active version.\",\r\n                                    \"STATUS: Call GET /api/projects/:id/tasks?status=pending to see what's left to do.\"\r\n                                ]}\r\n                            />\r\n\r\n                            <WorkflowCard\r\n                                title=\"Scenario B: Completing a Task\"\r\n                                description=\"When you finish a coding task:\"\r\n                                steps={[\r\n                                    \"LOG: Call POST /api/projects/:id/tasks with content='Implemented X feature'.\",\r\n                                    \"MARK: Immediately call PATCH /api/tasks/:id with isDone=true.\",\r\n                                    \"VERIFY: Double check if this completes the milestone defined in the active version.\"\r\n                                ]}\r\n                            />\r\n\r\n                            <WorkflowCard\r\n                                title=\"Scenario C: Releasing a Version\"\r\n                                description=\"When the user says 'Release this' or 'Deploy v2':\"\r\n                                steps={[\r\n                                    \"CREATE: Call POST /api/projects/:id/versions with { name: 'v2.0.0', migratePendingTasks: true }.\",\r\n                                    \"EXPLAIN: Inform the user that pending tasks have been migrated to the new version.\"\r\n                                ]}\r\n                            />\r\n                        </div>\r\n                    </section>\r\n\r\n                    <div className=\"h-px bg-slate-200 my-8\" />\r\n\r\n                    {/* Endpoints Reference */}\r\n                    <section id=\"endpoints\">\r\n                        <h2 className=\"text-2xl font-bold text-slate-800 mb-8 flex items-center gap-3\">\r\n                            <Server className=\"w-6 h-6 text-slate-500\" />\r\n                            API Reference\r\n                        </h2>\r\n\r\n                        {/* Groups */}\r\n                        <div id=\"groups\" className=\"mb-12\">\r\n                            <div className=\"flex items-center justify-between mb-4\">\r\n                                <h3 className=\"text-xl font-bold text-slate-800\">1. Project Groups</h3>\r\n                                <span className=\"px-2 py-1 bg-slate-100 text-slate-500 text-xs rounded-full font-mono\">Hierarchical</span>\r\n                            </div>\r\n                            <p className=\"text-slate-600 mb-4\">Use groups to organize projects (e.g., \"Client Work\", \"Open Source\"). Supports infinite nesting.</p>\r\n                            <div className=\"space-y-4\">\r\n                                <Endpoint\r\n                                    method=\"GET\"\r\n                                    path=\"/api/groups\"\r\n                                    desc=\"Get full group tree. Use this to help the user navigate or categorize a new project.\"\r\n                                />\r\n                                <Endpoint\r\n                                    method=\"POST\"\r\n                                    path=\"/api/groups\"\r\n                                    desc=\"Create a new category.\"\r\n                                    body={`{ \"name\": \"Mobile Apps\", \"parentId\": \"uuid-optional\" }`}\r\n                                />\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Projects */}\r\n                        <div id=\"projects\" className=\"mb-12\">\r\n                            <h3 className=\"text-xl font-bold text-slate-800 mb-4\">2. Projects</h3>\r\n                            <div className=\"space-y-4\">\r\n                                <Endpoint\r\n                                    method=\"GET\"\r\n                                    path=\"/api/projects\"\r\n                                    desc=\"List all projects. Filter by ?groupId=uuid to narrow down context.\"\r\n                                />\r\n                                <Endpoint\r\n                                    method=\"POST\"\r\n                                    path=\"/api/projects\"\r\n                                    desc=\"Initialize a new project tracking container.\"\r\n                                    body={`{ \"name\": \"Super App\", \"groupId\": \"uuid-optional\" }`}\r\n                                />\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Versions */}\r\n                        <div id=\"versions\" className=\"mb-12\">\r\n                            <h3 className=\"text-xl font-bold text-slate-800 mb-4\">3. Versions (Milestones)</h3>\r\n                            <div className=\"bg-blue-50 border border-blue-100 p-4 rounded-lg mb-4 text-sm text-blue-800 flex gap-2\">\r\n                                <AlertTriangle className=\"w-4 h-4 mt-0.5\" />\r\n                                <div>\r\n                                    <strong>Critical Logic:</strong> Only one version is \"active\" at a time. Creating a new version automatically deactivates the old one. Use <code>migratePendingTasks: true</code> to carry over unfinished work.\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"space-y-4\">\r\n                                <Endpoint\r\n                                    method=\"GET\"\r\n                                    path=\"/api/projects/:id/versions\"\r\n                                    desc=\"List version history. The one with isActive=true is the current focus.\"\r\n                                />\r\n                                <Endpoint\r\n                                    method=\"POST\"\r\n                                    path=\"/api/projects/:id/versions\"\r\n                                    desc=\"Cut a new release or start a sprint.\"\r\n                                    body={`{ \"name\": \"v1.2.0\", \"migratePendingTasks\": true }`}\r\n                                />\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Tasks */}\r\n                        <div id=\"tasks\" className=\"mb-12\">\r\n                            <h3 className=\"text-xl font-bold text-slate-800 mb-4\">4. Tasks (Work Items)</h3>\r\n                            <div className=\"space-y-4\">\r\n                                <Endpoint\r\n                                    method=\"GET\"\r\n                                    path=\"/api/projects/:id/tasks\"\r\n                                    desc=\"Fetch work items. Use ?status=pending to find what needs to be done.\"\r\n                                />\r\n                                <Endpoint\r\n                                    method=\"POST\"\r\n                                    path=\"/api/projects/:id/tasks\"\r\n                                    desc=\"Log a work item. If versionId is omitted, it auto-links to the ACTIVE version.\"\r\n                                    body={`{ \"content\": \"Refactor auth middleware\" }`}\r\n                                />\r\n                                <Endpoint\r\n                                    method=\"PATCH\"\r\n                                    path=\"/api/tasks/:id\"\r\n                                    desc=\"Update status or refine description.\"\r\n                                    body={`{ \"isDone\": true }`}\r\n                                />\r\n                            </div>\r\n                        </div>\r\n\r\n                    </section>\r\n\r\n                    {/* Self-Prompting Section */}\r\n                    <section id=\"prompt-template\" className=\"bg-slate-900 rounded-2xl p-8 text-white relative overflow-hidden\">\r\n                        <div className=\"absolute top-0 right-0 p-32 bg-emerald-500/10 rounded-full blur-3xl -mr-16 -mt-16 pointer-events-none\" />\r\n\r\n                        <h2 className=\"text-2xl font-bold mb-4 flex items-center gap-2\">\r\n                            <MessageSquare className=\"w-6 h-6 text-emerald-400\" />\r\n                            System Prompt Template\r\n                        </h2>\r\n                        <p className=\"text-slate-400 mb-6\">\r\n                            Paste this into your other AI Agent's system instructions to give it full awareness of this tool.\r\n                        </p>\r\n\r\n                        <div className=\"bg-black/50 rounded-xl p-4 font-mono text-xs text-emerald-300 overflow-x-auto border border-white/10\">\r\n                            <pre>{`Tool: MyVersionManager\r\nBaseURL: https://your-domain.com/api\r\nAuth: Bearer Token (ENV: MVM_API_KEY)\r\n\r\nCapabilities:\r\n- Manage Projects, Versions, and Tasks.\r\n- \"Active Version\" implies the current sprint/release cycle.\r\n\r\nStandard Procedure:\r\n1. Start of session: Check active version and pending tasks for current project.\r\n2. Coding: Implement features/fixes.\r\n3. End of task: Create a task via API describing the work and mark it as done.\r\n4. Release: Create new version via API when major milestones are reached.`}</pre>\r\n                        </div>\r\n                    </section>\r\n\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\n// Sub-components\r\n\r\nfunction NavLink({ href, children }: { href: string; children: React.ReactNode }) {\r\n    return (\r\n        <a href={href} className=\"block px-3 py-1.5 text-sm text-slate-600 hover:text-emerald-600 hover:bg-emerald-50 rounded-md transition-colors\">\r\n            {children}\r\n        </a>\r\n    );\r\n}\r\n\r\nfunction WorkflowCard({ title, description, steps }: { title: string; description: string; steps: string[] }) {\r\n    return (\r\n        <div className=\"bg-white rounded-xl border border-slate-200 p-6 shadow-sm hover:shadow-md transition-shadow\">\r\n            <h3 className=\"font-bold text-slate-800 mb-2\">{title}</h3>\r\n            <p className=\"text-slate-600 text-sm mb-4\">{description}</p>\r\n            <ul className=\"space-y-3\">\r\n                {steps.map((step, i) => {\r\n                    const [prefix, text] = step.split(': ');\r\n                    return (\r\n                        <li key={i} className=\"text-sm flex gap-3\">\r\n                            <span className=\"flex-shrink-0 w-6 h-6 rounded-full bg-slate-100 text-slate-500 flex items-center justify-center font-mono text-xs font-bold ring-1 ring-slate-200\">\r\n                                {i + 1}\r\n                            </span>\r\n                            <span className=\"text-slate-600\">\r\n                                <strong className=\"text-slate-800 font-semibold text-xs tracking-wide\">{prefix}</strong>\r\n                                <span className=\"block mt-0.5\">{text}</span>\r\n                            </span>\r\n                        </li>\r\n                    );\r\n                })}\r\n            </ul>\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction CodeBlock({ code, language = 'text' }: { code: string; language?: string }) {\r\n    return (\r\n        <div className=\"relative group\">\r\n            <pre className=\"bg-slate-900 text-slate-200 rounded-lg p-4 text-sm overflow-x-auto font-mono border border-slate-800\">\r\n                {code}\r\n            </pre>\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction Endpoint({ method, path, desc, body }: { method: string; path: string; desc: string; body?: string }) {\r\n    const methodColors: Record<string, string> = {\r\n        GET: 'bg-emerald-100 text-emerald-800 ring-emerald-500/20',\r\n        POST: 'bg-blue-100 text-blue-800 ring-blue-500/20',\r\n        PATCH: 'bg-amber-100 text-amber-800 ring-amber-500/20',\r\n        DELETE: 'bg-red-100 text-red-800 ring-red-500/20',\r\n    };\r\n\r\n    return (\r\n        <div className=\"bg-white rounded-lg border border-slate-200 overflow-hidden group hover:border-emerald-200 transition-colors\">\r\n            <div className=\"p-4\">\r\n                <div className=\"flex items-center gap-3 mb-2 flex-wrap\">\r\n                    <span className={`px-2.5 py-1 rounded font-mono text-xs font-bold ring-1 ring-inset ${methodColors[method]}`}>\r\n                        {method}\r\n                    </span>\r\n                    <code className=\"text-sm text-slate-700 font-bold font-mono\">{path}</code>\r\n                </div>\r\n                <p className=\"text-slate-600 text-sm\">{desc}</p>\r\n\r\n                {body && (\r\n                    <div className=\"mt-3 pt-3 border-t border-slate-100\">\r\n                        <div className=\"text-xs font-semibold text-slate-400 uppercase tracking-wider mb-2\">Payload Example</div>\r\n                        <code className=\"block bg-slate-50 text-slate-600 p-2 rounded text-xs font-mono break-all\">\r\n                            {body}\r\n                        </code>\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\VersionControl\\my-version-manager\\src\\app\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\VersionControl\\my-version-manager\\src\\app\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useCallback' is defined but never used.","line":3,"column":40,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":51,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"useCallback"},"fix":{"range":[54,67],"text":""},"desc":"Remove unused variable \"useCallback\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ChevronDown' is defined but never used.","line":4,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":30,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ChevronDown"},"fix":{"range":[101,114],"text":""},"desc":"Remove unused variable \"ChevronDown\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CheckSquare' is defined but never used.","line":4,"column":61,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":72,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CheckSquare"},"fix":{"range":[143,156],"text":""},"desc":"Remove unused variable \"CheckSquare\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'DragOverlay' is defined but never used.","line":31,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":31,"endColumn":14,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"DragOverlay"},"fix":{"range":[1059,1075],"text":""},"desc":"Remove unused variable \"DragOverlay\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'defaultDropAnimationSideEffects' is defined but never used.","line":32,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":32,"endColumn":34,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"defaultDropAnimationSideEffects"},"fix":{"range":[1075,1111],"text":""},"desc":"Remove unused variable \"defaultDropAnimationSideEffects\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'arrayMove' is defined but never used.","line":37,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":37,"endColumn":19,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"arrayMove"},"fix":{"range":[1202,1212],"text":""},"desc":"Remove unused variable \"arrayMove\"."}]},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nD:\\VersionControl\\my-version-manager\\src\\app\\page.tsx:54:46\n  52 |     if (saved) {\n  53 |       const w = Number(saved);\n> 54 |       if (!isNaN(w) && w >= 200 && w <= 600) setSidebarWidth(w);\n     |                                              ^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  55 |     }\n  56 |   }, []);\n  57 |","line":54,"column":46,"nodeType":null,"endLine":54,"endColumn":61},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'showAddProject' is assigned a value but never used.","line":92,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":92,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'activeDragTaskId' is assigned a value but never used.","line":96,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":96,"endColumn":26},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nD:\\VersionControl\\my-version-manager\\src\\app\\page.tsx:123:9\n  121 |     if (!selectedProjectId && projects.length > 0) {\n  122 |       if (settings.lastProjectId && projects.some(p => p.id === settings.lastProjectId)) {\n> 123 |         setSelectedProjectId(settings.lastProjectId);\n      |         ^^^^^^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  124 |       } else {\n  125 |         setSelectedProjectId(projects[0].id);\n  126 |       }","line":123,"column":9,"nodeType":null,"endLine":123,"endColumn":29},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'apiUpdateLastProject' and 'settings.lastProjectId'. Either include them or remove the dependency array.","line":135,"column":6,"nodeType":"ArrayExpression","endLine":135,"endColumn":25,"suggestions":[{"desc":"Update the dependencies array to be: [apiUpdateLastProject, selectedProjectId, settings.lastProjectId]","fix":{"range":[5245,5264],"text":"[apiUpdateLastProject, selectedProjectId, settings.lastProjectId]"}}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'handleSelectProject' is assigned a value but never used.","line":235,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":235,"endColumn":28},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'handleAddProject' is assigned a value but never used.","line":240,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":240,"endColumn":25},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":556,"column":36,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[22730,22768],"text":"\r\n                Search results for &quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[22730,22768],"text":"\r\n                Search results for &ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[22730,22768],"text":"\r\n                Search results for &#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[22730,22768],"text":"\r\n                Search results for &rdquo;"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":556,"column":50,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[22781,22798],"text":"&quot;\r\n              "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[22781,22798],"text":"&ldquo;\r\n              "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[22781,22798],"text":"&#34;\r\n              "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[22781,22798],"text":"&rdquo;\r\n              "},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":11,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useEffect, useMemo, useCallback } from 'react';\r\nimport { Package, ChevronDown, Plus, Search, Command, Menu, CheckSquare, X, Clock, Brain } from 'lucide-react';\r\nimport VersionSection from '@/components/VersionSection';\r\nimport CreateVersionModal from '@/components/CreateVersionModal';\r\nimport CommandPalette from '@/components/CommandPalette';\r\nimport TaskDrawer from '@/components/TaskDrawer';\r\nimport Sidebar from '@/components/Sidebar';\r\nimport ChangelogModal from '@/components/ChangelogModal';\r\nimport ActivityDrawer from '@/components/ActivityDrawer';\r\nimport ContextDumpModal from '@/components/ContextDumpModal';\r\nimport ContextBanner from '@/components/ContextBanner';\r\nimport WorkflowPanel from '@/components/WorkflowPanel';\r\nimport {\r\n  useProjects,\r\n  useVersions,\r\n  useTasks,\r\n  useSettings,\r\n  useActivities,\r\n  useContextDumps\r\n} from '@/hooks';\r\nimport type { Task, Version } from '@/lib/types';\r\nimport {\r\n  DndContext,\r\n  closestCorners,\r\n  KeyboardSensor,\r\n  PointerSensor,\r\n  useSensor,\r\n  useSensors,\r\n  DragOverlay,\r\n  defaultDropAnimationSideEffects,\r\n  DragStartEvent,\r\n  DragOverEvent,\r\n  DragEndEvent,\r\n} from '@dnd-kit/core';\r\nimport { arrayMove, sortableKeyboardCoordinates } from '@dnd-kit/sortable';\r\n\r\nexport default function Home() {\r\n  // --- Supabase Hooks ---\r\n  const { projects, createProject: apiCreateProject, updateProject: apiUpdateProject, deleteProject: apiDeleteProject, loading: projectsLoading } = useProjects();\r\n  const { settings, updateLastProject: apiUpdateLastProject } = useSettings();\r\n\r\n  // Local state for selection (though we try to sync with stats/settings)\r\n  const [selectedProjectId, setSelectedProjectId] = useState<string>('');\r\n\r\n  // Sidebar resizing\r\n  const [sidebarWidth, setSidebarWidth] = useState(256);\r\n\r\n  useEffect(() => {\r\n    const saved = localStorage.getItem('sidebarWidth');\r\n    if (saved) {\r\n      const w = Number(saved);\r\n      if (!isNaN(w) && w >= 200 && w <= 600) setSidebarWidth(w);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    localStorage.setItem('sidebarWidth', sidebarWidth.toString());\r\n  }, [sidebarWidth]);\r\n\r\n  // Hooks dependent on selectedProjectId\r\n  const {\r\n    versions,\r\n    createVersion: apiCreateVersion,\r\n    updateVersion: apiUpdateVersion,\r\n    deleteVersion: apiDeleteVersion,\r\n    setActiveVersion: apiSetActiveVersion,\r\n    loading: versionsLoading,\r\n    hasMore: hasMoreVersions,\r\n    loadMore: loadMoreVersions,\r\n    isValidating: versionsValidating,\r\n  } = useVersions(selectedProjectId || null);\r\n  const {\r\n    tasks,\r\n    createTask: apiCreateTask,\r\n    toggleDone: apiToggleDone,\r\n    updateTask: apiUpdateTask,\r\n    deleteTask: apiDeleteTask,\r\n    reorderTask: apiReorderTask,\r\n    moveTask: apiMoveTask,\r\n    updateTaskDetails: apiUpdateTaskDetails,\r\n  } = useTasks(selectedProjectId || null);\r\n  const { activities, loading: activitiesLoading, updateActivity } = useActivities(selectedProjectId || null);\r\n  const { latestDump, createContextDump, markAsRead, getUnreadDump } = useContextDumps(selectedProjectId || null);\r\n\r\n  // --- UI State ---\r\n  const [showVersionModal, setShowVersionModal] = useState(false);\r\n  const [showActivityDrawer, setShowActivityDrawer] = useState(false);\r\n  const [showProjectDropdown, setShowProjectDropdown] = useState(false);\r\n  const [showCommandPalette, setShowCommandPalette] = useState(false);\r\n  const [showAddProject, setShowAddProject] = useState(false);\r\n  const [newProjectName, setNewProjectName] = useState('');\r\n  const [showShortcuts, setShowShortcuts] = useState(false);\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [activeDragTaskId, setActiveDragTaskId] = useState<string | null>(null);\r\n  const [selectedTask, setSelectedTask] = useState<Task | null>(null);\r\n  const [changelogVersion, setChangelogVersion] = useState<Version | null>(null);\r\n  const [showContextDumpModal, setShowContextDumpModal] = useState(false);\r\n  const [showWorkflowPanel, setShowWorkflowPanel] = useState(false);\r\n  const [workflowLocation, setWorkflowLocation] = useState<'office' | 'home'>('office');\r\n\r\n  // Bulk Actions State\r\n  const [isSelectionMode, setIsSelectionMode] = useState(false);\r\n  const [selectedTaskIds, setSelectedTaskIds] = useState<Set<string>>(new Set());\r\n\r\n  // --- Dnd Sensors ---\r\n  const sensors = useSensors(\r\n    useSensor(PointerSensor, {\r\n      activationConstraint: { delay: 100, tolerance: 5 }, // Slight delay to prevent accidents\r\n    }),\r\n    useSensor(KeyboardSensor, {\r\n      coordinateGetter: sortableKeyboardCoordinates,\r\n    })\r\n  );\r\n\r\n  // --- Effects ---\r\n\r\n  // 1. Auto-select project logic (Load from settings or default to first)\r\n  useEffect(() => {\r\n    if (!selectedProjectId && projects.length > 0) {\r\n      if (settings.lastProjectId && projects.some(p => p.id === settings.lastProjectId)) {\r\n        setSelectedProjectId(settings.lastProjectId);\r\n      } else {\r\n        setSelectedProjectId(projects[0].id);\r\n      }\r\n    }\r\n  }, [projects, selectedProjectId, settings]);\r\n\r\n  // 2. Persist selection to Settings (Supabase)\r\n  useEffect(() => {\r\n    if (selectedProjectId && selectedProjectId !== settings.lastProjectId) {\r\n      apiUpdateLastProject(selectedProjectId);\r\n    }\r\n  }, [selectedProjectId]);\r\n\r\n  // 4. Keyboard shortcuts\r\n  useEffect(() => {\r\n    const handleKeyDown = (e: KeyboardEvent) => {\r\n      if ((e.target as HTMLElement).tagName === 'INPUT' ||\r\n        (e.target as HTMLElement).tagName === 'TEXTAREA') return;\r\n\r\n      switch (e.key.toLowerCase()) {\r\n        case 'n':\r\n          e.preventDefault();\r\n          document.querySelector<HTMLInputElement>('[data-add-task]')?.focus();\r\n          break;\r\n        case 'v':\r\n          e.preventDefault();\r\n          setShowVersionModal(true);\r\n          break;\r\n        case '/':\r\n          e.preventDefault();\r\n          document.querySelector<HTMLInputElement>('input[type=\"text\"][placeholder*=\"Search\"]')?.focus();\r\n          break;\r\n        case 'k':\r\n          if (e.metaKey || e.ctrlKey) {\r\n            e.preventDefault();\r\n            document.querySelector<HTMLInputElement>('input[type=\"text\"][placeholder*=\"Search\"]')?.focus();\r\n          }\r\n          break;\r\n        case '?':\r\n          e.preventDefault();\r\n          setShowShortcuts(prev => !prev);\r\n          break;\r\n        case 'escape':\r\n          setShowProjectDropdown(false);\r\n          setShowCommandPalette(false);\r\n          setShowShortcuts(false);\r\n          break;\r\n      }\r\n    };\r\n    window.addEventListener('keydown', handleKeyDown);\r\n    return () => window.removeEventListener('keydown', handleKeyDown);\r\n  }, []);\r\n\r\n  // --- Derived Data ---\r\n\r\n  // Filtered Versions (already sorted by hook, but double check sort if needed)\r\n  const filteredVersions = useMemo(() => {\r\n    // Hooks return data for selectedProjectId, so just sort\r\n    return [...versions].sort((a, b) => new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime());\r\n  }, [versions]);\r\n\r\n  const tasksByVersion = useMemo(() => {\r\n    const grouped: Record<string, Task[]> = { unassigned: [] };\r\n    filteredVersions.forEach(v => { grouped[v.id] = []; });\r\n\r\n    tasks.forEach(task => {\r\n      if (task.versionId && grouped[task.versionId]) {\r\n        grouped[task.versionId].push(task);\r\n      } else {\r\n        grouped.unassigned.push(task);\r\n      }\r\n    });\r\n    return grouped;\r\n  }, [tasks, filteredVersions]);\r\n\r\n  // Search filtering\r\n  const displayVersions = useMemo(() => {\r\n    if (!searchQuery.trim()) return filteredVersions;\r\n\r\n    const searchLower = searchQuery.toLowerCase();\r\n    const matchingTaskIds = new Set(\r\n      tasks\r\n        .filter(t => t.content.toLowerCase().includes(searchLower))\r\n        .map(t => t.id)\r\n    );\r\n\r\n    return filteredVersions.filter(v => {\r\n      const versionTasks = tasksByVersion[v.id] || [];\r\n      return versionTasks.some(t => matchingTaskIds.has(t.id));\r\n    });\r\n  }, [filteredVersions, tasks, searchQuery, tasksByVersion]);\r\n\r\n  // Stats\r\n  const stats = useMemo(() => {\r\n    // Tasks from hook are already filtered by selectedProjectId\r\n    const pending = tasks.filter(t => !t.isDone).length;\r\n    const done = tasks.filter(t => t.isDone).length;\r\n\r\n    // \"Released\" = completed tasks in INACTIVE versions\r\n    const inactiveVersionIds = new Set(\r\n      versions.filter(v => !v.isActive).map(v => v.id)\r\n    );\r\n    const released = tasks.filter(\r\n      t => t.isDone && t.versionId && inactiveVersionIds.has(t.versionId)\r\n    ).length;\r\n\r\n    return { pending, done, released };\r\n  }, [tasks, versions]);\r\n\r\n  // --- Actions ---\r\n\r\n  const handleSelectProject = (id: string) => {\r\n    setSelectedProjectId(id);\r\n    setShowProjectDropdown(false);\r\n  };\r\n\r\n  const handleAddProject = async () => {\r\n    if (newProjectName.trim()) {\r\n      const newProject = await apiCreateProject(newProjectName.trim());\r\n      if (newProject) {\r\n        setSelectedProjectId(newProject.id);\r\n        setNewProjectName('');\r\n        setShowAddProject(false);\r\n        setShowProjectDropdown(false);\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleAddTask = async (content: string, versionId: string | null) => {\r\n    await apiCreateTask(content, versionId); // Hook handles SetTasks\r\n  };\r\n\r\n  const handleCreateVersion = async (name: string, migratePending: boolean) => {\r\n    const newVersion = await apiCreateVersion(name, migratePending);\r\n    if (newVersion) {\r\n      setShowVersionModal(false);\r\n    }\r\n  };\r\n\r\n  const handleExport = () => {\r\n    const exportData = {\r\n      projects,\r\n      versions,\r\n      tasks,\r\n      exportedAt: new Date().toISOString(),\r\n    };\r\n    const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });\r\n    const url = URL.createObjectURL(blob);\r\n    const a = document.createElement('a');\r\n    a.href = url;\r\n    a.download = `my-version-manager-${new Date().toISOString().split('T')[0]}.json`;\r\n    a.click();\r\n    URL.revokeObjectURL(url);\r\n  };\r\n\r\n  // Commands\r\n  const commands = [\r\n    { id: 'add-task', label: 'Add Task', shortcut: 'N', action: () => document.querySelector<HTMLInputElement>('[data-add-task]')?.focus() },\r\n    { id: 'add-version', label: 'Create Version', shortcut: 'V', action: () => setShowVersionModal(true) },\r\n    { id: 'export', label: 'Export JSON', shortcut: 'Ctrl+E', action: handleExport },\r\n    { id: 'shortcuts', label: 'Show Shortcuts', shortcut: '?', action: () => setShowShortcuts(true) },\r\n    { id: 'agent-dump', label: 'Agent: Context Dump', shortcut: '/agent', action: () => setShowContextDumpModal(true) },\r\n  ];\r\n  const handleDragStart = (event: DragStartEvent) => {\r\n    setActiveDragTaskId(event.active.id as string);\r\n  };\r\n\r\n  const handleDragOver = (event: DragOverEvent) => {\r\n    const { active, over } = event;\r\n    if (!over) return;\r\n\r\n    // Find task objects\r\n    const activeTask = tasks.find(t => t.id === active.id);\r\n    const overTask = tasks.find(t => t.id === over.id);\r\n\r\n    // Check if over is a container (Version ID)\r\n    const isOverContainer = versions.some(v => v.id === over.id) || over.id === 'unassigned';\r\n    const overVersionId = isOverContainer ? over.id as string : null;\r\n\r\n    if (!activeTask) return;\r\n\r\n    // Case 1: Over another Task\r\n    if (overTask) {\r\n      if (activeTask.versionId !== overTask.versionId) {\r\n        // Moving to different version\r\n        apiMoveTask(activeTask.id, 0, overTask.versionId);\r\n      }\r\n    }\r\n    // Case 2: Over a Version Container (Empty column drop)\r\n    else if (overVersionId) {\r\n      if (activeTask.versionId !== overVersionId) {\r\n        apiMoveTask(activeTask.id, 0, overVersionId);\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleDragEnd = (event: DragEndEvent) => {\r\n    const { active, over } = event;\r\n    setActiveDragTaskId(null);\r\n\r\n    if (!over) return;\r\n\r\n    const activeTask = tasks.find(t => t.id === active.id);\r\n    const overTask = tasks.find(t => t.id === over.id);\r\n    const isOverContainer = versions.some(v => v.id === over.id) || over.id === 'unassigned';\r\n    const overVersionId = isOverContainer ? over.id as string : null;\r\n\r\n    if (activeTask) {\r\n      if (overTask && activeTask.id !== overTask.id) {\r\n        if (activeTask.versionId === overTask.versionId) {\r\n          apiReorderTask(activeTask.id, overTask.position, activeTask.versionId);\r\n          apiReorderTask(overTask.id, activeTask.position, overTask.versionId);\r\n        } else {\r\n          apiReorderTask(activeTask.id, overTask.position + 1, overTask.versionId);\r\n        }\r\n      } else if (overVersionId) {\r\n        // Dropped on container\r\n        if (activeTask.versionId !== overVersionId) {\r\n          // Append to end\r\n          const tasksInVersion = tasks.filter(t => t.versionId === overVersionId);\r\n          const newPos = tasksInVersion.length > 0 ? Math.max(...tasksInVersion.map(t => t.position)) + 1 : 0;\r\n          apiReorderTask(activeTask.id, newPos, overVersionId);\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  // Bulk Actions Handlers\r\n  const toggleTaskSelection = (taskId: string) => {\r\n    setSelectedTaskIds(prev => {\r\n      const next = new Set(prev);\r\n      if (next.has(taskId)) next.delete(taskId);\r\n      else next.add(taskId);\r\n      return next;\r\n    });\r\n  };\r\n\r\n  const clearSelection = () => {\r\n    setSelectedTaskIds(new Set());\r\n    setIsSelectionMode(false);\r\n  };\r\n\r\n  const handleBulkDelete = async () => {\r\n    if (confirm(`Are you sure you want to delete ${selectedTaskIds.size} tasks?`)) {\r\n      for (const id of Array.from(selectedTaskIds)) {\r\n        await apiDeleteTask(id);\r\n      }\r\n      clearSelection();\r\n    }\r\n  };\r\n\r\n  const handleBulkToggleDone = async (isDone: boolean) => {\r\n    for (const id of Array.from(selectedTaskIds)) {\r\n      await apiToggleDone(id, isDone);\r\n    }\r\n    clearSelection();\r\n  };\r\n\r\n  const handleReleaseVersion = async () => {\r\n    if (changelogVersion && apiUpdateVersion) {\r\n      await apiUpdateVersion(changelogVersion.id, { isActive: false });\r\n      setChangelogVersion(null);\r\n    }\r\n  };\r\n\r\n  // --- Render ---\r\n\r\n  if (projectsLoading && projects.length === 0) {\r\n    return (\r\n      <div className=\"min-h-screen bg-slate-50 flex items-center justify-center\">\r\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-emerald-600\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const selectedProject = projects.find(p => p.id === selectedProjectId);\r\n\r\n  return (\r\n    <div className=\"flex min-h-screen bg-slate-50 dark:bg-black font-sans text-slate-900 dark:text-slate-100 selection:bg-emerald-100 dark:selection:bg-emerald-900 selection:text-emerald-900 dark:selection:text-emerald-100\">\r\n\r\n      {/* Sidebar */}\r\n      <Sidebar\r\n        projects={projects}\r\n        selectedProjectId={selectedProjectId}\r\n        onSelectProject={setSelectedProjectId}\r\n        onCreateProject={apiCreateProject}\r\n        onUpdateProject={apiUpdateProject}\r\n        onDeleteProject={apiDeleteProject}\r\n        onOpenActivity={() => setShowActivityDrawer(true)}\r\n        onOpenWorkflow={() => {\r\n          setWorkflowLocation('office');\r\n          setShowWorkflowPanel(true);\r\n        }}\r\n        width={sidebarWidth}\r\n        setWidth={setSidebarWidth}\r\n      />\r\n\r\n      {/* DEBUG BANNER - TEMPORARY */}\r\n      <div className=\"fixed bottom-4 right-4 z-[9999] bg-black/80 text-white p-4 rounded-lg text-xs font-mono max-w-sm pointer-events-none\">\r\n        <p>Project ID: {selectedProjectId}</p>\r\n        <p>Versions: {versions.length}</p>\r\n        <p>Tasks: {tasks.length}</p>\r\n        {/* We don't have tasksError exposed from useTasks, need to assume if 0 and ProjectID valid */}\r\n      </div>\r\n\r\n\r\n      {/* Main Content Area */}\r\n      <div\r\n        className=\"flex-1 flex flex-col lg:pl-[var(--sidebar-width)] transition-all duration-75 ease-out\"\r\n        style={{ '--sidebar-width': `${sidebarWidth}px` } as React.CSSProperties}\r\n      >\r\n\r\n        {/* Top Bar */}\r\n        <div className=\"sticky top-0 z-30 bg-white/80 dark:bg-slate-900/80 backdrop-blur-md border-b border-slate-200 dark:border-slate-800 shadow-sm transition-all duration-200\">\r\n          <div className=\"max-w-5xl mx-auto px-4 py-3 h-16 flex items-center justify-between\">\r\n            {/* Left: Breadcrumb / Project Name */}\r\n            <div className=\"flex items-center gap-3\">\r\n              <button className=\"lg:hidden p-2 -ml-2 text-slate-500 hover:bg-slate-100 rounded-lg\">\r\n                <Menu className=\"w-5 h-5\" />\r\n              </button>\r\n\r\n              <div className=\"flex items-center gap-2\">\r\n                <div className=\"w-8 h-8 bg-emerald-100 text-emerald-600 rounded-lg flex items-center justify-center font-bold\">\r\n                  {selectedProject?.name.charAt(0) || 'P'}\r\n                </div>\r\n                <h1 className=\"font-bold text-slate-800 dark:text-slate-100 text-lg sm:text-xl truncate max-w-[150px] sm:max-w-xs transition-all\">\r\n                  {selectedProject?.name || 'Select Project'}\r\n                </h1>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"flex flex-1 items-center justify-end gap-3 ml-4\">\r\n              {/* Search Bar */}\r\n              <div className=\"flex-1 max-w-xl relative group hidden md:block\">\r\n                <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400 group-focus-within:text-emerald-500 transition-colors\" />\r\n                <input\r\n                  type=\"text\"\r\n                  value={searchQuery}\r\n                  onChange={(e) => setSearchQuery(e.target.value)}\r\n                  placeholder=\"Search tasks...\"\r\n                  className=\"w-full pl-9 pr-10 py-2 bg-slate-100 dark:bg-slate-800 border-none rounded-lg text-sm text-slate-700 dark:text-slate-200 focus:bg-white dark:focus:bg-slate-950 focus:ring-2 focus:ring-emerald-500/20 transition-all placeholder:text-slate-400\"\r\n                />\r\n                <div className=\"absolute right-3 top-1/2 -translate-y-1/2 flex items-center gap-1 pointer-events-none\">\r\n                  <kbd className=\"hidden sm:inline-flex h-5 items-center gap-1 rounded border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 px-1.5 font-mono text-[10px] font-medium text-slate-500 dark:text-slate-400 opacity-100\">\r\n                    <span className=\"text-xs\">/</span>\r\n                  </kbd>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Actions */}\r\n              <div className=\"flex items-center gap-2\">\r\n                <button\r\n                  onClick={() => setShowVersionModal(true)}\r\n                  className=\"hidden sm:flex items-center gap-2 px-4 py-2 bg-emerald-600 text-white text-sm font-semibold rounded-lg hover:bg-emerald-700 active:scale-95 transition-all shadow-sm hover:shadow\"\r\n                >\r\n                  <Plus className=\"w-4 h-4\" />\r\n                  <span>New Version</span>\r\n                </button>\r\n                <button\r\n                  onClick={() => setShowVersionModal(true)}\r\n                  className=\"sm:hidden flex items-center justify-center w-9 h-9 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 shadow-sm\"\r\n                >\r\n                  <Plus className=\"w-5 h-5\" />\r\n                </button>\r\n\r\n                <div className=\"h-6 w-px bg-slate-200 mx-1\" />\r\n\r\n                <button\r\n                  onClick={() => setShowContextDumpModal(true)}\r\n                  className=\"p-2 text-purple-500 hover:text-purple-600 hover:bg-purple-50 dark:hover:bg-purple-900/20 rounded-lg transition-colors\"\r\n                  title=\"Context Dump\"\r\n                >\r\n                  <Brain className=\"w-5 h-5\" />\r\n                </button>\r\n\r\n                <button\r\n                  onClick={() => setShowActivityDrawer(true)}\r\n                  className=\"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg transition-colors\"\r\n                  title=\"Activity Log\"\r\n                >\r\n                  <Clock className=\"w-5 h-5\" />\r\n                </button>\r\n\r\n                <button\r\n                  onClick={() => setShowShortcuts(true)}\r\n                  className=\"p-2 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg transition-colors\"\r\n                  title=\"Shortcuts (?)\"\r\n                >\r\n                  <Command className=\"w-5 h-5\" />\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Context Banner */}\r\n        {getUnreadDump() && selectedProject && (\r\n          <ContextBanner\r\n            dump={getUnreadDump()!}\r\n            onDismiss={() => markAsRead(getUnreadDump()!.id)}\r\n            onContinue={() => {\r\n              markAsRead(getUnreadDump()!.id);\r\n              // Could open a modal or do something else here\r\n            }}\r\n          />\r\n        )}\r\n\r\n        <div className=\"max-w-5xl mx-auto px-4 py-8\">\r\n          {/* Stats Ribbon */}\r\n          {!searchQuery && (\r\n            <div className=\"flex items-center gap-8 mb-8 px-1\">\r\n              <div className=\"flex items-baseline gap-2.5 group cursor-default\">\r\n                <span className=\"text-3xl font-bold text-slate-800 dark:text-slate-200 tracking-tight group-hover:text-amber-600 transition-colors\">{stats.pending}</span>\r\n                <span className=\"text-sm font-semibold text-slate-400 uppercase tracking-wide group-hover:text-amber-600/80 transition-colors\">pending</span>\r\n              </div>\r\n              <div className=\"h-8 w-px bg-slate-200/60 dark:bg-slate-700/60\" />\r\n              <div className=\"flex items-baseline gap-2.5 group cursor-default\">\r\n                <span className=\"text-3xl font-bold text-slate-800 dark:text-slate-200 tracking-tight group-hover:text-emerald-600 transition-colors\">{stats.done}</span>\r\n                <span className=\"text-sm font-semibold text-slate-400 uppercase tracking-wide group-hover:text-emerald-600/80 transition-colors\">completed</span>\r\n              </div>\r\n              <div className=\"h-8 w-px bg-slate-200/60 dark:bg-slate-700/60\" />\r\n              <div className=\"flex items-baseline gap-2.5 group cursor-default\">\r\n                <span className=\"text-3xl font-bold text-slate-800 dark:text-slate-200 tracking-tight group-hover:text-blue-600 transition-colors\">{stats.released}</span>\r\n                <span className=\"text-sm font-semibold text-slate-400 uppercase tracking-wide group-hover:text-blue-600/80 transition-colors\">released</span>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Search Results Header */}\r\n          {searchQuery && (\r\n            <div className=\"mb-6 flex items-center justify-between\">\r\n              <h2 className=\"text-lg font-semibold text-slate-700\">\r\n                Search results for \"{searchQuery}\"\r\n              </h2>\r\n              <button\r\n                onClick={() => setSearchQuery('')}\r\n                className=\"text-sm text-slate-500 hover:text-slate-800\"\r\n              >\r\n                Clear search\r\n              </button>\r\n            </div>\r\n          )}\r\n\r\n          {/* Version Sections */}\r\n          <div className=\"space-y-4\">\r\n            <DndContext\r\n              sensors={sensors}\r\n              collisionDetection={closestCorners}\r\n              onDragStart={handleDragStart}\r\n              onDragOver={handleDragOver}\r\n              onDragEnd={handleDragEnd}\r\n            >\r\n              {displayVersions.length === 0 && tasksByVersion.unassigned.length === 0 && !versionsLoading && (\r\n                <div className=\"flex flex-col items-center justify-center py-20 text-center animate-in fade-in zoom-in duration-500\">\r\n                  <div className=\"relative mb-8 group cursor-pointer\" onClick={() => setShowVersionModal(true)}>\r\n                    <div className=\"absolute inset-0 bg-emerald-100 dark:bg-emerald-900/30 rounded-full blur-xl opacity-40 group-hover:opacity-70 transition-opacity duration-500\" />\r\n                    <div className=\"relative w-24 h-24 bg-white/50 dark:bg-slate-800/50 backdrop-blur-sm rounded-2xl shadow-xl flex items-center justify-center border border-white/60 dark:border-slate-700 transform group-hover:-translate-y-2 transition-transform duration-300\">\r\n                      <Package className=\"w-10 h-10 text-emerald-600/80 group-hover:text-emerald-600 transition-colors\" />\r\n                    </div>\r\n                    {/* Decorative elements */}\r\n                    <div className=\"absolute -right-4 -bottom-2 w-12 h-12 bg-white dark:bg-slate-800 rounded-xl shadow-lg flex items-center justify-center border border-slate-50 dark:border-slate-700 transform rotate-12 group-hover:rotate-6 transition-transform duration-300 delay-75\">\r\n                      <div className=\"w-6 h-1.5 bg-slate-100 dark:bg-slate-700 rounded-full\" />\r\n                    </div>\r\n                    <div className=\"absolute -left-3 -top-2 w-8 h-8 bg-emerald-50 dark:bg-emerald-900/20 rounded-lg shadow-md flex items-center justify-center transform -rotate-6 group-hover:-rotate-12 transition-transform duration-300 delay-100\">\r\n                      <Plus className=\"w-4 h-4 text-emerald-400\" />\r\n                    </div>\r\n                  </div>\r\n\r\n                  <h3 className=\"text-xl font-bold text-slate-800 dark:text-slate-200 mb-3\">No versions found</h3>\r\n                  <p className=\"text-slate-500 dark:text-slate-400 max-w-sm mb-8 leading-relaxed text-sm\">\r\n                    Create your first version to start tracking tasks and releases for <span className=\"font-semibold text-slate-700 dark:text-slate-300\">{selectedProject?.name}</span>.\r\n                  </p>\r\n\r\n                  {!searchQuery && (\r\n                    <button\r\n                      onClick={() => setShowVersionModal(true)}\r\n                      className=\"group relative px-6 py-3 bg-emerald-600 text-white font-semibold rounded-xl shadow-lg shadow-emerald-600/20 hover:shadow-emerald-600/30 hover:bg-emerald-700 active:scale-95 transition-all\"\r\n                    >\r\n                      <span className=\"flex items-center gap-2\">\r\n                        <Plus className=\"w-5 h-5 group-hover:rotate-90 transition-transform duration-300\" />\r\n                        Create Version\r\n                      </span>\r\n                    </button>\r\n                  )}\r\n                </div>\r\n              )}\r\n\r\n              {displayVersions.map(version => (\r\n                <div key={version.id}>\r\n                  <VersionSection\r\n                    version={version}\r\n                    tasks={tasksByVersion[version.id]?.filter(t => !searchQuery || t.content.toLowerCase().includes(searchQuery.toLowerCase())) || []}\r\n                    onAddTask={(content: string) => handleAddTask(content, version.id)}\r\n                    onToggleDone={apiToggleDone}\r\n                    onUpdateTask={apiUpdateTask}\r\n                    onDeleteTask={apiDeleteTask}\r\n                    onOpenTask={task => setSelectedTask(task)}\r\n                    onGenerateChangelog={() => setChangelogVersion(version)}\r\n                    onDeleteVersion={apiDeleteVersion}\r\n                    onSetActiveVersion={apiSetActiveVersion}\r\n                    onUpdateVersion={apiUpdateVersion}\r\n                    isSelectionMode={isSelectionMode}\r\n                    selectedTaskIds={selectedTaskIds}\r\n                    onToggleSelectTask={toggleTaskSelection}\r\n                  />\r\n                </div>\r\n              ))}\r\n\r\n              {/* Unassigned Section */}\r\n              {tasksByVersion.unassigned.length > 0 && (\r\n                (!searchQuery || tasksByVersion.unassigned.some(t => t.content.toLowerCase().includes(searchQuery.toLowerCase()))) && (\r\n                  <div>\r\n                    <VersionSection\r\n                      version={{ id: 'unassigned', projectId: selectedProjectId, name: 'Unassigned', isActive: false, createdAt: '' }}\r\n                      tasks={tasksByVersion.unassigned.filter(t => !searchQuery || t.content.toLowerCase().includes(searchQuery.toLowerCase()))}\r\n                      onAddTask={(content: string) => handleAddTask(content, null)}\r\n                      onToggleDone={apiToggleDone}\r\n                      onUpdateTask={apiUpdateTask}\r\n                      onDeleteTask={apiDeleteTask}\r\n                      onOpenTask={task => setSelectedTask(task)}\r\n                      isUnassigned\r\n                      isSelectionMode={isSelectionMode}\r\n                      selectedTaskIds={selectedTaskIds}\r\n                      onToggleSelectTask={toggleTaskSelection}\r\n                    />\r\n                  </div>\r\n                )\r\n              )}\r\n            </DndContext>\r\n\r\n            {/* Load More Button */}\r\n            {hasMoreVersions && !searchQuery && (\r\n              <div className=\"flex justify-center mt-6\">\r\n                <button\r\n                  onClick={loadMoreVersions}\r\n                  disabled={versionsValidating}\r\n                  className=\"px-6 py-2.5 bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-sm font-medium rounded-lg hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2\"\r\n                >\r\n                  {versionsValidating ? (\r\n                    <>\r\n                      <div className=\"w-4 h-4 border-2 border-slate-400 border-t-transparent rounded-full animate-spin\" />\r\n                      Loading...\r\n                    </>\r\n                  ) : (\r\n                    'Load more versions'\r\n                  )}\r\n                </button>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Keyboard Hints (Footer) */}\r\n          {!searchQuery && (\r\n            <div className=\"mt-12 pt-8 border-t border-slate-200/60 dark:border-slate-700/60 flex justify-center gap-6 text-xs text-slate-400 dark:text-slate-500 font-medium\">\r\n              <span className=\"flex items-center gap-1.5 hover:text-slate-600 dark:hover:text-slate-400 transition-colors cursor-help\" title=\"Press N\">\r\n                <kbd className=\"bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded px-1 min-w-[20px] text-center shadow-[0_1px_0_rgba(0,0,0,0.1)]\">N</kbd>\r\n                New Task\r\n              </span>\r\n              <span className=\"flex items-center gap-1.5 hover:text-slate-600 dark:hover:text-slate-400 transition-colors cursor-help\" title=\"Press V\">\r\n                <kbd className=\"bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded px-1 min-w-[20px] text-center shadow-[0_1px_0_rgba(0,0,0,0.1)]\">V</kbd>\r\n                New Version\r\n              </span>\r\n              <span className=\"flex items-center gap-1.5 hover:text-slate-600 dark:hover:text-slate-400 transition-colors cursor-help\" title=\"Press /\">\r\n                <kbd className=\"bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded px-1 min-w-[20px] text-center shadow-[0_1px_0_rgba(0,0,0,0.1)]\">/</kbd>\r\n                Search\r\n              </span>\r\n              <span className=\"flex items-center gap-1.5 hover:text-slate-600 dark:hover:text-slate-400 transition-colors cursor-help\" title=\"Press ?\">\r\n                <kbd className=\"bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded px-1 min-w-[20px] text-center shadow-[0_1px_0_rgba(0,0,0,0.1)]\">?</kbd>\r\n                Shortcuts\r\n              </span>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Modals */}\r\n      {showVersionModal && (\r\n        <CreateVersionModal\r\n          onClose={() => setShowVersionModal(false)}\r\n          onCreate={handleCreateVersion}\r\n        />\r\n      )}\r\n\r\n      {showCommandPalette && (\r\n        <CommandPalette\r\n          commands={commands}\r\n          onClose={() => setShowCommandPalette(false)}\r\n          contextData={{\r\n            project: selectedProject,\r\n            versions: versions,\r\n            tasks: tasks,\r\n            activities: activities,\r\n            latestDump: latestDump\r\n          }}\r\n        />\r\n      )}\r\n\r\n      {showShortcuts && (\r\n        <ShortcutsModal onClose={() => setShowShortcuts(false)} />\r\n      )}\r\n\r\n      {showProjectDropdown && (\r\n        <div className=\"fixed inset-0 z-40\" onClick={() => { setShowProjectDropdown(false); setShowAddProject(false); }} />\r\n      )}\r\n\r\n      {/* Task Drawer */}\r\n      <TaskDrawer\r\n        task={selectedTask}\r\n        isOpen={!!selectedTask}\r\n        onClose={() => setSelectedTask(null)}\r\n        onUpdate={async (id, updates) => {\r\n          await apiUpdateTaskDetails(id, updates);\r\n          setSelectedTask(prev => prev && prev.id === id ? { ...prev, ...updates } : prev);\r\n        }}\r\n      />\r\n\r\n      <ActivityDrawer\r\n        isOpen={showActivityDrawer}\r\n        onClose={() => setShowActivityDrawer(false)}\r\n        activities={activities}\r\n        loading={activitiesLoading}\r\n        onUpdateActivity={updateActivity}\r\n      />\r\n\r\n      {/* Changelog Modal */}\r\n      {changelogVersion && (\r\n        <ChangelogModal\r\n          version={changelogVersion}\r\n          tasks={tasksByVersion[changelogVersion.id] || []}\r\n          onClose={() => setChangelogVersion(null)}\r\n          onRelease={handleReleaseVersion}\r\n          onSaveChangelog={async (changelog) => {\r\n            const success = await apiUpdateVersion(changelogVersion.id, { changelog });\r\n            return success;\r\n          }}\r\n        />\r\n      )}\r\n\r\n      {/* Context Dump Modal */}\r\n      {showContextDumpModal && selectedProject && (\r\n        <ContextDumpModal\r\n          projectName={selectedProject.name}\r\n          latestDump={latestDump}\r\n          onSave={createContextDump}\r\n          onClose={() => setShowContextDumpModal(false)}\r\n        />\r\n      )}\r\n\r\n      {/* Workflow Panel */}\r\n      <WorkflowPanel\r\n        isOpen={showWorkflowPanel}\r\n        onClose={() => setShowWorkflowPanel(false)}\r\n        workspaceLocation={workflowLocation}\r\n        projectName={selectedProject?.name}\r\n        pendingTasksCount={tasks.filter(t => !t.isDone).length}\r\n        completedTodayCount={tasks.filter(t => t.isDone && t.doneAt && new Date(t.doneAt).toDateString() === new Date().toDateString()).length}\r\n        hasUnreadContextDump={latestDump ? !latestDump.is_read : false}\r\n        lastActivityTime={activities[0]?.created_at ? new Date(activities[0].created_at).toLocaleTimeString() : undefined}\r\n        onOpenContextDump={() => {\r\n          setShowWorkflowPanel(false);\r\n          setShowContextDumpModal(true);\r\n        }}\r\n        onOpenActivityLog={() => {\r\n          setShowWorkflowPanel(false);\r\n          setShowActivityDrawer(true);\r\n        }}\r\n        onMarkContextRead={() => latestDump && markAsRead(latestDump.id)}\r\n      />\r\n\r\n      {/* Floating Bulk Action Bar */}\r\n      {selectedTaskIds.size > 0 && (\r\n        <div className=\"fixed bottom-6 left-1/2 -translate-x-1/2 lg:ml-32 bg-slate-900 text-white px-6 py-3 rounded-xl shadow-2xl flex items-center gap-6 z-50 animate-in slide-in-from-bottom-5 fade-in duration-200\">\r\n          <div className=\"text-sm font-semibold flex items-center gap-2\">\r\n            <div className=\"bg-emerald-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center\">\r\n              {selectedTaskIds.size}\r\n            </div>\r\n            Selected\r\n          </div>\r\n\r\n          <div className=\"h-6 w-px bg-slate-700\" />\r\n\r\n          <div className=\"flex items-center gap-2\">\r\n            <button onClick={() => handleBulkToggleDone(true)} className=\"px-3 py-1.5 hover:bg-slate-800 rounded-lg text-sm transition-colors\">Mark Done</button>\r\n            <button onClick={() => handleBulkToggleDone(false)} className=\"px-3 py-1.5 hover:bg-slate-800 rounded-lg text-sm transition-colors\">Mark Pending</button>\r\n            <button onClick={handleBulkDelete} className=\"px-3 py-1.5 hover:bg-red-900/50 text-red-200 hover:text-red-100 rounded-lg text-sm transition-colors\">Delete</button>\r\n          </div>\r\n\r\n          <div className=\"h-6 w-px bg-slate-700\" />\r\n\r\n          <button onClick={clearSelection} className=\"p-1.5 hover:bg-slate-800 rounded-lg text-slate-400 hover:text-white transition-colors\">\r\n            <X className=\"w-4 h-4\" />\r\n          </button>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction ShortcutsModal({ onClose }: { onClose: () => void }) {\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\" onClick={onClose}>\r\n      <div className=\"bg-white dark:bg-slate-900 rounded-2xl shadow-xl w-full max-w-sm p-6\" onClick={e => e.stopPropagation()}>\r\n        <h3 className=\"font-semibold text-slate-800 dark:text-slate-100 mb-4\">Keyboard Shortcuts</h3>\r\n        <div className=\"space-y-2 text-sm\">\r\n          {[\r\n            ['N', 'Add new task'],\r\n            ['V', 'Create version'],\r\n            ['/', 'Open command palette'],\r\n            ['?', 'Toggle shortcuts'],\r\n            ['/', 'Focus search'],\r\n            ['E / Enter', 'Edit task'],\r\n            ['Delete', 'Delete task'],\r\n            ['Esc', 'Close / Cancel'],\r\n          ].map(([key, desc]) => (\r\n            <div key={key} className=\"flex items-center justify-between\">\r\n              <span className=\"text-slate-600 dark:text-slate-400\">{desc}</span>\r\n              <kbd className=\"px-2 py-1 bg-slate-100 dark:bg-slate-800 rounded text-slate-700 dark:text-slate-300 font-mono text-xs\">{key}</kbd>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\VersionControl\\my-version-manager\\src\\components\\ActivityDrawer.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":10,"column":101,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":10,"endColumn":104,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[486,489],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[486,489],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react';\r\nimport { X, Clock, GitCommit, FilePlus, CheckCircle2, Trash2, Edit2, Archive, Activity as ActivityIcon, Package, Pencil, Save, XCircle, Plus } from 'lucide-react';\r\nimport { Activity } from '@/hooks/useActivities';\r\n\r\ninterface ActivityDrawerProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    activities: Activity[];\r\n    loading: boolean;\r\n    onUpdateActivity?: (activityId: string, updates: { diff_summary?: string }) => Promise<{ error: any }>;\r\n}\r\n\r\nexport default function ActivityDrawer({ isOpen, onClose, activities, loading, onUpdateActivity }: ActivityDrawerProps) {\r\n    const [editingActivityId, setEditingActivityId] = useState<string | null>(null);\r\n    const [editValue, setEditValue] = useState('');\r\n    const [saving, setSaving] = useState(false);\r\n\r\n    // Group activities by date\r\n    const groupedActivities = activities.reduce((acc, activity) => {\r\n        const date = new Date(activity.created_at).toLocaleDateString(undefined, {\r\n            weekday: 'long',\r\n            year: 'numeric',\r\n            month: 'long',\r\n            day: 'numeric'\r\n        });\r\n        if (!acc[date]) acc[date] = [];\r\n        acc[date].push(activity);\r\n        return acc;\r\n    }, {} as Record<string, Activity[]>);\r\n\r\n    const getIcon = (action: string) => {\r\n        switch (action) {\r\n            case 'create_task': return <FilePlus className=\"w-4 h-4 text-emerald-500\" />;\r\n            case 'create_project': return <Package className=\"w-4 h-4 text-indigo-600\" />;\r\n            case 'complete_task': return <CheckCircle2 className=\"w-4 h-4 text-blue-500\" />;\r\n            case 'reopen_task': return <Clock className=\"w-4 h-4 text-amber-500\" />;\r\n            case 'delete_task': return <Trash2 className=\"w-4 h-4 text-red-500\" />;\r\n            case 'create_version': return <GitCommit className=\"w-4 h-4 text-purple-500 dark:text-purple-400\" />;\r\n            case 'release_version': return <Archive className=\"w-4 h-4 text-green-600 dark:text-green-500\" />;\r\n            case 'update_version': return <Edit2 className=\"w-4 h-4 text-indigo-500 dark:text-indigo-400\" />;\r\n            default: return <ActivityIcon className=\"w-4 h-4 text-slate-400\" />;\r\n        }\r\n    };\r\n\r\n    const handleStartEdit = (activity: Activity) => {\r\n        setEditingActivityId(activity.id);\r\n        setEditValue(activity.diff_summary || '');\r\n    };\r\n\r\n    const handleCancelEdit = () => {\r\n        setEditingActivityId(null);\r\n        setEditValue('');\r\n    };\r\n\r\n    const handleSave = async (activityId: string) => {\r\n        if (!onUpdateActivity) return;\r\n\r\n        setSaving(true);\r\n        const { error } = await onUpdateActivity(activityId, { diff_summary: editValue || undefined });\r\n        setSaving(false);\r\n\r\n        if (!error) {\r\n            setEditingActivityId(null);\r\n            setEditValue('');\r\n        }\r\n    };\r\n\r\n    return (\r\n        <>\r\n            {isOpen && (\r\n                <div className=\"fixed inset-0 bg-black/20 z-40 transition-opacity\" onClick={onClose} />\r\n            )}\r\n\r\n            <div className={`fixed inset-y-0 right-0 w-full sm:w-[400px] bg-white dark:bg-slate-900 shadow-2xl z-50 transform transition-transform duration-300 ease-in-out ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}>\r\n                <div className=\"h-full flex flex-col\">\r\n                    <div className=\"px-6 py-4 border-b border-slate-100 dark:border-slate-800 flex items-center justify-between bg-slate-50/50 dark:bg-slate-800/50\">\r\n                        <h2 className=\"font-bold text-slate-800 dark:text-slate-100 flex items-center gap-2\">\r\n                            <Clock className=\"w-5 h-5 text-slate-500 dark:text-slate-400\" />\r\n                            Activity Log\r\n                        </h2>\r\n                        <button onClick={onClose} className=\"p-1 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800\">\r\n                            <X className=\"w-5 h-5\" />\r\n                        </button>\r\n                    </div>\r\n\r\n                    <div className=\"flex-1 overflow-y-auto p-6\">\r\n                        {loading && activities.length === 0 ? (\r\n                            <div className=\"flex justify-center py-8\">\r\n                                <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-slate-300\"></div>\r\n                            </div>\r\n                        ) : activities.length === 0 ? (\r\n                            <div className=\"text-center py-12 text-slate-400\">\r\n                                <ActivityIcon className=\"w-12 h-12 mx-auto mb-3 opacity-20\" />\r\n                                <p>No activity recorded yet</p>\r\n                            </div>\r\n                        ) : (\r\n                            <div className=\"space-y-8\">\r\n                                {Object.entries(groupedActivities).map(([date, items]) => (\r\n                                    <div key={date}>\r\n                                        <div className=\"text-xs font-medium text-slate-400 dark:text-slate-500 uppercase tracking-wider mb-4 border-b border-slate-100 dark:border-slate-800 pb-1\">\r\n                                            {date}\r\n                                        </div>\r\n                                        <div className=\"relative border-l-2 border-slate-100 dark:border-slate-800 ml-3 space-y-6 pb-2\">\r\n                                            {items.map((activity) => {\r\n                                                const isEditing = editingActivityId === activity.id;\r\n\r\n                                                return (\r\n                                                    <div key={activity.id} className=\"relative pl-6\">\r\n                                                        <div className=\"absolute -left-[9px] top-0 bg-white dark:bg-slate-900 p-0.5 rounded-full border border-slate-200 dark:border-slate-700\">\r\n                                                            {getIcon(activity.action_type)}\r\n                                                        </div>\r\n                                                        <div>\r\n                                                            <div className=\"flex items-start justify-between gap-2\">\r\n                                                                <div className=\"text-sm font-medium text-slate-800 dark:text-slate-200\">\r\n                                                                    {activity.description || 'Performed an action'}\r\n                                                                </div>\r\n                                                                {onUpdateActivity && !isEditing && (\r\n                                                                    <button\r\n                                                                        onClick={() => handleStartEdit(activity)}\r\n                                                                        className=\"p-1 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 rounded hover:bg-slate-100 dark:hover:bg-slate-800 flex-shrink-0\"\r\n                                                                        title={activity.diff_summary ? 'Edit summary' : 'Add summary'}\r\n                                                                    >\r\n                                                                        {activity.diff_summary ? (\r\n                                                                            <Pencil className=\"w-3.5 h-3.5\" />\r\n                                                                        ) : (\r\n                                                                            <Plus className=\"w-3.5 h-3.5\" />\r\n                                                                        )}\r\n                                                                    </button>\r\n                                                                )}\r\n                                                            </div>\r\n                                                            <div className=\"text-xs text-slate-400 mt-1\">\r\n                                                                {new Date(activity.created_at).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}\r\n                                                            </div>\r\n\r\n                                                            {isEditing ? (\r\n                                                                <div className=\"mt-2 space-y-2\">\r\n                                                                    <textarea\r\n                                                                        value={editValue}\r\n                                                                        onChange={(e) => setEditValue(e.target.value)}\r\n                                                                        placeholder=\"Describe the logic changes made in this activity...\"\r\n                                                                        className=\"w-full p-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-md text-sm text-slate-800 dark:text-slate-200 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:focus:ring-indigo-400 resize-none\"\r\n                                                                        rows={4}\r\n                                                                        autoFocus\r\n                                                                    />\r\n                                                                    <div className=\"flex gap-2 justify-end\">\r\n                                                                        <button\r\n                                                                            onClick={handleCancelEdit}\r\n                                                                            disabled={saving}\r\n                                                                            className=\"px-3 py-1.5 text-xs font-medium text-slate-600 dark:text-slate-400 hover:text-slate-800 dark:hover:text-slate-200 rounded-md hover:bg-slate-100 dark:hover:bg-slate-800 flex items-center gap-1\"\r\n                                                                        >\r\n                                                                            <XCircle className=\"w-3.5 h-3.5\" />\r\n                                                                            Cancel\r\n                                                                        </button>\r\n                                                                        <button\r\n                                                                            onClick={() => handleSave(activity.id)}\r\n                                                                            disabled={saving}\r\n                                                                            className=\"px-3 py-1.5 text-xs font-medium text-white bg-indigo-600 hover:bg-indigo-700 rounded-md flex items-center gap-1 disabled:opacity-50\"\r\n                                                                        >\r\n                                                                            <Save className=\"w-3.5 h-3.5\" />\r\n                                                                            {saving ? 'Saving...' : 'Save'}\r\n                                                                        </button>\r\n                                                                    </div>\r\n                                                                </div>\r\n                                                            ) : activity.diff_summary && (\r\n                                                                <div className=\"mt-2 p-2 bg-slate-900 rounded-md overflow-x-auto\">\r\n                                                                    <pre className=\"text-xs font-mono text-emerald-400 whitespace-pre-wrap\">\r\n                                                                        {activity.diff_summary}\r\n                                                                    </pre>\r\n                                                                </div>\r\n                                                            )}\r\n                                                        </div>\r\n                                                    </div>\r\n                                                );\r\n                                            })}\r\n                                        </div>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\VersionControl\\my-version-manager\\src\\components\\ChangelogModal.tsx","messages":[{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":373,"column":81,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[20159,20203],"text":"Use &quot;AI Draft\" to generate from manual input"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[20159,20203],"text":"Use &ldquo;AI Draft\" to generate from manual input"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[20159,20203],"text":"Use &#34;AI Draft\" to generate from manual input"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[20159,20203],"text":"Use &rdquo;AI Draft\" to generate from manual input"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":373,"column":90,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[20159,20203],"text":"Use \"AI Draft&quot; to generate from manual input"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[20159,20203],"text":"Use \"AI Draft&ldquo; to generate from manual input"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[20159,20203],"text":"Use \"AI Draft&#34; to generate from manual input"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[20159,20203],"text":"Use \"AI Draft&rdquo; to generate from manual input"},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useMemo } from 'react';\r\nimport { X, Copy, Check, FileText, Download, Sparkles, GitCommit, List, Save } from 'lucide-react';\r\nimport ReactMarkdown from 'react-markdown';\r\nimport { Version, Task } from '@/lib/types';\r\nimport PromptPreviewModal from './PromptPreviewModal';\r\nimport { generateAgentPrompts } from '@/lib/promptGenerator';\r\n\r\ninterface ChangelogModalProps {\r\n    version: Version;\r\n    tasks: Task[];\r\n    onClose: () => void;\r\n    onRelease?: () => void;\r\n    onSaveChangelog?: (changelog: string) => Promise<boolean>;\r\n}\r\n\r\ntype ChangelogFormat = 'markdown' | 'plain' | 'html';\r\ntype ChangelogSource = 'auto' | 'manual';\r\n\r\nexport default function ChangelogModal({ version, tasks, onClose, onRelease, onSaveChangelog }: ChangelogModalProps) {\r\n    const [source, setSource] = useState<ChangelogSource>('auto');\r\n    const [format, setFormat] = useState<ChangelogFormat>('markdown');\r\n    const [copied, setCopied] = useState(false);\r\n    const [includeDate, setIncludeDate] = useState(true);\r\n    const [groupByPriority, setGroupByPriority] = useState(false);\r\n    const [showPromptPreview, setShowPromptPreview] = useState(false);\r\n    const [manualInput, setManualInput] = useState('');\r\n    const [generatedPrompt, setGeneratedPrompt] = useState<{ title: string; content: string } | null>(null);\r\n    const [saving, setSaving] = useState(false);\r\n    const [saved, setSaved] = useState(false);\r\n\r\n    const completedTasks = useMemo(() => tasks.filter(t => t.isDone), [tasks]);\r\n    const pendingTasks = useMemo(() => tasks.filter(t => !t.isDone), [tasks]);\r\n\r\n    const generateChangelog = useMemo(() => {\r\n        const date = new Date().toLocaleDateString('en-US', {\r\n            year: 'numeric',\r\n            month: 'long',\r\n            day: 'numeric'\r\n        });\r\n\r\n        if (source === 'manual') {\r\n            // Simple pass-through or basic formatting for manual input\r\n            if (format === 'markdown') {\r\n                return `## ${version.name}${includeDate ? ` - ${date}` : ''}\\n\\n${manualInput || '(No content)'}`;\r\n            } else if (format === 'plain') {\r\n                return `${version.name}${includeDate ? ` - ${date}` : ''}\\n${'='.repeat(version.name.length + (includeDate ? date.length + 3 : 0))}\\n\\n${manualInput || '(No content)'}`;\r\n            } else {\r\n                return `<h2>${version.name}${includeDate ? ` <small>${date}</small>` : ''}</h2>\\n<p>${(manualInput || '(No content)').replace(/\\n/g, '<br/>')}</p>`;\r\n            }\r\n        }\r\n\r\n        let content = '';\r\n\r\n        if (format === 'markdown') {\r\n            content = `## ${version.name}${includeDate ? ` - ${date}` : ''}\\n\\n`;\r\n\r\n            if (groupByPriority) {\r\n                const priorities = ['urgent', 'high', 'medium', 'low', 'none'] as const;\r\n                const priorityLabels: Record<string, string> = {\r\n                    urgent: 'ðŸ”´ Critical',\r\n                    high: 'ðŸŸ  High Priority',\r\n                    medium: 'ðŸŸ¡ Medium Priority',\r\n                    low: 'ðŸŸ¢ Low Priority',\r\n                    none: 'âšª Other'\r\n                };\r\n\r\n                for (const priority of priorities) {\r\n                    const priorityTasks = completedTasks.filter(t => (t.priority || 'none') === priority);\r\n                    if (priorityTasks.length > 0) {\r\n                        content += `### ${priorityLabels[priority]}\\n\\n`;\r\n                        priorityTasks.forEach(task => {\r\n                            content += `- ${task.content}\\n`;\r\n                            if (task.description) {\r\n                                content += `  > ${task.description.split('\\n')[0]}\\n`;\r\n                            }\r\n                        });\r\n                        content += '\\n';\r\n                    }\r\n                }\r\n            } else {\r\n                if (completedTasks.length > 0) {\r\n                    content += `### âœ… Completed\\n\\n`;\r\n                    completedTasks.forEach(task => {\r\n                        content += `- ${task.content}\\n`;\r\n                        if (task.description) {\r\n                            content += `  > ${task.description.split('\\n')[0]}\\n`;\r\n                        }\r\n                    });\r\n                    content += '\\n';\r\n                }\r\n            }\r\n\r\n            if (pendingTasks.length > 0) {\r\n                content += `### â³ Known Issues / Remaining\\n\\n`;\r\n                pendingTasks.forEach(task => {\r\n                    content += `- ${task.content}\\n`;\r\n                });\r\n                content += '\\n';\r\n            }\r\n\r\n            content += `---\\n*Generated by My Version Manager*\\n`;\r\n\r\n        } else if (format === 'plain') {\r\n            content = `${version.name}${includeDate ? ` - ${date}` : ''}\\n`;\r\n            content += '='.repeat(version.name.length + (includeDate ? date.length + 3 : 0)) + '\\n\\n';\r\n\r\n            if (completedTasks.length > 0) {\r\n                content += `COMPLETED:\\n`;\r\n                completedTasks.forEach(task => {\r\n                    content += `  â€¢ ${task.content}\\n`;\r\n                });\r\n                content += '\\n';\r\n            }\r\n\r\n            if (pendingTasks.length > 0) {\r\n                content += `PENDING:\\n`;\r\n                pendingTasks.forEach(task => {\r\n                    content += `  â€¢ ${task.content}\\n`;\r\n                });\r\n            }\r\n\r\n        } else if (format === 'html') {\r\n            content = `<h2>${version.name}${includeDate ? ` <small>${date}</small>` : ''}</h2>\\n`;\r\n\r\n            if (completedTasks.length > 0) {\r\n                content += `<h3>âœ… Completed</h3>\\n<ul>\\n`;\r\n                completedTasks.forEach(task => {\r\n                    content += `  <li>${task.content}</li>\\n`;\r\n                });\r\n                content += `</ul>\\n`;\r\n            }\r\n\r\n            if (pendingTasks.length > 0) {\r\n                content += `<h3>â³ Pending</h3>\\n<ul>\\n`;\r\n                pendingTasks.forEach(task => {\r\n                    content += `  <li>${task.content}</li>\\n`;\r\n                });\r\n                content += `</ul>\\n`;\r\n            }\r\n        }\r\n\r\n        return content;\r\n    }, [version, completedTasks, pendingTasks, format, includeDate, groupByPriority, source, manualInput]);\r\n\r\n    const handleCopy = async () => {\r\n        await navigator.clipboard.writeText(generateChangelog);\r\n        setCopied(true);\r\n        setTimeout(() => setCopied(false), 2000);\r\n    };\r\n\r\n    const handleDownload = () => {\r\n        const extension = format === 'html' ? 'html' : format === 'markdown' ? 'md' : 'txt';\r\n        const blob = new Blob([generateChangelog], { type: 'text/plain' });\r\n        const url = URL.createObjectURL(blob);\r\n        const a = document.createElement('a');\r\n        a.href = url;\r\n        a.download = `changelog-${version.name.replace(/\\s+/g, '-').toLowerCase()}.${extension}`;\r\n        a.click();\r\n        URL.revokeObjectURL(url);\r\n    };\r\n\r\n    const handleSave = async () => {\r\n        if (!onSaveChangelog) return;\r\n        setSaving(true);\r\n        const success = await onSaveChangelog(generateChangelog);\r\n        setSaving(false);\r\n        if (success) {\r\n            setSaved(true);\r\n            setTimeout(() => setSaved(false), 2000);\r\n        }\r\n    };\r\n\r\n    const handleGenerateAgentPrompt = () => {\r\n        let prompt = '';\r\n        if (source === 'manual') {\r\n            prompt = `Based on the following commit messages/notes for version \"${version.name}\", please generate a polished changelog:\\n\\n${manualInput}`;\r\n        } else {\r\n            prompt = generateAgentPrompts.changelogDraft(version, completedTasks);\r\n        }\r\n\r\n        setGeneratedPrompt({\r\n            title: `Changelog for ${version.name}`,\r\n            content: prompt\r\n        });\r\n        setShowPromptPreview(true);\r\n    };\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\" onClick={onClose}>\r\n            <div\r\n                className=\"bg-white dark:bg-slate-900 rounded-2xl shadow-2xl w-full max-w-2xl max-h-[85vh] flex flex-col overflow-hidden\"\r\n                onClick={e => e.stopPropagation()}\r\n            >\r\n                {/* Header */}\r\n                <div className=\"px-6 py-4 border-b border-slate-100 dark:border-slate-800 flex items-center justify-between bg-gradient-to-r from-slate-50 to-white dark:from-slate-900 dark:to-slate-800/50\">\r\n                    <div className=\"flex items-center gap-3\">\r\n                        <div className=\"w-10 h-10 bg-emerald-100 dark:bg-emerald-900/30 rounded-xl flex items-center justify-center\">\r\n                            <FileText className=\"w-5 h-5 text-emerald-600 dark:text-emerald-500\" />\r\n                        </div>\r\n                        <div>\r\n                            <h2 className=\"font-bold text-slate-800 dark:text-slate-100 text-lg\">Changelog Generator</h2>\r\n                            <p className=\"text-sm text-slate-500 dark:text-slate-400\">{version.name} â€¢ {completedTasks.length} completed</p>\r\n                        </div>\r\n                    </div>\r\n                    <button onClick={onClose} className=\"p-2 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg transition-colors\">\r\n                        <X className=\"w-5 h-5\" />\r\n                    </button>\r\n                </div>\r\n\r\n                {/* Source Tabs */}\r\n                <div className=\"flex border-b border-slate-100 dark:border-slate-800\">\r\n                    <button\r\n                        onClick={() => setSource('auto')}\r\n                        className={`flex-1 py-3 text-sm font-medium flex items-center justify-center gap-2 transition-colors relative ${source === 'auto'\r\n                            ? 'text-emerald-600 dark:text-emerald-500 bg-white dark:bg-slate-900'\r\n                            : 'text-slate-500 dark:text-slate-400 bg-slate-50 dark:bg-slate-950 hover:bg-slate-100 dark:hover:bg-slate-800'\r\n                            }`}\r\n                    >\r\n                        <List className=\"w-4 h-4\" />\r\n                        From Tasks\r\n                        {source === 'auto' && <div className=\"absolute bottom-0 left-0 right-0 h-0.5 bg-emerald-500\" />}\r\n                    </button>\r\n                    <button\r\n                        onClick={() => setSource('manual')}\r\n                        className={`flex-1 py-3 text-sm font-medium flex items-center justify-center gap-2 transition-colors relative ${source === 'manual'\r\n                            ? 'text-emerald-600 dark:text-emerald-500 bg-white dark:bg-slate-900'\r\n                            : 'text-slate-500 dark:text-slate-400 bg-slate-50 dark:bg-slate-950 hover:bg-slate-100 dark:hover:bg-slate-800'\r\n                            }`}\r\n                    >\r\n                        <GitCommit className=\"w-4 h-4\" />\r\n                        Manual Input\r\n                        {source === 'manual' && <div className=\"absolute bottom-0 left-0 right-0 h-0.5 bg-emerald-500\" />}\r\n                    </button>\r\n                </div>\r\n\r\n                {/* Options Bar */}\r\n                <div className=\"px-6 py-3 bg-slate-50 dark:bg-slate-800/50 border-b border-slate-100 dark:border-slate-800 flex flex-wrap items-center gap-4\">\r\n                    {/* Format Selector */}\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <span className=\"text-xs font-medium text-slate-500 uppercase\">Format:</span>\r\n                        <div className=\"flex bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg p-0.5\">\r\n                            {(['markdown', 'plain', 'html'] as const).map(f => (\r\n                                <button\r\n                                    key={f}\r\n                                    onClick={() => setFormat(f)}\r\n                                    className={`px-3 py-1 text-xs font-medium rounded-md transition-all ${format === f ? 'bg-emerald-500 text-white shadow-sm' : 'text-slate-600 dark:text-slate-400 hover:text-slate-800 dark:hover:text-slate-200'}`}\r\n                                >\r\n                                    {f.charAt(0).toUpperCase() + f.slice(1)}\r\n                                </button>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n\r\n\r\n                    <button\r\n                        onClick={handleGenerateAgentPrompt}\r\n                        className=\"flex items-center gap-1.5 px-3 py-1 bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 rounded-lg text-xs font-semibold hover:bg-purple-200 dark:hover:bg-purple-900/50 transition-colors\"\r\n                    >\r\n                        <Sparkles className=\"w-3.5 h-3.5\" />\r\n                        AI Draft\r\n                    </button>\r\n\r\n                    {source === 'auto' && (\r\n                        <>\r\n                            {/* Toggles */}\r\n                            <label className=\"flex items-center gap-2 cursor-pointer\">\r\n                                <input\r\n                                    type=\"checkbox\"\r\n                                    checked={includeDate}\r\n                                    onChange={e => setIncludeDate(e.target.checked)}\r\n                                    className=\"w-4 h-4 rounded border-slate-300 text-emerald-600 focus:ring-emerald-500\"\r\n                                />\r\n                                <span className=\"text-xs text-slate-600 dark:text-slate-400\">Date</span>\r\n                            </label>\r\n\r\n                            <label className=\"flex items-center gap-2 cursor-pointer\">\r\n                                <input\r\n                                    type=\"checkbox\"\r\n                                    checked={groupByPriority}\r\n                                    onChange={e => setGroupByPriority(e.target.checked)}\r\n                                    className=\"w-4 h-4 rounded border-slate-300 text-emerald-600 focus:ring-emerald-500\"\r\n                                />\r\n                                <span className=\"text-xs text-slate-600 dark:text-slate-400\">Priority</span>\r\n                            </label>\r\n                        </>\r\n                    )}\r\n                </div>\r\n\r\n                {/* Content Area */}\r\n                <div className=\"flex-1 overflow-hidden flex flex-col\">\r\n                    {source === 'manual' ? (\r\n                        <div className=\"flex-1 p-6 overflow-y-auto\">\r\n                            <textarea\r\n                                value={manualInput}\r\n                                onChange={e => setManualInput(e.target.value)}\r\n                                placeholder=\"Paste commit messages, PR titles, or notes here...\"\r\n                                className=\"w-full h-full min-h-[300px] p-4 bg-slate-50 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-700 rounded-xl text-sm font-mono focus:outline-none focus:ring-2 focus:ring-emerald-500 resize-none text-slate-800 dark:text-slate-200\"\r\n                            />\r\n                        </div>\r\n                    ) : (\r\n                        <div className=\"flex-1 overflow-y-auto p-6\">\r\n                            <div className=\"text-xs font-medium text-slate-400 uppercase tracking-wider mb-2\">Preview</div>\r\n                            {format === 'markdown' ? (\r\n                                <div className=\"prose prose-sm prose-slate dark:prose-invert max-w-none bg-slate-50 dark:bg-slate-800/30 p-4 rounded-xl border border-slate-100 dark:border-slate-800\">\r\n                                    <ReactMarkdown>{generateChangelog}</ReactMarkdown>\r\n                                </div>\r\n                            ) : (\r\n                                <pre className=\"bg-slate-900 dark:bg-slate-950 text-slate-100 p-4 rounded-xl text-sm overflow-x-auto font-mono border border-slate-800 whitespace-pre-wrap\">\r\n                                    {generateChangelog}\r\n                                </pre>\r\n                            )}\r\n                        </div>\r\n                    )}\r\n                </div>\r\n\r\n                {/* Footer Actions */}\r\n                <div className=\"px-6 py-4 border-t border-slate-100 dark:border-slate-800 bg-slate-50/50 dark:bg-slate-800/50 flex items-center justify-between\">\r\n                    <div className=\"flex items-center gap-4\">\r\n                        <div className=\"text-xs text-slate-400\">\r\n                            {source === 'manual' ? manualInput.length : generateChangelog.length} characters\r\n                        </div>\r\n                        {version.isActive && onRelease && (\r\n                            <button\r\n                                onClick={() => {\r\n                                    if (confirm('Are you sure you want to release this version? It will be marked as inactive.')) {\r\n                                        onRelease();\r\n                                    }\r\n                                }}\r\n                                className=\"text-xs font-semibold text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 hover:underline\"\r\n                            >\r\n                                ðŸš€ Release Version\r\n                            </button>\r\n                        )}\r\n                    </div>\r\n                    <div className=\"flex items-center gap-2\">\r\n                        {source === 'auto' && (\r\n                            <>\r\n                                <button\r\n                                    onClick={handleDownload}\r\n                                    className=\"flex items-center gap-2 px-4 py-2 text-sm font-medium text-slate-600 dark:text-slate-300 hover:text-slate-800 dark:hover:text-slate-100 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg transition-colors\"\r\n                                >\r\n                                    <Download className=\"w-4 h-4\" />\r\n                                    Download\r\n                                </button>\r\n                                <button\r\n                                    onClick={handleCopy}\r\n                                    className={`flex items-center gap-2 px-4 py-2 text-sm font-semibold rounded-lg transition-all ${copied ? 'bg-emerald-100 text-emerald-700' : 'bg-emerald-600 text-white hover:bg-emerald-700'}`}\r\n                                >\r\n                                    {copied ? <Check className=\"w-4 h-4\" /> : <Copy className=\"w-4 h-4\" />}\r\n                                    {copied ? 'Copied!' : 'Copy to Clipboard'}\r\n                                </button>\r\n                                {onSaveChangelog && (\r\n                                    <button\r\n                                        onClick={handleSave}\r\n                                        disabled={saving}\r\n                                        className={`flex items-center gap-2 px-4 py-2 text-sm font-semibold rounded-lg transition-all ${saved ? 'bg-blue-100 text-blue-700' : 'bg-blue-600 text-white hover:bg-blue-700'} disabled:opacity-50`}\r\n                                    >\r\n                                        {saving ? (\r\n                                            <div className=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin\" />\r\n                                        ) : saved ? (\r\n                                            <Check className=\"w-4 h-4\" />\r\n                                        ) : (\r\n                                            <Save className=\"w-4 h-4\" />\r\n                                        )}\r\n                                        {saving ? 'Saving...' : saved ? 'Saved!' : 'Save to Version'}\r\n                                    </button>\r\n                                )}\r\n                            </>\r\n                        )}\r\n                        {source === 'manual' && (\r\n                            <span className=\"text-xs text-slate-500 italic\">Use \"AI Draft\" to generate from manual input</span>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            {\r\n                showPromptPreview && generatedPrompt && (\r\n                    <PromptPreviewModal\r\n                        title={generatedPrompt.title}\r\n                        prompt={generatedPrompt.content}\r\n                        onClose={() => setShowPromptPreview(false)}\r\n                    />\r\n                )\r\n            }\r\n        </div >\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\VersionControl\\my-version-manager\\src\\components\\CommandPalette.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":18,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":18,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[508,511],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[508,511],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":19,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":19,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[533,536],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[533,536],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":20,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":20,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[557,560],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[557,560],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":21,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":21,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[586,589],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[586,589],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":22,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":22,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[615,618],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[615,618],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nD:\\VersionControl\\my-version-manager\\src\\components\\CommandPalette.tsx:73:9\n  71 |\n  72 |     useEffect(() => {\n> 73 |         setSelectedIndex(0);\n     |         ^^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  74 |     }, [query]);\n  75 |\n  76 |     const handleKeyDown = (e: React.KeyboardEvent) => {","line":73,"column":9,"nodeType":null,"endLine":73,"endColumn":25}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useRef, useMemo } from 'react';\r\nimport { Search, Sparkles } from 'lucide-react';\r\nimport PromptPreviewModal from './PromptPreviewModal';\r\nimport { generateAgentPrompts } from '@/lib/promptGenerator';\r\n\r\ninterface Command {\r\n    id: string;\r\n    label: string;\r\n    shortcut?: string;\r\n    action: () => void;\r\n}\r\n\r\ninterface CommandPaletteProps {\r\n    commands: Command[];\r\n    onClose: () => void;\r\n    // Extra Data for Agent Commands\r\n    contextData?: {\r\n        project?: any;\r\n        versions?: any[];\r\n        tasks?: any[];\r\n        activities?: any[];\r\n        latestDump?: any;\r\n    };\r\n}\r\n\r\nexport default function CommandPalette({ commands, onClose, contextData }: CommandPaletteProps) {\r\n    const [query, setQuery] = useState('');\r\n    const [selectedIndex, setSelectedIndex] = useState(0);\r\n    const [generatedPrompt, setGeneratedPrompt] = useState<{ title: string; content: string } | null>(null);\r\n    const inputRef = useRef<HTMLInputElement>(null);\r\n\r\n    const agentCommands: Command[] = useMemo(() => {\r\n        if (!contextData?.project) return [];\r\n        return [\r\n            {\r\n                id: 'agent-summarize',\r\n                label: 'Agent: Summarize Project',\r\n                action: () => {\r\n                    const prompt = generateAgentPrompts.summarizeProject(\r\n                        contextData.project,\r\n                        contextData.versions || [],\r\n                        contextData.tasks || [],\r\n                        contextData.activities || []\r\n                    );\r\n                    setGeneratedPrompt({ title: 'Project Summary', content: prompt });\r\n                }\r\n            },\r\n            {\r\n                id: 'agent-next-task',\r\n                label: 'Agent: Suggest Next Task',\r\n                action: () => {\r\n                    const prompt = generateAgentPrompts.nextTaskSuggestion(\r\n                        contextData.tasks || [],\r\n                        contextData.latestDump?.mental_model || null\r\n                    );\r\n                    setGeneratedPrompt({ title: 'Next Task Suggestion', content: prompt });\r\n                }\r\n            }\r\n        ];\r\n    }, [contextData]);\r\n\r\n    const allCommands = [...agentCommands, ...commands];\r\n\r\n    const filteredCommands = allCommands.filter(cmd =>\r\n        cmd.label.toLowerCase().includes(query.toLowerCase())\r\n    );\r\n\r\n    useEffect(() => {\r\n        inputRef.current?.focus();\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        setSelectedIndex(0);\r\n    }, [query]);\r\n\r\n    const handleKeyDown = (e: React.KeyboardEvent) => {\r\n        switch (e.key) {\r\n            case 'ArrowDown':\r\n                e.preventDefault();\r\n                setSelectedIndex(prev => Math.min(prev + 1, filteredCommands.length - 1));\r\n                break;\r\n            case 'ArrowUp':\r\n                e.preventDefault();\r\n                setSelectedIndex(prev => Math.max(prev - 1, 0));\r\n                break;\r\n            case 'Enter':\r\n                e.preventDefault();\r\n                if (filteredCommands[selectedIndex]) {\r\n                    filteredCommands[selectedIndex].action();\r\n                    // Don't close if it's an agent command (waiting for modal)\r\n                    if (!filteredCommands[selectedIndex].id.startsWith('agent-')) {\r\n                        onClose();\r\n                    }\r\n                }\r\n                break;\r\n            case 'Escape':\r\n                onClose();\r\n                break;\r\n        }\r\n    };\r\n\r\n    if (generatedPrompt) {\r\n        return (\r\n            <PromptPreviewModal\r\n                title={generatedPrompt.title}\r\n                prompt={generatedPrompt.content}\r\n                onClose={() => {\r\n                    setGeneratedPrompt(null);\r\n                    onClose();\r\n                }}\r\n            />\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 bg-black/50 flex items-start justify-center pt-[20vh] z-50\" onClick={onClose}>\r\n            <div\r\n                className=\"bg-white dark:bg-slate-900 rounded-xl shadow-2xl w-full max-w-md overflow-hidden\"\r\n                onClick={e => e.stopPropagation()}\r\n            >\r\n                {/* Search Input */}\r\n                <div className=\"flex items-center gap-3 px-4 py-3 border-b border-slate-100 dark:border-slate-800\">\r\n                    <Search className=\"w-5 h-5 text-slate-400\" />\r\n                    <input\r\n                        ref={inputRef}\r\n                        type=\"text\"\r\n                        value={query}\r\n                        onChange={e => setQuery(e.target.value)}\r\n                        onKeyDown={handleKeyDown}\r\n                        placeholder=\"Type a command...\"\r\n                        className=\"flex-1 bg-transparent text-slate-700 dark:text-slate-200 placeholder-slate-400 focus:outline-none\"\r\n                    />\r\n                </div>\r\n\r\n                {/* Commands List */}\r\n                <div className=\"max-h-64 overflow-y-auto\">\r\n                    {filteredCommands.length > 0 ? (\r\n                        filteredCommands.map((cmd, index) => (\r\n                            <button\r\n                                key={cmd.id}\r\n                                onClick={() => {\r\n                                    cmd.action();\r\n                                    onClose();\r\n                                }}\r\n                                className={`w-full flex items-center justify-between px-4 py-3 text-left transition-all ${index === selectedIndex\r\n                                        ? 'bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-400'\r\n                                        : 'text-slate-700 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-800'\r\n                                    } ${cmd.id.startsWith('agent-') ? 'hover:bg-purple-50 dark:hover:bg-purple-900/10' : ''}`}\r\n                            >\r\n                                <span className={`text-sm flex items-center gap-2 ${cmd.id.startsWith('agent-') ? 'font-medium text-purple-700 dark:text-purple-400' : ''}`}>\r\n                                    {cmd.id.startsWith('agent-') && <Sparkles className=\"w-3.5 h-3.5\" />}\r\n                                    {cmd.label}\r\n                                </span>\r\n                                {cmd.shortcut && (\r\n                                    <kbd className=\"px-2 py-0.5 text-xs bg-slate-100 dark:bg-slate-800 rounded text-slate-500 dark:text-slate-400 font-mono\">\r\n                                        {cmd.shortcut}\r\n                                    </kbd>\r\n                                )}\r\n                            </button>\r\n                        ))\r\n                    ) : (\r\n                        <div className=\"px-4 py-6 text-center text-slate-400 dark:text-slate-500 text-sm\">\r\n                            No commands found\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\VersionControl\\my-version-manager\\src\\components\\ContextBanner.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\VersionControl\\my-version-manager\\src\\components\\ContextDumpModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\VersionControl\\my-version-manager\\src\\components\\CreateVersionModal.tsx","messages":[{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":71,"column":25,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[3947,4052],"text":"\r\n                        &quot;Migrate\" will move all pending tasks to this new version\r\n                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[3947,4052],"text":"\r\n                        &ldquo;Migrate\" will move all pending tasks to this new version\r\n                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[3947,4052],"text":"\r\n                        &#34;Migrate\" will move all pending tasks to this new version\r\n                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[3947,4052],"text":"\r\n                        &rdquo;Migrate\" will move all pending tasks to this new version\r\n                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":71,"column":33,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[3947,4052],"text":"\r\n                        \"Migrate&quot; will move all pending tasks to this new version\r\n                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[3947,4052],"text":"\r\n                        \"Migrate&ldquo; will move all pending tasks to this new version\r\n                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[3947,4052],"text":"\r\n                        \"Migrate&#34; will move all pending tasks to this new version\r\n                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[3947,4052],"text":"\r\n                        \"Migrate&rdquo; will move all pending tasks to this new version\r\n                    "},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState } from 'react';\r\nimport { X, Check, Package } from 'lucide-react';\r\n\r\ninterface CreateVersionModalProps {\r\n    onClose: () => void;\r\n    onCreate: (name: string, migratePending: boolean) => void;\r\n}\r\n\r\nexport default function CreateVersionModal({ onClose, onCreate }: CreateVersionModalProps) {\r\n    const [name, setName] = useState('');\r\n\r\n    const handleCreate = (migratePending: boolean) => {\r\n        if (name.trim()) {\r\n            onCreate(name.trim(), migratePending);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\r\n            <div className=\"bg-white dark:bg-slate-900 rounded-2xl shadow-xl w-full max-w-md overflow-hidden\">\r\n                {/* Header */}\r\n                <div className=\"flex items-center justify-between p-4 border-b border-slate-100 dark:border-slate-800\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <Package className=\"w-5 h-5 text-emerald-600 dark:text-emerald-500\" />\r\n                        <h3 className=\"font-semibold text-slate-800 dark:text-slate-100\">Create Version</h3>\r\n                    </div>\r\n                    <button\r\n                        onClick={onClose}\r\n                        className=\"p-1 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 transition-colors\"\r\n                    >\r\n                        <X className=\"w-5 h-5\" />\r\n                    </button>\r\n                </div>\r\n\r\n                {/* Content */}\r\n                <div className=\"p-4\">\r\n                    <input\r\n                        type=\"text\"\r\n                        value={name}\r\n                        onChange={e => setName(e.target.value)}\r\n                        onKeyDown={e => e.key === 'Enter' && name.trim() && handleCreate(false)}\r\n                        placeholder=\"e.g., v1.0.0\"\r\n                        autoFocus\r\n                        className=\"w-full px-4 py-3 text-lg font-mono border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100 rounded-xl focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent\"\r\n                    />\r\n\r\n                    <div className=\"mt-4 space-y-3\">\r\n                        {/* Secondary - outlined */}\r\n                        <button\r\n                            onClick={() => handleCreate(false)}\r\n                            disabled={!name.trim()}\r\n                            className=\"w-full flex items-center justify-center gap-2 px-4 min-h-12 border-2 border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-300 font-semibold rounded-xl hover:border-slate-400 dark:hover:border-slate-500 hover:bg-slate-50 dark:hover:bg-slate-800 active:bg-slate-100 dark:active:bg-slate-700 transition-all disabled:opacity-40 disabled:cursor-not-allowed\"\r\n                        >\r\n                            Create Empty Version\r\n                        </button>\r\n\r\n                        {/* Primary - filled with shadow */}\r\n                        <button\r\n                            onClick={() => handleCreate(true)}\r\n                            disabled={!name.trim()}\r\n                            className=\"w-full flex items-center justify-center gap-2 px-4 min-h-12 bg-emerald-600 dark:bg-emerald-700 text-white font-semibold rounded-xl hover:bg-emerald-700 dark:hover:bg-emerald-600 active:bg-emerald-800 dark:active:bg-emerald-800 transition-all shadow-md hover:shadow-lg active:shadow-sm disabled:opacity-40 disabled:cursor-not-allowed disabled:shadow-none\"\r\n                        >\r\n                            <Check className=\"w-5 h-5\" />\r\n                            Create & Migrate Pending Tasks\r\n                        </button>\r\n                    </div>\r\n\r\n                    <p className=\"mt-3 text-xs text-slate-400 dark:text-slate-500 text-center\">\r\n                        \"Migrate\" will move all pending tasks to this new version\r\n                    </p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\VersionControl\\my-version-manager\\src\\components\\PromptPreviewModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\VersionControl\\my-version-manager\\src\\components\\Sidebar.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nD:\\VersionControl\\my-version-manager\\src\\components\\Sidebar.tsx:215:9\n  213 |             });\n  214 |         });\n> 215 |         setPendingFolders(prev => prev.filter(f => !projectPrefixes.has(f)));\n      |         ^^^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  216 |     }, [projects]);\n  217 |\n  218 |     const toggleFolder = (path: string) => {","line":215,"column":9,"nodeType":null,"endLine":215,"endColumn":26},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":517,"column":4,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":517,"endColumn":7,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[23687,23690],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[23687,23690],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":564,"column":164,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":564,"endColumn":167,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[26789,26792],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[26789,26792],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":564,"column":264,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":564,"endColumn":267,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[26889,26892],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[26889,26892],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":568,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":568,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[27447,27450],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[27447,27450],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":580,"column":177,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":580,"endColumn":180,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[28306,28309],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[28306,28309],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":603,"column":79,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":603,"endColumn":82,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[30114,30117],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[30114,30117],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":617,"column":63,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":617,"endColumn":66,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[31313,31316],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[31313,31316],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":628,"column":98,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":628,"endColumn":101,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[32118,32121],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[32118,32121],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":9,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport {\r\n    Layers,\r\n    Activity,\r\n    Settings,\r\n    Menu,\r\n    X,\r\n    Plus,\r\n    ChevronRight,\r\n    ChevronDown,\r\n    Folder,\r\n    FolderOpen,\r\n    FileText,\r\n    FolderPlus,\r\n    FilePlus,\r\n    Search,\r\n    Pencil,\r\n    Trash2,\r\n    MoreHorizontal,\r\n    Building2\r\n} from 'lucide-react';\r\nimport { ThemeToggle } from './theme-toggle';\r\nimport { useState, useMemo, useRef, useEffect, useCallback } from 'react';\r\nimport { Project } from '@/lib/types';\r\nimport { createPortal } from 'react-dom';\r\nimport {\r\n    DndContext,\r\n    DragOverlay,\r\n    useDraggable,\r\n    useDroppable,\r\n    PointerSensor,\r\n    useSensor,\r\n    useSensors,\r\n    DragEndEvent,\r\n    DragStartEvent\r\n} from '@dnd-kit/core';\r\n\r\ninterface SidebarProps {\r\n    projects: Project[];\r\n    selectedProjectId: string;\r\n    onSelectProject: (id: string) => void;\r\n    onCreateProject: (name: string) => Promise<Project | null>;\r\n    onUpdateProject: (id: string, name: string) => Promise<boolean>;\r\n    onDeleteProject: (id: string) => Promise<boolean>;\r\n    onOpenActivity: () => void;\r\n    onOpenWorkflow?: () => void;\r\n    width?: number;\r\n    setWidth?: (w: number) => void;\r\n}\r\n\r\ntype TreeNode = {\r\n    id: string;\r\n    name: string;\r\n    fullPath: string;\r\n    type: 'folder' | 'project';\r\n    children: TreeNode[];\r\n    projectId?: string;\r\n    isPending?: boolean;\r\n};\r\n\r\ntype ContextMenuState = {\r\n    x: number;\r\n    y: number;\r\n    nodeType: 'root' | 'folder' | 'project';\r\n    path: string;\r\n    projectId?: string;\r\n} | null;\r\n\r\nexport default function Sidebar({\r\n    projects,\r\n    selectedProjectId,\r\n    onSelectProject,\r\n    onCreateProject,\r\n    onUpdateProject,\r\n    onDeleteProject,\r\n    onOpenActivity,\r\n    onOpenWorkflow,\r\n    width = 256,\r\n    setWidth\r\n}: SidebarProps) {\r\n    const [isMobileMenuOpen, setIsMobileMenuOpen] = useState(false);\r\n    const [collapsedFolders, setCollapsedFolders] = useState<Record<string, boolean>>({});\r\n    const [searchQuery, setSearchQuery] = useState('');\r\n    const [contextMenu, setContextMenu] = useState<ContextMenuState>(null);\r\n    const [pendingFolders, setPendingFolders] = useState<string[]>([]);\r\n    const [activeDragId, setActiveDragId] = useState<string | null>(null);\r\n    const [isResizing, setIsResizing] = useState(false);\r\n    const sidebarRef = useRef<HTMLElement>(null);\r\n\r\n    const sensors = useSensors(\r\n        useSensor(PointerSensor, {\r\n            activationConstraint: {\r\n                distance: 8,\r\n            },\r\n        })\r\n    );\r\n\r\n    const startResizing = useCallback(() => setIsResizing(true), []);\r\n    const stopResizing = useCallback(() => setIsResizing(false), []);\r\n\r\n    const resize = useCallback(\r\n        (mouseMoveEvent: MouseEvent) => {\r\n            if (isResizing && setWidth) {\r\n                const newWidth = mouseMoveEvent.clientX;\r\n                if (newWidth >= 200 && newWidth <= 600) {\r\n                    setWidth(newWidth);\r\n                }\r\n            }\r\n        },\r\n        [isResizing, setWidth]\r\n    );\r\n\r\n    useEffect(() => {\r\n        window.addEventListener('mousemove', resize);\r\n        window.addEventListener('mouseup', stopResizing);\r\n        return () => {\r\n            window.removeEventListener('mousemove', resize);\r\n            window.removeEventListener('mouseup', stopResizing);\r\n        };\r\n    }, [resize, stopResizing]);\r\n\r\n    // Creation State\r\n    const [creationState, setCreationState] = useState<{\r\n        active: boolean;\r\n        type: 'folder' | 'project';\r\n        parentPath: string;\r\n        value: string;\r\n    }>({ active: false, type: 'project', parentPath: '', value: '' });\r\n\r\n    // Rename State\r\n    const [renameState, setRenameState] = useState<{\r\n        active: boolean;\r\n        projectId: string;\r\n        currentName: string;\r\n        value: string;\r\n    }>({ active: false, projectId: '', currentName: '', value: '' });\r\n\r\n    // Build Tree\r\n    const tree = useMemo(() => {\r\n        const root: TreeNode[] = [];\r\n        const getFolder = (nodes: TreeNode[], name: string, currentPath: string, isPending = false): TreeNode => {\r\n            let node = nodes.find(n => n.name === name && n.type === 'folder');\r\n            if (!node) {\r\n                node = {\r\n                    id: `folder-${currentPath}`,\r\n                    name,\r\n                    fullPath: currentPath,\r\n                    type: 'folder',\r\n                    children: [],\r\n                    isPending\r\n                };\r\n                nodes.push(node);\r\n            }\r\n            return node;\r\n        };\r\n\r\n        pendingFolders.forEach(folderPath => {\r\n            const parts = folderPath.split('/');\r\n            let currentLevel = root;\r\n            let currentPath = '';\r\n            parts.forEach((part) => {\r\n                currentPath = currentPath ? `${currentPath}/${part}` : part;\r\n                const folder = getFolder(currentLevel, part, currentPath, true);\r\n                currentLevel = folder.children;\r\n            });\r\n        });\r\n\r\n        const sortedProjects = [...projects].sort((a, b) => a.name.localeCompare(b.name));\r\n        sortedProjects.forEach(project => {\r\n            const parts = project.name.split('/');\r\n            let currentLevel = root;\r\n            let currentPath = '';\r\n            parts.forEach((part, index) => {\r\n                const isLast = index === parts.length - 1;\r\n                currentPath = currentPath ? `${currentPath}/${part}` : part;\r\n                if (isLast) {\r\n                    currentLevel.push({\r\n                        id: project.id,\r\n                        name: part,\r\n                        fullPath: project.name,\r\n                        type: 'project',\r\n                        children: [],\r\n                        projectId: project.id\r\n                    });\r\n                } else {\r\n                    const folder = getFolder(currentLevel, part, currentPath);\r\n                    folder.isPending = false;\r\n                    currentLevel = folder.children;\r\n                }\r\n            });\r\n        });\r\n\r\n        const sortNodes = (nodes: TreeNode[]) => {\r\n            nodes.sort((a, b) => {\r\n                if (a.type !== b.type) return a.type === 'folder' ? -1 : 1;\r\n                return a.name.localeCompare(b.name);\r\n            });\r\n            nodes.forEach(n => sortNodes(n.children));\r\n        };\r\n        sortNodes(root);\r\n        return root;\r\n    }, [projects, pendingFolders]);\r\n\r\n    useEffect(() => {\r\n        const projectPrefixes = new Set<string>();\r\n        projects.forEach(p => {\r\n            const parts = p.name.split('/');\r\n            let path = '';\r\n            parts.slice(0, -1).forEach(part => {\r\n                path = path ? `${path}/${part}` : part;\r\n                projectPrefixes.add(path);\r\n            });\r\n        });\r\n        setPendingFolders(prev => prev.filter(f => !projectPrefixes.has(f)));\r\n    }, [projects]);\r\n\r\n    const toggleFolder = (path: string) => {\r\n        setCollapsedFolders(prev => ({ ...prev, [path]: !prev[path] }));\r\n    };\r\n\r\n    const handleCreate = async () => {\r\n        if (!creationState.value.trim()) {\r\n            setCreationState({ ...creationState, active: false });\r\n            return;\r\n        }\r\n        const name = creationState.value.trim();\r\n        const finalName = creationState.parentPath ? `${creationState.parentPath}/${name}` : name;\r\n\r\n        if (creationState.type === 'project') {\r\n            const newProject = await onCreateProject(finalName);\r\n            if (newProject) onSelectProject(newProject.id);\r\n        } else {\r\n            setPendingFolders(prev => [...prev, finalName]);\r\n            setCollapsedFolders(prev => ({ ...prev, [finalName]: false }));\r\n            setCreationState({ active: true, type: 'project', parentPath: finalName, value: '' });\r\n            return;\r\n        }\r\n        setCreationState({ ...creationState, active: false, value: '' });\r\n    };\r\n\r\n    const handleRename = async () => {\r\n        if (!renameState.value.trim() || renameState.value === renameState.currentName) {\r\n            setRenameState({ active: false, projectId: '', currentName: '', value: '' });\r\n            return;\r\n        }\r\n        const parts = renameState.currentName.split('/');\r\n        parts[parts.length - 1] = renameState.value.trim();\r\n        const newName = parts.join('/');\r\n        await onUpdateProject(renameState.projectId, newName);\r\n        setRenameState({ active: false, projectId: '', currentName: '', value: '' });\r\n    };\r\n\r\n    const handleDelete = async (projectId: string, projectName: string) => {\r\n        if (confirm(`Delete project \"${projectName}\"?`)) {\r\n            await onDeleteProject(projectId);\r\n        }\r\n    };\r\n\r\n    const handleDeleteFolder = async (folderPath: string) => {\r\n        const projectsInFolder = projects.filter(p => p.name.startsWith(folderPath + '/') || p.name === folderPath);\r\n        if (projectsInFolder.length === 0) {\r\n            setPendingFolders(prev => prev.filter(f => !f.startsWith(folderPath)));\r\n            return;\r\n        }\r\n        if (confirm(`Delete folder \"${folderPath}\" and all contents?`)) {\r\n            for (const p of projectsInFolder) await onDeleteProject(p.id);\r\n            setPendingFolders(prev => prev.filter(f => !f.startsWith(folderPath)));\r\n        }\r\n    };\r\n\r\n    const openContextMenu = (e: React.MouseEvent, nodeType: 'root' | 'folder' | 'project', path: string, projectId?: string) => {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        setContextMenu({ x: e.clientX, y: e.clientY, nodeType, path, projectId });\r\n    };\r\n\r\n\r\n    // DnD Logic\r\n    const handleDragStart = (event: DragStartEvent) => {\r\n        setActiveDragId(event.active.id as string);\r\n    };\r\n\r\n    const handleDragEnd = async (event: DragEndEvent) => {\r\n        const { active, over } = event;\r\n        setActiveDragId(null);\r\n\r\n        if (!over) return;\r\n\r\n        const activeId = active.id as string;\r\n        const overId = over.id as string;\r\n\r\n        // Find active project\r\n        const project = projects.find(p => p.id === activeId);\r\n        if (!project) return;\r\n\r\n        let newPath = '';\r\n\r\n        if (overId === 'root-drop-zone') {\r\n            // Drop to root\r\n            newPath = project.name.split('/').pop() || '';\r\n        } else if (overId.startsWith('folder-')) {\r\n            // Drop into folder\r\n            const folderPath = overId.replace('folder-', '');\r\n            const projectName = project.name.split('/').pop();\r\n            newPath = `${folderPath}/${projectName}`;\r\n        } else {\r\n            return; // Dropped on something else (or another project - implementation detail: maybe support reordering later)\r\n        }\r\n\r\n        if (newPath && newPath !== project.name) {\r\n            await onUpdateProject(project.id, newPath);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <button\r\n                onClick={() => setIsMobileMenuOpen(!isMobileMenuOpen)}\r\n                className=\"lg:hidden fixed top-3 left-4 z-50 p-2 bg-slate-900 text-white rounded-md shadow-lg\"\r\n            >\r\n                {isMobileMenuOpen ? <X size={20} /> : <Menu size={20} />}\r\n            </button>\r\n\r\n            {isMobileMenuOpen && (\r\n                <div\r\n                    className=\"fixed inset-0 bg-black/50 z-40 lg:hidden\"\r\n                    onClick={() => setIsMobileMenuOpen(false)}\r\n                />\r\n            )}\r\n\r\n            <aside\r\n                ref={sidebarRef}\r\n                className={`\r\n                fixed top-0 left-0 h-full bg-slate-50 dark:bg-slate-950 text-slate-600 dark:text-slate-400 border-r border-slate-200 dark:border-slate-800 z-40 transition-transform duration-300 ease-in-out\r\n                ${isMobileMenuOpen ? 'translate-x-0' : '-translate-x-full lg:translate-x-0'}\r\n                flex flex-col font-sans select-none\r\n            `}\r\n                style={{ width: isMobileMenuOpen ? '100%' : `${width}px` }}\r\n            >\r\n                {/* Resizer Handle */}\r\n                <div\r\n                    className=\"absolute right-0 top-0 w-1.5 h-full cursor-col-resize hover:bg-emerald-500/20 transition-colors z-50 opacity-0 hover:opacity-100\"\r\n                    onMouseDown={startResizing}\r\n                />\r\n                <DndContext sensors={sensors} onDragStart={handleDragStart} onDragEnd={handleDragEnd}>\r\n                    {/* Header */}\r\n                    <div className=\"h-16 flex items-center px-4 border-b border-slate-200 dark:border-slate-800 bg-slate-50/80 dark:bg-slate-950/80 backdrop-blur-md shrink-0\">\r\n                        <div className=\"w-8 h-8 bg-white dark:bg-slate-900 text-emerald-600 dark:text-emerald-500 rounded-xl flex items-center justify-center mr-3 ring-1 ring-slate-200 dark:ring-slate-800 shadow-sm\">\r\n                            <Layers className=\"w-5 h-5\" />\r\n                        </div>\r\n                        <div>\r\n                            <span className=\"font-bold text-slate-800 dark:text-slate-200 text-lg leading-tight block\">MVM</span>\r\n                            <span className=\"text-[10px] text-slate-500 dark:text-slate-500 font-medium tracking-wide uppercase\">Workspace</span>\r\n                        </div>\r\n                        <div className=\"ml-auto flex items-center gap-1\">\r\n                            <ThemeToggle />\r\n                            <button\r\n                                onClick={(e) => openContextMenu(e, 'root', '')}\r\n                                className=\"w-8 h-8 flex items-center justify-center rounded-lg hover:bg-slate-200 dark:hover:bg-slate-800 text-slate-400 hover:text-slate-700 dark:hover:text-slate-300 transition-colors\"\r\n                            >\r\n                                <Plus className=\"w-5 h-5\" />\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Search */}\r\n                    <div className=\"px-3 pt-4 pb-2\">\r\n                        <div className=\"relative group\">\r\n                            <Search className=\"absolute left-2.5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-slate-400 group-focus-within:text-emerald-500 transition-colors\" />\r\n                            <input\r\n                                type=\"text\"\r\n                                placeholder=\"Filter projects...\"\r\n                                value={searchQuery}\r\n                                onChange={(e) => setSearchQuery(e.target.value)}\r\n                                className=\"w-full bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-lg py-1.5 pl-8 pr-3 text-xs text-slate-700 dark:text-slate-300 focus:outline-none focus:border-emerald-500 focus:ring-1 focus:ring-emerald-500/20 transition-all placeholder:text-slate-400 shadow-sm\"\r\n                            />\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Tree */}\r\n                    <div className=\"flex-1 overflow-y-auto px-2 py-2 space-y-0.5 scrollbar-thin scrollbar-thumb-slate-800 scrollbar-track-transparent relative\">\r\n                        {/* Root Drop Zone */}\r\n                        <RootDropZone>\r\n                            {/* Creation Input */}\r\n                            {creationState.active && !creationState.parentPath && (\r\n                                <CreationInput\r\n                                    type={creationState.type}\r\n                                    value={creationState.value}\r\n                                    onChange={(v: string) => setCreationState(prev => ({ ...prev, value: v }))}\r\n                                    onSubmit={handleCreate}\r\n                                    onCancel={() => setCreationState(prev => ({ ...prev, active: false }))}\r\n                                    indent={0}\r\n                                />\r\n                            )}\r\n\r\n                            {tree.map(node => (\r\n                                <TreeNodeItem\r\n                                    key={node.id}\r\n                                    node={node}\r\n                                    level={0}\r\n                                    selectedProjectId={selectedProjectId}\r\n                                    onSelectProject={onSelectProject}\r\n                                    collapsedFolders={collapsedFolders}\r\n                                    onToggleFolder={toggleFolder}\r\n                                    onContextMenu={openContextMenu}\r\n                                    searchQuery={searchQuery}\r\n                                    creationState={creationState}\r\n                                    setCreationState={setCreationState}\r\n                                    onCreateSubmit={handleCreate}\r\n                                    renameState={renameState}\r\n                                    setRenameState={setRenameState}\r\n                                    onRenameSubmit={handleRename}\r\n                                />\r\n                            ))}\r\n\r\n                            {/* Empty State */}\r\n                            {projects.length === 0 && pendingFolders.length === 0 && !creationState.active && (\r\n                                <div className=\"px-4 py-8 text-center pointer-events-none\">\r\n                                    <div className=\"w-12 h-12 mx-auto mb-3 rounded-full bg-slate-800 dark:bg-slate-800/50 flex items-center justify-center\">\r\n                                        <FolderPlus className=\"w-6 h-6 text-slate-600 dark:text-slate-400\" />\r\n                                    </div>\r\n                                    <p className=\"text-slate-500 dark:text-slate-400 text-xs mb-3\">No projects yet</p>\r\n                                    <div className=\"flex flex-col gap-2 pointer-events-auto\">\r\n                                        <button onClick={() => setCreationState({ active: true, type: 'project', parentPath: '', value: '' })} className=\"text-emerald-500 text-xs font-medium hover:underline flex items-center justify-center gap-1\"><FilePlus size={12} /> New Project</button>\r\n                                        <button onClick={() => setCreationState({ active: true, type: 'folder', parentPath: '', value: '' })} className=\"text-slate-400 dark:text-slate-500 text-xs hover:text-slate-300 dark:hover:text-slate-400 flex items-center justify-center gap-1\"><FolderPlus size={12} /> New Folder</button>\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n\r\n                            {/* Filling empty space to make dropping to root easy */}\r\n                            <div className=\"h-full min-h-[50px]\" />\r\n                        </RootDropZone>\r\n                    </div>\r\n\r\n                    <DragOverlay>\r\n                        {activeDragId ? (\r\n                            <div className=\"px-3 py-2 bg-white dark:bg-slate-900 rounded-lg shadow-xl border border-emerald-500/30 text-emerald-600 dark:text-emerald-500 text-sm font-medium flex items-center gap-2 opacity-90 ring-1 ring-slate-200 dark:ring-slate-700\">\r\n                                <FileText size={14} />\r\n                                <span>Moving project...</span>\r\n                            </div>\r\n                        ) : null}\r\n                    </DragOverlay>\r\n                </DndContext>\r\n\r\n                {/* Footer */}\r\n                <div className=\"p-3 border-t border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-950\">\r\n                    {onOpenWorkflow && (\r\n                        <button onClick={onOpenWorkflow} className=\"w-full flex items-center gap-3 px-3 py-2 text-sm font-medium text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20 hover:bg-blue-100 dark:hover:bg-blue-900/40 rounded-lg transition-all mb-1\">\r\n                            <Building2 className=\"w-4 h-4\" />\r\n                            <span>Daily Workflow</span>\r\n                        </button>\r\n                    )}\r\n                    <button onClick={onOpenActivity} className=\"w-full flex items-center gap-3 px-3 py-2 text-sm font-medium text-slate-500 hover:bg-slate-200 dark:hover:bg-slate-800 hover:text-slate-900 dark:hover:text-slate-100 rounded-lg transition-all\"><Activity className=\"w-4 h-4\" /><span>Activity</span></button>\r\n                    <button className=\"w-full flex items-center gap-3 px-3 py-2 text-sm font-medium text-slate-500 hover:bg-slate-200 dark:hover:bg-slate-800 hover:text-slate-900 dark:hover:text-slate-100 rounded-lg transition-all\"><Settings className=\"w-4 h-4\" /><span>Settings</span></button>\r\n                </div>\r\n            </aside>\r\n\r\n            {contextMenu && (\r\n                <ContextMenu\r\n                    x={contextMenu.x}\r\n                    y={contextMenu.y}\r\n                    nodeType={contextMenu.nodeType}\r\n                    onClose={() => setContextMenu(null)}\r\n                    onNewProject={() => {\r\n                        setCreationState({ active: true, type: 'project', parentPath: contextMenu.path, value: '' });\r\n                        if (contextMenu.path) setCollapsedFolders(prev => ({ ...prev, [contextMenu.path]: false }));\r\n                        setContextMenu(null);\r\n                    }}\r\n                    onNewFolder={() => {\r\n                        setCreationState({ active: true, type: 'folder', parentPath: contextMenu.path, value: '' });\r\n                        if (contextMenu.path) setCollapsedFolders(prev => ({ ...prev, [contextMenu.path]: false }));\r\n                        setContextMenu(null);\r\n                    }}\r\n                    onRename={() => {\r\n                        if (contextMenu.nodeType === 'project' && contextMenu.projectId) {\r\n                            const project = projects.find(p => p.id === contextMenu.projectId);\r\n                            if (project) {\r\n                                const nameParts = project.name.split('/');\r\n                                setRenameState({ active: true, projectId: project.id, currentName: project.name, value: nameParts[nameParts.length - 1] });\r\n                            }\r\n                        }\r\n                        setContextMenu(null);\r\n                    }}\r\n                    onDelete={() => {\r\n                        if (contextMenu.nodeType === 'project' && contextMenu.projectId) handleDelete(contextMenu.projectId, contextMenu.path);\r\n                        else if (contextMenu.nodeType === 'folder') handleDeleteFolder(contextMenu.path);\r\n                        setContextMenu(null);\r\n                    }}\r\n                />\r\n            )}\r\n        </>\r\n    );\r\n}\r\n\r\n// --- Subcomponents ---\r\n\r\nfunction RootDropZone({ children }: { children: React.ReactNode }) {\r\n    const { setNodeRef, isOver } = useDroppable({\r\n        id: 'root-drop-zone',\r\n    });\r\n\r\n    return (\r\n        <div ref={setNodeRef} className={`min-h-full transition-colors ${isOver ? 'bg-emerald-50/50' : ''}`}>\r\n            {children}\r\n            {isOver && (\r\n                <div className=\"absolute inset-0 border-2 border-dashed border-emerald-300 rounded-lg pointer-events-none z-10 m-2 bg-emerald-50/50 flex items-center justify-center\">\r\n                    <span className=\"text-emerald-600 font-medium text-sm\">Drop to move to Root</span>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction TreeNodeItem({\r\n    node, level, selectedProjectId, onSelectProject, collapsedFolders, onToggleFolder, onContextMenu, searchQuery, creationState, setCreationState, onCreateSubmit, renameState, setRenameState, onRenameSubmit\r\n}: any) {\r\n    const isExpanded = !collapsedFolders[node.fullPath];\r\n    const isSelected = node.type === 'project' && node.projectId === selectedProjectId;\r\n    const isRenaming = renameState.active && renameState.projectId === node.projectId;\r\n    const matchesSearch = !searchQuery || node.fullPath.toLowerCase().includes(searchQuery.toLowerCase());\r\n    const isCreatingInside = creationState.active && creationState.parentPath === node.fullPath;\r\n\r\n    // Draggable Hook\r\n    const { attributes, listeners, setNodeRef: setDragRef, isDragging } = useDraggable({\r\n        id: node.projectId || node.id,\r\n        disabled: node.type !== 'project' || isRenaming\r\n    });\r\n\r\n    // Droppable Hook (Only for folders)\r\n    const { setNodeRef: setDropRef, isOver } = useDroppable({\r\n        id: node.id,\r\n        disabled: node.type !== 'folder'\r\n    });\r\n\r\n    // Combine refs if needed (currently separate elements)\r\n\r\n    if (node.type === 'folder') {\r\n        return (\r\n            <div ref={setDropRef} className={`rounded-lg transition-colors ${isOver ? 'bg-emerald-50 ring-1 ring-emerald-200' : ''}`}>\r\n                <button\r\n                    onClick={() => onToggleFolder(node.fullPath)}\r\n                    onContextMenu={(e) => onContextMenu(e, 'folder', node.fullPath)}\r\n                    className={`\r\n                        w-full flex items-center gap-2 px-2 py-2 rounded-lg text-sm font-medium transition-colors select-none group text-left\r\n                        ${searchQuery ? 'bg-slate-100 dark:bg-slate-800' : 'hover:bg-slate-200/50 dark:hover:bg-slate-800/50'}\r\n                        ${node.isPending ? 'text-slate-400 italic' : 'text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-200'}\r\n                    `}\r\n                    style={{ paddingLeft: `${level * 12 + 8}px` }}\r\n                >\r\n                    <span className=\"opacity-70 group-hover:opacity-100 transition-opacity text-slate-400 dark:text-slate-500\">\r\n                        {isExpanded ? <ChevronDown size={16} /> : <ChevronRight size={16} />}\r\n                    </span>\r\n                    <span className={node.isPending ? 'text-amber-500/60' : 'text-slate-400 dark:text-slate-500 group-hover:text-emerald-500 transition-colors'}>\r\n                        {isExpanded ? <FolderOpen size={16} /> : <Folder size={16} />}\r\n                    </span>\r\n                    <span className=\"truncate flex-1\">{node.name}</span>\r\n                    {node.isPending && <span className=\"text-[11px] text-amber-500/60 font-normal\">(empty)</span>}\r\n                    <span onClick={(e) => onContextMenu(e, 'folder', node.fullPath)} className=\"opacity-0 group-hover:opacity-100 p-1 hover:bg-slate-200 dark:hover:bg-slate-800 rounded text-slate-500 dark:text-slate-400 transition-all\"><MoreHorizontal size={14} /></span>\r\n                </button>\r\n\r\n                {isExpanded && (\r\n                    <div>\r\n                        {isCreatingInside && <CreationInput type={creationState.type} value={creationState.value} onChange={(v: string) => setCreationState((prev: any) => ({ ...prev, value: v }))} onSubmit={onCreateSubmit} onCancel={() => setCreationState((prev: any) => ({ ...prev, active: false }))} indent={level + 1} />}\r\n                        {node.children.length === 0 && !isCreatingInside && node.isPending && (\r\n                            <div className=\"text-xs text-slate-400 py-2 cursor-pointer hover:text-emerald-600 transition-colors\" style={{ paddingLeft: `${(level + 1) * 12 + 28}px` }} onClick={() => setCreationState({ active: true, type: 'project', parentPath: node.fullPath, value: '' })}>+ Add first project...</div>\r\n                        )}\r\n                        {node.children.map((child: any) => (\r\n                            <TreeNodeItem key={child.id} node={child} level={level + 1} selectedProjectId={selectedProjectId} onSelectProject={onSelectProject} collapsedFolders={collapsedFolders} onToggleFolder={onToggleFolder} onContextMenu={onContextMenu} searchQuery={searchQuery} creationState={creationState} setCreationState={setCreationState} onCreateSubmit={onCreateSubmit} renameState={renameState} setRenameState={setRenameState} onRenameSubmit={onRenameSubmit} />\r\n                        ))}\r\n                    </div>\r\n                )}\r\n            </div>\r\n        );\r\n    }\r\n\r\n    if (!matchesSearch && searchQuery) return null;\r\n\r\n    if (isRenaming) {\r\n        return <div className=\"px-2 py-1\" style={{ paddingLeft: `${level * 12 + 28}px` }}><RenameInput value={renameState.value} onChange={(v: string) => setRenameState((prev: any) => ({ ...prev, value: v }))} onSubmit={onRenameSubmit} onCancel={() => setRenameState({ active: false, projectId: '', currentName: '', value: '' })} /></div>;\r\n    }\r\n\r\n    return (\r\n        <div ref={setDragRef} {...listeners} {...attributes} style={{ opacity: isDragging ? 0.5 : 1 }}>\r\n            <button\r\n                onClick={() => onSelectProject(node.projectId!)}\r\n                onContextMenu={(e) => onContextMenu(e, 'project', node.fullPath, node.projectId)}\r\n                className={`\r\n                    w-full flex items-center gap-2 px-2 py-2 rounded-lg text-[15px] transition-all group relative text-left\r\n                    ${isSelected ? 'bg-white dark:bg-slate-800 text-emerald-700 dark:text-emerald-400 font-semibold shadow-sm ring-1 ring-slate-200 dark:ring-slate-700' : 'text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-200 hover:bg-slate-200/50 dark:hover:bg-slate-800/50'}\r\n                `}\r\n                style={{ paddingLeft: `${level * 12 + 28}px` }}\r\n            >\r\n                <FileText size={16} className={`shrink-0 ${isSelected ? 'text-emerald-500' : 'opacity-70 group-hover:opacity-100 text-slate-400 dark:text-slate-500'}`} />\r\n                <span className=\"truncate flex-1\">{node.name}</span>\r\n                {isSelected && <div className=\"absolute right-3 w-1.5 h-1.5 rounded-full bg-emerald-500\" />}\r\n                <span onClick={(e) => onContextMenu(e, 'project', node.fullPath, node.projectId)} className=\"opacity-0 group-hover:opacity-100 p-1 hover:bg-slate-200 dark:hover:bg-slate-800 rounded text-slate-500 dark:text-slate-400 transition-all\"><MoreHorizontal size={14} /></span>\r\n            </button>\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction CreationInput({ type, value, onChange, onSubmit, onCancel, indent }: any) {\r\n    const inputRef = useRef<HTMLInputElement>(null);\r\n    useEffect(() => { inputRef.current?.focus(); }, []);\r\n    return (\r\n        <div className=\"px-2 py-1\" style={{ paddingLeft: `${indent * 12 + 8}px` }}>\r\n            <div className=\"flex items-center gap-2 bg-white rounded px-2 py-1.5 ring-1 ring-emerald-500/50 shadow-sm animate-in fade-in duration-200\">\r\n                {type === 'folder' ? <Folder size={14} className=\"text-amber-500\" /> : <FileText size={14} className=\"text-slate-400\" />}\r\n                <input ref={inputRef} type=\"text\" value={value} onChange={e => onChange(e.target.value)} onKeyDown={e => { if (e.key === 'Enter') onSubmit(); if (e.key === 'Escape') onCancel(); }} onBlur={() => { if (!value) onCancel(); }} placeholder={type === 'folder' ? 'Folder name...' : 'Project name...'} className=\"w-full bg-transparent text-xs text-slate-700 placeholder-slate-400 focus:outline-none\" />\r\n            </div>\r\n            <div className=\"text-[10px] text-slate-400 mt-1 ml-6\">{type === 'folder' ? 'Enter to create folder' : 'Enter to create project'} â€¢ Esc to cancel</div>\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction RenameInput({ value, onChange, onSubmit, onCancel }: any) {\r\n    const inputRef = useRef<HTMLInputElement>(null);\r\n    useEffect(() => { inputRef.current?.focus(); inputRef.current?.select(); }, []);\r\n    return (\r\n        <div className=\"flex items-center gap-2 bg-white rounded px-2 py-1 ring-1 ring-blue-500/50 shadow-sm animate-in fade-in duration-200\">\r\n            <Pencil size={14} className=\"text-blue-500\" />\r\n            <input ref={inputRef} type=\"text\" value={value} onChange={e => onChange(e.target.value)} onKeyDown={e => { if (e.key === 'Enter') onSubmit(); if (e.key === 'Escape') onCancel(); }} onBlur={onSubmit} className=\"w-full bg-transparent text-xs text-slate-700 placeholder-slate-400 focus:outline-none\" />\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction ContextMenu({ x, y, nodeType, onClose, onNewProject, onNewFolder, onRename, onDelete }: any) {\r\n    if (typeof document === 'undefined') return null;\r\n    const menuWidth = 192;\r\n    const menuHeight = nodeType === 'root' ? 100 : 160;\r\n    const adjustedX = Math.min(x, window.innerWidth - menuWidth - 10);\r\n    const adjustedY = Math.min(y, window.innerHeight - menuHeight - 10);\r\n    return createPortal(\r\n        <>\r\n            <div className=\"fixed inset-0 z-[100]\" onClick={onClose} />\r\n            <div className=\"fixed z-[101] bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-lg shadow-xl p-1 w-48 animate-in zoom-in-95 duration-100 ring-1 ring-slate-200 dark:ring-slate-800\" style={{ top: adjustedY, left: adjustedX }}>\r\n                <div className=\"px-2 py-1.5 text-[10px] font-bold text-slate-400 dark:text-slate-500 uppercase tracking-wider mb-1 border-b border-slate-100 dark:border-slate-800\">{nodeType === 'root' ? 'Workspace' : nodeType === 'folder' ? 'Folder' : 'Project'}</div>\r\n                {(nodeType === 'root' || nodeType === 'folder') && (<><button onClick={onNewProject} className=\"w-full flex items-center gap-2 px-2 py-1.5 text-xs text-slate-600 dark:text-slate-300 hover:bg-emerald-50 dark:hover:bg-emerald-900/30 hover:text-emerald-700 dark:hover:text-emerald-400 rounded transition-colors text-left\"><FilePlus size={14} /> New Project</button><button onClick={onNewFolder} className=\"w-full flex items-center gap-2 px-2 py-1.5 text-xs text-slate-600 dark:text-slate-300 hover:bg-amber-50 dark:hover:bg-amber-900/30 hover:text-amber-700 dark:hover:text-amber-400 rounded transition-colors text-left\"><FolderPlus size={14} /> New Folder</button></>)}\r\n                {(nodeType === 'project' || nodeType === 'folder') && <div className=\"border-t border-slate-100 dark:border-slate-800 my-1\" />}\r\n                {nodeType === 'project' && <button onClick={onRename} className=\"w-full flex items-center gap-2 px-2 py-1.5 text-xs text-slate-600 dark:text-slate-300 hover:bg-blue-50 dark:hover:bg-blue-900/30 hover:text-blue-700 dark:hover:text-blue-400 rounded transition-colors text-left\"><Pencil size={14} /> Rename</button>}\r\n                {(nodeType === 'project' || nodeType === 'folder') && <button onClick={onDelete} className=\"w-full flex items-center gap-2 px-2 py-1.5 text-xs text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/30 hover:text-red-700 dark:hover:text-red-300 rounded transition-colors text-left\"><Trash2 size={14} /> Delete {nodeType === 'folder' ? 'Folder' : 'Project'}</button>}\r\n            </div>\r\n        </>,\r\n        document.body\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\VersionControl\\my-version-manager\\src\\components\\TaskDrawer.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Clock' is defined but never used.","line":2,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":28,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Clock"},"fix":{"range":[66,73],"text":""},"desc":"Remove unused variable \"Clock\"."}]},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nD:\\VersionControl\\my-version-manager\\src\\components\\TaskDrawer.tsx:19:13\n  17 |     useEffect(() => {\n  18 |         if (task) {\n> 19 |             setDescription(task.description || '');\n     |             ^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  20 |         }\n  21 |     }, [task]);\n  22 |","line":19,"column":13,"nodeType":null,"endLine":19,"endColumn":27},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":99,"column":93,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":99,"endColumn":96,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4607,4610],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4607,4610],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { X, Calendar, Clock, Tag, Flag, CheckCircle2, Circle } from 'lucide-react';\r\nimport ReactMarkdown from 'react-markdown';\r\nimport { Task } from '@/lib/types';\r\n\r\ninterface TaskDrawerProps {\r\n    task: Task | null;\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    onUpdate: (taskId: string, updates: Partial<Task>) => void;\r\n}\r\n\r\nexport default function TaskDrawer({ task, isOpen, onClose, onUpdate }: TaskDrawerProps) {\r\n    const [description, setDescription] = useState('');\r\n    const [isPreview, setIsPreview] = useState(false);\r\n\r\n    useEffect(() => {\r\n        if (task) {\r\n            setDescription(task.description || '');\r\n        }\r\n    }, [task]);\r\n\r\n    if (!task) return null;\r\n\r\n    const handleSaveDescription = () => {\r\n        if (task && description !== task.description) {\r\n            onUpdate(task.id, { description });\r\n        }\r\n    };\r\n\r\n    const toggleStatus = () => {\r\n        onUpdate(task.id, { isDone: !task.isDone });\r\n    };\r\n\r\n    const handlePriorityChange = (priority: Task['priority']) => {\r\n        onUpdate(task.id, { priority });\r\n    };\r\n\r\n    const priorityColors = {\r\n        none: 'bg-slate-100 text-slate-600',\r\n        low: 'bg-blue-100 text-blue-700',\r\n        medium: 'bg-amber-100 text-amber-700',\r\n        high: 'bg-orange-100 text-orange-700',\r\n        urgent: 'bg-red-100 text-red-700',\r\n    };\r\n\r\n    return (\r\n        <>\r\n            {/* Backdrop */}\r\n            {isOpen && (\r\n                <div\r\n                    className=\"fixed inset-0 bg-black/20 z-40 transition-opacity\"\r\n                    onClick={onClose}\r\n                />\r\n            )}\r\n\r\n            {/* Drawer */}\r\n            <div className={`fixed inset-y-0 right-0 w-full sm:w-[480px] bg-white dark:bg-slate-900 shadow-2xl z-50 transform transition-transform duration-300 ease-in-out ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}>\r\n                <div className=\"h-full flex flex-col\">\r\n                    {/* Header */}\r\n                    <div className=\"px-6 py-4 border-b border-slate-100 dark:border-slate-800 flex items-start justify-between bg-slate-50/50 dark:bg-slate-800/50\">\r\n                        <div className=\"flex items-center gap-3\">\r\n                            <button\r\n                                onClick={toggleStatus}\r\n                                className={`flex-shrink-0 transition-colors ${task.isDone ? 'text-emerald-500' : 'text-slate-300 hover:text-emerald-500'}`}\r\n                            >\r\n                                {task.isDone ? <CheckCircle2 className=\"w-6 h-6\" /> : <Circle className=\"w-6 h-6\" />}\r\n                            </button>\r\n                            <div className=\"text-sm text-slate-500 dark:text-slate-400 font-mono\">\r\n                                {task.id.slice(0, 8)}\r\n                            </div>\r\n                        </div>\r\n                        <button onClick={onClose} className=\"p-1 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800\">\r\n                            <X className=\"w-5 h-5\" />\r\n                        </button>\r\n                    </div>\r\n\r\n                    {/* Scrollable Content */}\r\n                    <div className=\"flex-1 overflow-y-auto p-6 space-y-8\">\r\n                        {/* Title */}\r\n                        <div>\r\n                            <input\r\n                                type=\"text\"\r\n                                value={task.content}\r\n                                onChange={(e) => onUpdate(task.id, { content: e.target.value })}\r\n                                className=\"w-full text-xl font-semibold text-slate-800 dark:text-slate-100 bg-transparent border-none focus:ring-0 p-0 placeholder-slate-300 dark:placeholder-slate-600\"\r\n                                placeholder=\"Task title\"\r\n                            />\r\n                        </div>\r\n\r\n                        {/* Priority & Meta */}\r\n                        <div className=\"flex flex-wrap gap-4\">\r\n                            <div className=\"flex items-center gap-2\">\r\n                                <span className=\"text-xs font-medium text-slate-400 uppercase tracking-wider flex items-center gap-1\">\r\n                                    <Flag className=\"w-3 h-3\" /> Priority\r\n                                </span>\r\n                                <select\r\n                                    value={task.priority || 'none'}\r\n                                    onChange={(e) => handlePriorityChange(e.target.value as any)}\r\n                                    className={`text-xs font-semibold px-2 py-1 rounded-full cursor-pointer border-none focus:ring-0 ${priorityColors[task.priority || 'none']}`}\r\n                                >\r\n                                    <option value=\"none\">None</option>\r\n                                    <option value=\"low\">Low</option>\r\n                                    <option value=\"medium\">Medium</option>\r\n                                    <option value=\"high\">High</option>\r\n                                    <option value=\"urgent\">Urgent</option>\r\n                                </select>\r\n                            </div>\r\n\r\n                            {/* Date */}\r\n                            <div className=\"flex items-center gap-2\">\r\n                                <span className=\"text-xs font-medium text-slate-400 uppercase tracking-wider flex items-center gap-1\">\r\n                                    <Calendar className=\"w-3 h-3\" /> Created\r\n                                </span>\r\n                                <span className=\"text-xs text-slate-600 dark:text-slate-400 font-medium\">\r\n                                    {new Date(task.createdAt).toLocaleDateString()}\r\n                                </span>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Description */}\r\n                        <div className=\"space-y-3\">\r\n                            <div className=\"flex items-center justify-between\">\r\n                                <span className=\"text-xs font-medium text-slate-400 uppercase tracking-wider\">Description</span>\r\n                                <button\r\n                                    onClick={() => setIsPreview(!isPreview)}\r\n                                    className=\"text-xs font-medium text-blue-600 hover:text-blue-700 hover:underline\"\r\n                                >\r\n                                    {isPreview ? 'Edit' : 'Preview'}\r\n                                </button>\r\n                            </div>\r\n\r\n                            {isPreview ? (\r\n                                <div className=\"prose prose-sm prose-slate dark:prose-invert max-w-none bg-slate-50 dark:bg-slate-800/50 p-4 rounded-xl min-h-[150px] border border-slate-100 dark:border-slate-800\">\r\n                                    <ReactMarkdown>\r\n                                        {description || '*No description provided*'}\r\n                                    </ReactMarkdown>\r\n                                </div>\r\n                            ) : (\r\n                                <textarea\r\n                                    value={description}\r\n                                    onChange={(e) => setDescription(e.target.value)}\r\n                                    onBlur={handleSaveDescription}\r\n                                    placeholder=\"Add a detailed description... (Markdown supported)\"\r\n                                    className=\"w-full h-40 bg-slate-50 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-800 rounded-xl p-4 text-sm text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-400 transition-all resize-y placeholder-slate-400\"\r\n                                />\r\n                            )}\r\n                        </div>\r\n\r\n                        {/* Labels (Placeholder for now, can implement tag input later) */}\r\n                        <div className=\"space-y-3\">\r\n                            <span className=\"text-xs font-medium text-slate-400 uppercase tracking-wider flex items-center gap-1\">\r\n                                <Tag className=\"w-3 h-3\" /> Labels\r\n                            </span>\r\n                            <div className=\"flex flex-wrap gap-2\">\r\n                                <div className=\"flex flex-wrap gap-2 items-center\">\r\n                                    {(task.labels || []).map(label => (\r\n                                        <span key={label} className=\"group flex items-center gap-1.5 px-2.5 py-1 bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-xs font-medium rounded-full border border-slate-200 dark:border-slate-700\">\r\n                                            {label}\r\n                                            <button\r\n                                                onClick={() => {\r\n                                                    const newLabels = (task.labels || []).filter(l => l !== label);\r\n                                                    onUpdate(task.id, { labels: newLabels });\r\n                                                }}\r\n                                                className=\"hover:text-red-500 rounded-full focus:outline-none\"\r\n                                            >\r\n                                                <X className=\"w-3 h-3\" />\r\n                                            </button>\r\n                                        </span>\r\n                                    ))}\r\n\r\n                                    <div className=\"relative flex items-center\">\r\n                                        <input\r\n                                            type=\"text\"\r\n                                            placeholder=\"+ Label\"\r\n                                            className=\"w-20 px-2 py-1 text-xs bg-transparent border border-dashed border-slate-300 dark:border-slate-600 rounded-full focus:w-32 focus:border-blue-400 focus:ring-1 focus:ring-blue-400 focus:outline-none transition-all placeholder-slate-400 text-slate-600 dark:text-slate-300\"\r\n                                            onKeyDown={(e) => {\r\n                                                if (e.key === 'Enter') {\r\n                                                    const val = e.currentTarget.value.trim();\r\n                                                    if (val && !(task.labels || []).includes(val)) {\r\n                                                        onUpdate(task.id, { labels: [...(task.labels || []), val] });\r\n                                                        e.currentTarget.value = '';\r\n                                                    }\r\n                                                }\r\n                                            }}\r\n                                        />\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Footer */}\r\n                    <div className=\"p-4 border-t border-slate-100 dark:border-slate-800 bg-slate-50/50 dark:bg-slate-800/50 flex justify-end\">\r\n                        <button onClick={onClose} className=\"px-4 py-2 text-sm font-medium text-slate-600 dark:text-slate-400 hover:text-slate-800 dark:hover:text-slate-200\">\r\n                            Close\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\VersionControl\\my-version-manager\\src\\components\\TopBar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\VersionControl\\my-version-manager\\src\\components\\VersionSection.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'progressPercent' is assigned a value but never used.","line":105,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":105,"endColumn":26}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useRef, useEffect } from 'react';\r\nimport { Plus, Circle, CheckCircle2, Trash2, Pencil, Maximize2, FileText, MoreVertical, Rocket } from 'lucide-react';\r\nimport { Version, Task } from '@/lib/types';\r\nimport { useSortable, SortableContext, verticalListSortingStrategy } from '@dnd-kit/sortable';\r\nimport { CSS } from '@dnd-kit/utilities';\r\nimport { GripVertical } from 'lucide-react';\r\nimport { useDroppable } from '@dnd-kit/core';\r\n\r\ninterface VersionSectionProps {\r\n    version: Version;\r\n    tasks: Task[];\r\n    onAddTask: (content: string) => void;\r\n    onToggleDone: (taskId: string, isDone: boolean) => void;\r\n    onUpdateTask: (taskId: string, content: string) => void;\r\n    onDeleteTask: (taskId: string) => void;\r\n    onOpenTask: (task: Task) => void;\r\n    onGenerateChangelog?: () => void;\r\n    onDeleteVersion?: (id: string) => void;\r\n    onSetActiveVersion?: (id: string) => void;\r\n    onUpdateVersion?: (id: string, updates: Partial<Version>) => void;\r\n    isUnassigned?: boolean;\r\n    isSelectionMode?: boolean;\r\n    selectedTaskIds?: Set<string>;\r\n    onToggleSelectTask?: (taskId: string) => void;\r\n}\r\n\r\nexport default function VersionSection({\r\n    version,\r\n    tasks,\r\n    onAddTask,\r\n    onToggleDone,\r\n    onUpdateTask,\r\n    onDeleteTask,\r\n    onOpenTask,\r\n    onGenerateChangelog,\r\n    onDeleteVersion,\r\n    onSetActiveVersion,\r\n    onUpdateVersion,\r\n    isUnassigned = false,\r\n    isSelectionMode = false,\r\n    selectedTaskIds = new Set(),\r\n    onToggleSelectTask = () => { },\r\n}: VersionSectionProps) {\r\n    const [newTaskContent, setNewTaskContent] = useState('');\r\n    const [isMenuOpen, setIsMenuOpen] = useState(false);\r\n    const [isEditingName, setIsEditingName] = useState(false);\r\n    const [editName, setEditName] = useState(version.name);\r\n    const menuRef = useRef<HTMLDivElement>(null);\r\n    const nameInputRef = useRef<HTMLInputElement>(null);\r\n\r\n    // Close menu when clicking outside\r\n    useEffect(() => {\r\n        const handleClickOutside = (event: MouseEvent) => {\r\n            if (menuRef.current && !menuRef.current.contains(event.target as Node)) {\r\n                setIsMenuOpen(false);\r\n            }\r\n        };\r\n        document.addEventListener('mousedown', handleClickOutside);\r\n        return () => document.removeEventListener('mousedown', handleClickOutside);\r\n    }, []);\r\n\r\n    const { setNodeRef } = useDroppable({\r\n        id: version.id,\r\n    });\r\n\r\n    // Focus name input when editing starts\r\n    useEffect(() => {\r\n        if (isEditingName && nameInputRef.current) {\r\n            nameInputRef.current.focus();\r\n            nameInputRef.current.select();\r\n        }\r\n    }, [isEditingName]);\r\n\r\n    const handleAddTask = () => {\r\n        if (newTaskContent.trim()) {\r\n            onAddTask(newTaskContent.trim());\r\n            setNewTaskContent('');\r\n        }\r\n    };\r\n\r\n    const handleSaveName = () => {\r\n        if (editName.trim() && editName !== version.name && onUpdateVersion) {\r\n            onUpdateVersion(version.id, { name: editName.trim() });\r\n        } else {\r\n            setEditName(version.name);\r\n        }\r\n        setIsEditingName(false);\r\n    };\r\n\r\n    const handleKeyDownName = (e: React.KeyboardEvent) => {\r\n        if (e.key === 'Enter') handleSaveName();\r\n        if (e.key === 'Escape') {\r\n            setEditName(version.name);\r\n            setIsEditingName(false);\r\n        }\r\n    };\r\n\r\n    // Sort already handled by parent hook, but re-sort locally if needed for done status\r\n    const sortedTasks = [...tasks];\r\n\r\n    const doneCount = tasks.filter(t => t.isDone).length;\r\n    const totalCount = tasks.length;\r\n    const progressPercent = totalCount > 0 ? Math.round((doneCount / totalCount) * 100) : 0;\r\n\r\n    const borderColor = isUnassigned\r\n        ? 'border-l-amber-500'\r\n        : version.isActive\r\n            ? 'border-l-emerald-500'\r\n            : 'border-l-slate-400';\r\n\r\n    return (\r\n        <div className={`bg-white dark:bg-slate-900 border border-l-4 rounded-xl shadow-sm hover:shadow-md transition-shadow ${borderColor} ${isUnassigned ? 'border-amber-200 dark:border-amber-900/50' : version.isActive ? 'border-emerald-200 dark:border-emerald-900/50' : 'border-slate-200 dark:border-slate-800'}`}>\r\n            {/* Header */}\r\n            <div\r\n                className={`w-full px-4 py-3 transition-colors relative ${isUnassigned ? 'bg-amber-50/50 dark:bg-amber-950/10 hover:bg-amber-50 dark:hover:bg-amber-950/20' : version.isActive ? 'bg-emerald-50/50 dark:bg-emerald-950/10 hover:bg-emerald-50 dark:hover:bg-emerald-950/20' : 'bg-slate-50/50 dark:bg-slate-800/50 hover:bg-slate-50 dark:hover:bg-slate-800/80'}`}\r\n            >\r\n                {/* Main Header Row */}\r\n                <div className=\"flex items-center gap-3\">\r\n                    <div className=\"flex-1 min-w-0 flex items-center gap-2\">\r\n                        {isEditingName ? (\r\n                            <input\r\n                                ref={nameInputRef}\r\n                                type=\"text\"\r\n                                value={editName}\r\n                                onChange={(e) => setEditName(e.target.value)}\r\n                                onBlur={handleSaveName}\r\n                                onKeyDown={handleKeyDownName}\r\n                                className=\"font-mono font-semibold text-slate-800 dark:text-slate-200 bg-white dark:bg-slate-900 border border-blue-300 dark:border-blue-700 rounded px-2 py-0.5 focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm w-full\"\r\n                                onClick={(e) => e.stopPropagation()}\r\n                            />\r\n                        ) : (\r\n                            <span\r\n                                className={`font-mono font-semibold truncate block text-sm ${isUnassigned ? 'text-amber-700 dark:text-amber-500' : version.isActive ? 'text-emerald-700 dark:text-emerald-500' : 'text-slate-700 dark:text-slate-300'}`}\r\n                                onDoubleClick={() => {\r\n                                    if (!isUnassigned && onUpdateVersion) setIsEditingName(true);\r\n                                }}\r\n                                title={!isUnassigned && onUpdateVersion ? \"Double click to rename\" : \"\"}\r\n                            >\r\n                                {version.name}\r\n                            </span>\r\n                        )}\r\n                    </div>\r\n\r\n                    {/* Menu Button (Always visible on right for Board, or desktop List) */}\r\n                    <div className=\"shrink-0 relative\" ref={menuRef}>\r\n                        {!isUnassigned && (\r\n                            <>\r\n                                <button\r\n                                    onClick={(e) => {\r\n                                        e.stopPropagation();\r\n                                        setIsMenuOpen(!isMenuOpen);\r\n                                    }}\r\n                                    className=\"p-1.5 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 hover:bg-slate-200/50 dark:hover:bg-slate-700/50 rounded-lg transition-colors\"\r\n                                >\r\n                                    <MoreVertical className=\"w-4 h-4\" />\r\n                                </button>\r\n                                {isMenuOpen && (\r\n                                    <div className=\"absolute right-0 top-full mt-1 w-48 bg-white dark:bg-slate-900 rounded-lg shadow-xl border border-slate-100 dark:border-slate-800 z-50 animate-in fade-in zoom-in-95 duration-100 overflow-hidden\">\r\n                                        {!version.isActive && onSetActiveVersion && (\r\n                                            <button\r\n                                                onClick={(e) => { e.stopPropagation(); onSetActiveVersion(version.id); setIsMenuOpen(false); }}\r\n                                                className=\"w-full text-left px-4 py-2 text-xs font-medium text-emerald-600 dark:text-emerald-500 hover:bg-emerald-50 dark:hover:bg-emerald-900/20 flex items-center gap-2\"\r\n                                            >\r\n                                                <Rocket className=\"w-4 h-4\" /> Set as Active\r\n                                            </button>\r\n                                        )}\r\n                                        {onGenerateChangelog && (\r\n                                            <button\r\n                                                onClick={(e) => { e.stopPropagation(); onGenerateChangelog(); setIsMenuOpen(false); }}\r\n                                                className=\"w-full text-left px-4 py-2 text-xs font-medium text-blue-600 dark:text-blue-500 hover:bg-blue-50 dark:hover:bg-blue-900/20 flex items-center gap-2\"\r\n                                            >\r\n                                                <FileText className=\"w-4 h-4\" /> View Changelog\r\n                                            </button>\r\n                                        )}\r\n                                        {onUpdateVersion && (\r\n                                            <button\r\n                                                onClick={(e) => { e.stopPropagation(); setIsEditingName(true); setIsMenuOpen(false); }}\r\n                                                className=\"w-full text-left px-4 py-2 text-xs font-medium text-slate-600 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800 flex items-center gap-2\"\r\n                                            >\r\n                                                <Pencil className=\"w-4 h-4\" /> Rename Version\r\n                                            </button>\r\n                                        )}\r\n                                        <div className=\"h-px bg-slate-100 dark:bg-slate-800 my-1\" />\r\n                                        {onDeleteVersion && (\r\n                                            <button\r\n                                                onClick={(e) => { e.stopPropagation(); if (confirm('Delete version?')) onDeleteVersion(version.id); setIsMenuOpen(false); }}\r\n                                                className=\"w-full text-left px-4 py-2 text-xs font-medium text-red-600 dark:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 flex items-center gap-2\"\r\n                                            >\r\n                                                <Trash2 className=\"w-4 h-4\" /> Delete Version\r\n                                            </button>\r\n                                        )}\r\n                                    </div>\r\n                                )}\r\n                            </>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Meta Row (Badges, Date) */}\r\n                <div className=\"flex items-center gap-2 ml-auto\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                        {version.isActive && !isUnassigned && (\r\n                            <span className=\"px-2 py-0.5 text-[10px] font-bold bg-emerald-100 dark:bg-emerald-900/50 text-emerald-700 dark:text-emerald-400 rounded-full uppercase tracking-wide\">Active</span>\r\n                        )}\r\n                        {!version.isActive && !isUnassigned && (\r\n                            <span className=\"px-2 py-0.5 text-[10px] font-bold bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400 rounded-full uppercase tracking-wide\">Released</span>\r\n                        )}\r\n                        {isUnassigned && (\r\n                            <span className=\"px-2 py-0.5 text-[10px] font-bold bg-amber-100 dark:bg-amber-900/50 text-amber-700 dark:text-amber-400 rounded-full uppercase tracking-wide\">Backlog</span>\r\n                        )}\r\n\r\n                        {!isUnassigned && (\r\n                            <span className=\"px-2 py-0.5 text-[10px] text-slate-400 dark:text-slate-500 font-medium bg-white/50 dark:bg-slate-900/50 rounded-md border border-slate-100 dark:border-slate-800\" title={new Date(version.createdAt).toLocaleString()}>\r\n                                {new Date(version.createdAt).toLocaleDateString('vi-VN', { day: '2-digit', month: '2-digit', year: 'numeric' })}\r\n                            </span>\r\n                        )}\r\n                    </div>\r\n\r\n                    {/* Task count */}\r\n                    <span className=\"text-sm text-slate-500 dark:text-slate-400 font-medium\">{doneCount}/{totalCount}</span>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Task Table - Always visible */}\r\n            <div ref={setNodeRef} className=\"border-t border-slate-100 dark:border-slate-800 min-h-[50px]\">\r\n                {sortedTasks.length > 0 ? (\r\n                    <SortableContext items={sortedTasks.map(t => t.id)} strategy={verticalListSortingStrategy}>\r\n                        <div className=\"divide-y divide-slate-100 dark:divide-slate-800\">\r\n                            {sortedTasks.map(task => (\r\n                                <SortableTaskRow\r\n                                    key={task.id}\r\n                                    task={task}\r\n                                    onToggleDone={onToggleDone}\r\n                                    onUpdate={onUpdateTask}\r\n                                    onDelete={onDeleteTask}\r\n                                    onOpen={onOpenTask}\r\n                                    isSelectionMode={isSelectionMode}\r\n                                    isSelected={selectedTaskIds.has(task.id)}\r\n                                    onToggleSelect={() => onToggleSelectTask(task.id)}\r\n                                />\r\n                            ))}\r\n                        </div>\r\n                    </SortableContext>\r\n                ) : (\r\n                    <div className=\"px-4 py-6 text-center text-slate-400 dark:text-slate-500 text-sm\">\r\n                        No tasks in this version\r\n                    </div>\r\n                )}\r\n\r\n                {/* Add Task Input */}\r\n                <div className=\"flex items-center gap-2 px-4 py-3 bg-slate-50 dark:bg-slate-900 border-t border-slate-100 dark:border-slate-800\">\r\n                    <Plus className=\"w-4 h-4 text-slate-400 dark:text-slate-500\" />\r\n                    <input\r\n                        data-add-task\r\n                        type=\"text\"\r\n                        value={newTaskContent}\r\n                        onChange={e => setNewTaskContent(e.target.value)}\r\n                        onKeyDown={e => e.key === 'Enter' && handleAddTask()}\r\n                        placeholder=\"Add task...\"\r\n                        className=\"flex-1 bg-transparent text-sm placeholder-slate-400 dark:placeholder-slate-500 focus:outline-none dark:text-slate-200\"\r\n                    />\r\n                    {newTaskContent && (\r\n                        <button\r\n                            onClick={handleAddTask}\r\n                            className=\"px-4 py-2 text-sm font-semibold bg-blue-600 dark:bg-blue-700 text-white rounded-lg hover:bg-blue-700 dark:hover:bg-blue-600 active:bg-blue-800 transition-all shadow-sm\"\r\n                        >\r\n                            Add Task\r\n                        </button>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\ninterface TaskRowProps {\r\n    task: Task;\r\n    onToggleDone: (taskId: string, isDone: boolean) => void;\r\n    onUpdate: (taskId: string, content: string) => void;\r\n    onDelete: (taskId: string) => void;\r\n    onOpen: (task: Task) => void;\r\n    isSelectionMode?: boolean;\r\n    isSelected?: boolean;\r\n    onToggleSelect?: () => void;\r\n}\r\n\r\nfunction SortableTaskRow(props: TaskRowProps) {\r\n    const {\r\n        attributes,\r\n        listeners,\r\n        setNodeRef,\r\n        transform,\r\n        transition,\r\n        isDragging,\r\n    } = useSortable({ id: props.task.id });\r\n\r\n    const style = {\r\n        transform: CSS.Transform.toString(transform),\r\n        transition,\r\n        zIndex: isDragging ? 10 : 'auto',\r\n        opacity: isDragging ? 0.5 : 1,\r\n        position: 'relative' as const,\r\n    };\r\n\r\n    return (\r\n        <div ref={setNodeRef} style={style} className=\"group/sortable flex relative bg-white dark:bg-slate-900\">\r\n            <div\r\n                {...attributes}\r\n                {...listeners}\r\n                className=\"flex items-center justify-center w-8 cursor-grab active:cursor-grabbing text-slate-300 dark:text-slate-600 hover:text-slate-500 dark:hover:text-slate-400 absolute left-0 top-0 bottom-0 z-10 opacity-0 group-hover/sortable:opacity-100 transition-opacity\"\r\n            >\r\n                <GripVertical size={14} />\r\n            </div>\r\n            <div className={`flex-1 ${!props.isSelectionMode ? 'pl-6' : ''}`}>\r\n                <TaskRow {...props} />\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction TaskRow({ task, onToggleDone, onUpdate, onDelete, onOpen, isSelectionMode, isSelected, onToggleSelect }: TaskRowProps) {\r\n    const [isEditing, setIsEditing] = useState(false);\r\n    const [editContent, setEditContent] = useState(task.content);\r\n    const inputRef = useRef<HTMLInputElement>(null);\r\n\r\n    useEffect(() => {\r\n        if (isEditing && inputRef.current) {\r\n            inputRef.current.focus();\r\n            inputRef.current.select();\r\n        }\r\n    }, [isEditing]);\r\n\r\n    const handleSave = () => {\r\n        if (editContent.trim() && editContent !== task.content) {\r\n            onUpdate(task.id, editContent.trim());\r\n        } else {\r\n            setEditContent(task.content);\r\n        }\r\n        setIsEditing(false);\r\n    };\r\n\r\n    const handleKeyDown = (e: React.KeyboardEvent) => {\r\n        if (e.key === 'Enter') handleSave();\r\n        if (e.key === 'Escape') {\r\n            setEditContent(task.content);\r\n            setIsEditing(false);\r\n        }\r\n    };\r\n\r\n    const formatDate = (dateStr: string) => {\r\n        const date = new Date(dateStr);\r\n        return date.toLocaleDateString('vi-VN', { day: '2-digit', month: '2-digit', year: 'numeric' });\r\n    };\r\n\r\n    return (\r\n        <div className={`group flex items-center gap-3 px-4 py-2.5 hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors ${isSelected ? 'bg-blue-50/50 dark:bg-blue-900/10' : ''}`}>\r\n\r\n            {/* Selection Checkbox */}\r\n            {isSelectionMode && (\r\n                <div className=\"flex-shrink-0 mr-2\">\r\n                    <input\r\n                        type=\"checkbox\"\r\n                        checked={isSelected}\r\n                        onChange={onToggleSelect}\r\n                        className=\"w-5 h-5 rounded border-slate-300 dark:border-slate-600 text-blue-600 focus:ring-blue-500 cursor-pointer bg-white dark:bg-slate-800\"\r\n                    />\r\n                </div>\r\n            )}\r\n\r\n            {!isSelectionMode && (\r\n                <button\r\n                    onClick={() => onToggleDone(task.id, !task.isDone)}\r\n                    className={`\r\n                        flex-shrink-0 flex items-center justify-center\r\n                        w-11 h-11 -ml-2 rounded-lg\r\n                        transition-all duration-150 ease-out\r\n                        active:scale-90\r\n                        ${task.isDone\r\n                            ? 'text-emerald-600 dark:text-emerald-500 hover:text-emerald-700 dark:hover:text-emerald-400 hover:bg-emerald-50 dark:hover:bg-emerald-900/20'\r\n                            : 'text-slate-400 dark:text-slate-500 hover:text-emerald-500 dark:hover:text-emerald-400 hover:bg-emerald-50 dark:hover:bg-emerald-900/20'\r\n                        }\r\n                    `}\r\n                    title={task.isDone ? 'Mark as pending' : 'Mark as done'}\r\n                >\r\n                    {task.isDone ? <CheckCircle2 className=\"w-6 h-6\" /> : <Circle className=\"w-6 h-6\" />}\r\n                </button>\r\n            )}\r\n\r\n            {isEditing ? (\r\n                <input\r\n                    ref={inputRef}\r\n                    type=\"text\"\r\n                    value={editContent}\r\n                    onChange={e => setEditContent(e.target.value)}\r\n                    onBlur={handleSave}\r\n                    onKeyDown={handleKeyDown}\r\n                    className=\"flex-1 px-2 py-1 text-sm border border-blue-300 dark:border-blue-700 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100\"\r\n                />\r\n            ) : (\r\n                <span\r\n                    onDoubleClick={() => setIsEditing(true)}\r\n                    className=\"flex-1 text-sm cursor-text text-slate-700 dark:text-slate-300\"\r\n                >\r\n                    {task.content}\r\n                </span>\r\n            )}\r\n\r\n            <span className=\"text-xs text-slate-400 dark:text-slate-500 hidden sm:block\">\r\n                {formatDate(task.doneAt || task.createdAt)}\r\n            </span>\r\n\r\n            <div className=\"flex items-center gap-0.5 opacity-0 group-hover:opacity-100 transition-opacity\">\r\n                <button\r\n                    onClick={() => onOpen(task)}\r\n                    className=\"flex items-center justify-center w-8 h-8 rounded-lg text-slate-400 dark:text-slate-500 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 active:bg-blue-100 transition-all\"\r\n                    title=\"Open Details\"\r\n                >\r\n                    <Maximize2 className=\"w-4 h-4\" />\r\n                </button>\r\n                <button\r\n                    onClick={() => setIsEditing(true)}\r\n                    className=\"flex items-center justify-center w-8 h-8 rounded-lg text-slate-400 dark:text-slate-500 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 active:bg-blue-100 transition-all\"\r\n                    title=\"Edit (E)\"\r\n                >\r\n                    <Pencil className=\"w-4 h-4\" />\r\n                </button>\r\n                <button\r\n                    onClick={() => onDelete(task.id)}\r\n                    className=\"flex items-center justify-center w-8 h-8 rounded-lg text-slate-400 dark:text-slate-500 hover:text-red-600 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 active:bg-red-100 transition-all\"\r\n                    title=\"Delete\"\r\n                >\r\n                    <Trash2 className=\"w-4 h-4\" />\r\n                </button>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\VersionControl\\my-version-manager\\src\\components\\WorkflowPanel.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Circle' is defined but never used.","line":7,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":11,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Circle"},"fix":{"range":[95,108],"text":""},"desc":"Remove unused variable \"Circle\"."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":219,"column":72,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[10032,10061],"text":"All done! You&apos;re ready to go."},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[10032,10061],"text":"All done! You&lsquo;re ready to go."},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[10032,10061],"text":"All done! You&#39;re ready to go."},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[10032,10061],"text":"All done! You&rsquo;re ready to go."},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useMemo } from 'react';\r\nimport {\r\n    X,\r\n    CheckCircle2,\r\n    Circle,\r\n    Building2,\r\n    Home,\r\n    Brain,\r\n    ListChecks,\r\n    Activity,\r\n    Sparkles,\r\n    Clock,\r\n    ChevronRight\r\n} from 'lucide-react';\r\n\r\ninterface WorkflowPanelProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    workspaceLocation: 'office' | 'home';\r\n    // Data\r\n    projectName?: string;\r\n    pendingTasksCount: number;\r\n    completedTodayCount: number;\r\n    hasUnreadContextDump: boolean;\r\n    lastActivityTime?: string;\r\n    // Actions\r\n    onOpenContextDump: () => void;\r\n    onOpenActivityLog: () => void;\r\n    onMarkContextRead?: () => void;\r\n}\r\n\r\ninterface ChecklistItem {\r\n    id: string;\r\n    label: string;\r\n    description?: string;\r\n    completed: boolean;\r\n    action?: () => void;\r\n    icon: React.ReactNode;\r\n}\r\n\r\nexport default function WorkflowPanel({\r\n    isOpen,\r\n    onClose,\r\n    workspaceLocation,\r\n    projectName,\r\n    pendingTasksCount,\r\n    completedTodayCount,\r\n    hasUnreadContextDump,\r\n    lastActivityTime,\r\n    onOpenContextDump,\r\n    onOpenActivityLog,\r\n    onMarkContextRead,\r\n}: WorkflowPanelProps) {\r\n    const [checkedItems, setCheckedItems] = useState<Set<string>>(new Set());\r\n\r\n    const toggleItem = (id: string) => {\r\n        setCheckedItems(prev => {\r\n            const next = new Set(prev);\r\n            if (next.has(id)) next.delete(id);\r\n            else next.add(id);\r\n            return next;\r\n        });\r\n    };\r\n\r\n    // Office Workflow - Before Leaving\r\n    const officeChecklist: ChecklistItem[] = useMemo(() => [\r\n        {\r\n            id: 'context-dump',\r\n            label: 'Create Context Dump',\r\n            description: 'Save your mental model for the next session',\r\n            completed: checkedItems.has('context-dump'),\r\n            action: onOpenContextDump,\r\n            icon: <Brain className=\"w-4 h-4\" />,\r\n        },\r\n        {\r\n            id: 'update-tasks',\r\n            label: 'Update Task Status',\r\n            description: `${completedTodayCount} completed, ${pendingTasksCount} pending`,\r\n            completed: checkedItems.has('update-tasks') || completedTodayCount > 0,\r\n            icon: <ListChecks className=\"w-4 h-4\" />,\r\n        },\r\n        {\r\n            id: 'review-activities',\r\n            label: 'Review Activities',\r\n            description: 'Check activity log for completeness',\r\n            completed: checkedItems.has('review-activities'),\r\n            action: onOpenActivityLog,\r\n            icon: <Activity className=\"w-4 h-4\" />,\r\n        },\r\n    ], [checkedItems, completedTodayCount, pendingTasksCount, onOpenContextDump, onOpenActivityLog]);\r\n\r\n    // Home Workflow - Welcome Back\r\n    const homeChecklist: ChecklistItem[] = useMemo(() => [\r\n        {\r\n            id: 'load-context',\r\n            label: hasUnreadContextDump ? 'Read Context Dump' : 'Context Already Read',\r\n            description: hasUnreadContextDump ? 'Load your previous session context' : 'You\\'re up to date!',\r\n            completed: !hasUnreadContextDump,\r\n            action: hasUnreadContextDump ? onMarkContextRead : undefined,\r\n            icon: <Brain className=\"w-4 h-4\" />,\r\n        },\r\n        {\r\n            id: 'check-activities',\r\n            label: 'Check Recent Activities',\r\n            description: lastActivityTime ? `Last activity: ${lastActivityTime}` : 'No recent activities',\r\n            completed: checkedItems.has('check-activities'),\r\n            action: onOpenActivityLog,\r\n            icon: <Clock className=\"w-4 h-4\" />,\r\n        },\r\n        {\r\n            id: 'plan-next',\r\n            label: 'Plan Next Actions',\r\n            description: `${pendingTasksCount} tasks waiting`,\r\n            completed: checkedItems.has('plan-next'),\r\n            icon: <Sparkles className=\"w-4 h-4\" />,\r\n        },\r\n    ], [checkedItems, hasUnreadContextDump, lastActivityTime, pendingTasksCount, onMarkContextRead, onOpenActivityLog]);\r\n\r\n    const checklist = workspaceLocation === 'office' ? officeChecklist : homeChecklist;\r\n    const allCompleted = checklist.every(item => item.completed || checkedItems.has(item.id));\r\n\r\n    if (!isOpen) return null;\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\" onClick={onClose}>\r\n            <div\r\n                className=\"bg-white dark:bg-slate-900 rounded-2xl shadow-2xl w-full max-w-md overflow-hidden\"\r\n                onClick={e => e.stopPropagation()}\r\n            >\r\n                {/* Header */}\r\n                <div className={`px-6 py-4 border-b border-slate-100 dark:border-slate-800 flex items-center justify-between ${workspaceLocation === 'office'\r\n                        ? 'bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20'\r\n                        : 'bg-gradient-to-r from-amber-50 to-orange-50 dark:from-amber-900/20 dark:to-orange-900/20'\r\n                    }`}>\r\n                    <div className=\"flex items-center gap-3\">\r\n                        <div className={`w-10 h-10 rounded-xl flex items-center justify-center ${workspaceLocation === 'office'\r\n                                ? 'bg-blue-100 dark:bg-blue-900/30'\r\n                                : 'bg-amber-100 dark:bg-amber-900/30'\r\n                            }`}>\r\n                            {workspaceLocation === 'office'\r\n                                ? <Building2 className=\"w-5 h-5 text-blue-600 dark:text-blue-400\" />\r\n                                : <Home className=\"w-5 h-5 text-amber-600 dark:text-amber-400\" />\r\n                            }\r\n                        </div>\r\n                        <div>\r\n                            <h2 className=\"font-bold text-slate-800 dark:text-slate-100 text-lg\">\r\n                                {workspaceLocation === 'office' ? 'Before Leaving Office' : 'Welcome Back!'}\r\n                            </h2>\r\n                            <p className=\"text-sm text-slate-500 dark:text-slate-400\">\r\n                                {projectName || 'No project selected'}\r\n                            </p>\r\n                        </div>\r\n                    </div>\r\n                    <button\r\n                        onClick={onClose}\r\n                        className=\"p-2 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg transition-colors\"\r\n                    >\r\n                        <X className=\"w-5 h-5\" />\r\n                    </button>\r\n                </div>\r\n\r\n                {/* Checklist */}\r\n                <div className=\"p-4 space-y-2\">\r\n                    {checklist.map((item, index) => {\r\n                        const isCompleted = item.completed || checkedItems.has(item.id);\r\n                        return (\r\n                            <div\r\n                                key={item.id}\r\n                                className={`flex items-center gap-3 p-3 rounded-xl transition-all cursor-pointer ${isCompleted\r\n                                        ? 'bg-emerald-50 dark:bg-emerald-900/20 border border-emerald-200 dark:border-emerald-800'\r\n                                        : 'bg-slate-50 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-700 hover:border-slate-300 dark:hover:border-slate-600'\r\n                                    }`}\r\n                                onClick={() => {\r\n                                    if (item.action) item.action();\r\n                                    toggleItem(item.id);\r\n                                }}\r\n                            >\r\n                                {/* Step Number / Check */}\r\n                                <div className={`w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 ${isCompleted\r\n                                        ? 'bg-emerald-500 text-white'\r\n                                        : 'bg-slate-200 dark:bg-slate-700 text-slate-500 dark:text-slate-400'\r\n                                    }`}>\r\n                                    {isCompleted\r\n                                        ? <CheckCircle2 className=\"w-5 h-5\" />\r\n                                        : <span className=\"text-sm font-medium\">{index + 1}</span>\r\n                                    }\r\n                                </div>\r\n\r\n                                {/* Content */}\r\n                                <div className=\"flex-1 min-w-0\">\r\n                                    <div className={`font-medium ${isCompleted ? 'text-emerald-700 dark:text-emerald-400' : 'text-slate-700 dark:text-slate-200'\r\n                                        }`}>\r\n                                        {item.label}\r\n                                    </div>\r\n                                    {item.description && (\r\n                                        <div className=\"text-xs text-slate-500 dark:text-slate-400 truncate\">\r\n                                            {item.description}\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n\r\n                                {/* Icon */}\r\n                                <div className={`flex-shrink-0 ${isCompleted ? 'text-emerald-500' : 'text-slate-400'\r\n                                    }`}>\r\n                                    {item.action ? <ChevronRight className=\"w-4 h-4\" /> : item.icon}\r\n                                </div>\r\n                            </div>\r\n                        );\r\n                    })}\r\n                </div>\r\n\r\n                {/* Footer */}\r\n                <div className=\"px-6 py-4 border-t border-slate-100 dark:border-slate-800 bg-slate-50/50 dark:bg-slate-800/30\">\r\n                    {allCompleted ? (\r\n                        <div className=\"flex items-center justify-center gap-2 text-emerald-600 dark:text-emerald-400\">\r\n                            <CheckCircle2 className=\"w-5 h-5\" />\r\n                            <span className=\"font-medium\">All done! You're ready to go.</span>\r\n                        </div>\r\n                    ) : (\r\n                        <div className=\"text-center text-sm text-slate-500 dark:text-slate-400\">\r\n                            Complete the checklist above before {workspaceLocation === 'office' ? 'leaving' : 'starting'}\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\VersionControl\\my-version-manager\\src\\components\\theme-provider.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\VersionControl\\my-version-manager\\src\\components\\theme-toggle.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\VersionControl\\my-version-manager\\src\\hooks\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\VersionControl\\my-version-manager\\src\\hooks\\useActivities.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":13,"column":15,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":18,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[343,346],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[343,346],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":47,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":47,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1285,1288],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1285,1288],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nD:\\VersionControl\\my-version-manager\\src\\hooks\\useActivities.ts:83:9\n  81 |\n  82 |     useEffect(() => {\n> 83 |         fetchActivities();\n     |         ^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  84 |     }, [fetchActivities]);\n  85 |\n  86 |     return {","line":83,"column":9,"nodeType":null,"endLine":83,"endColumn":24}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback } from 'react';\r\nimport { supabase } from '@/lib/supabase';\r\n\r\nexport interface Activity {\r\n    id: string;\r\n    project_id: string;\r\n    user_id: string;\r\n    action_type: string;\r\n    entity_type: string;\r\n    entity_id: string;\r\n    description?: string;\r\n    diff_summary?: string;\r\n    metadata: any;\r\n    created_at: string;\r\n}\r\n\r\n\r\nexport function useActivities(projectId: string | null) {\r\n    const [activities, setActivities] = useState<Activity[]>([]);\r\n    const [loading, setLoading] = useState(false);\r\n\r\n    const fetchActivities = useCallback(async () => {\r\n        if (!projectId) {\r\n            setActivities([]);\r\n            return;\r\n        }\r\n\r\n        setLoading(true);\r\n        const { data, error } = await supabase\r\n            .from('activities')\r\n            .select('*')\r\n            .eq('project_id', projectId)\r\n            .order('created_at', { ascending: false })\r\n            .limit(50); // increased limit\r\n\r\n        if (!error && data) {\r\n            setActivities(data);\r\n        }\r\n        setLoading(false);\r\n    }, [projectId]);\r\n\r\n    const logActivity = async (\r\n        action_type: string,\r\n        entity_type: string,\r\n        entity_id: string,\r\n        description?: string,\r\n        metadata: any = {},\r\n        overrideProjectId?: string,\r\n        diff_summary?: string\r\n    ) => {\r\n        const pid = overrideProjectId || projectId;\r\n        if (!pid) return;\r\n\r\n        const { error } = await supabase.from('activities').insert({\r\n            project_id: pid,\r\n            action_type,\r\n            entity_type,\r\n            entity_id,\r\n            description,\r\n            diff_summary,\r\n            metadata\r\n        });\r\n\r\n        if (!error) {\r\n            // Optimistically add to list (or refetch)\r\n            fetchActivities();\r\n        }\r\n    };\r\n\r\n    const updateActivity = async (activityId: string, updates: { diff_summary?: string }) => {\r\n        const { error } = await supabase\r\n            .from('activities')\r\n            .update(updates)\r\n            .eq('id', activityId);\r\n\r\n        if (!error) {\r\n            fetchActivities();\r\n        }\r\n        return { error };\r\n    };\r\n\r\n    useEffect(() => {\r\n        fetchActivities();\r\n    }, [fetchActivities]);\r\n\r\n    return {\r\n        activities,\r\n        loading,\r\n        fetchActivities,\r\n        logActivity,\r\n        updateActivity\r\n    };\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\VersionControl\\my-version-manager\\src\\hooks\\useContextDumps.ts","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nD:\\VersionControl\\my-version-manager\\src\\hooks\\useContextDumps.ts:92:9\n  90 |\n  91 |     useEffect(() => {\n> 92 |         fetchContextDumps();\n     |         ^^^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  93 |     }, [fetchContextDumps]);\n  94 |\n  95 |     return {","line":92,"column":9,"nodeType":null,"endLine":92,"endColumn":26}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback } from 'react';\r\nimport { supabase } from '@/lib/supabase';\r\n\r\nexport interface ContextDump {\r\n    id: string;\r\n    project_id: string;\r\n    mental_model: string | null;\r\n    next_step_prompt: string | null;\r\n    last_artifacts: Record<string, unknown>;\r\n    workspace_location: 'office' | 'home';\r\n    is_read: boolean;\r\n    created_at: string;\r\n}\r\n\r\nexport interface CreateContextDumpInput {\r\n    mental_model?: string;\r\n    next_step_prompt?: string;\r\n    last_artifacts?: Record<string, unknown>;\r\n    workspace_location?: 'office' | 'home';\r\n}\r\n\r\nexport function useContextDumps(projectId: string | null) {\r\n    const [contextDumps, setContextDumps] = useState<ContextDump[]>([]);\r\n    const [latestDump, setLatestDump] = useState<ContextDump | null>(null);\r\n    const [loading, setLoading] = useState(false);\r\n\r\n    const fetchContextDumps = useCallback(async (limit = 10) => {\r\n        if (!projectId) {\r\n            setContextDumps([]);\r\n            setLatestDump(null);\r\n            return;\r\n        }\r\n\r\n        setLoading(true);\r\n        const { data, error } = await supabase\r\n            .from('context_dumps')\r\n            .select('*')\r\n            .eq('project_id', projectId)\r\n            .order('created_at', { ascending: false })\r\n            .limit(limit);\r\n\r\n        if (!error && data) {\r\n            setContextDumps(data);\r\n            setLatestDump(data[0] || null);\r\n        }\r\n        setLoading(false);\r\n    }, [projectId]);\r\n\r\n    const createContextDump = async (input: CreateContextDumpInput) => {\r\n        if (!projectId) return null;\r\n\r\n        const { data, error } = await supabase\r\n            .from('context_dumps')\r\n            .insert({\r\n                project_id: projectId,\r\n                mental_model: input.mental_model || null,\r\n                next_step_prompt: input.next_step_prompt || null,\r\n                last_artifacts: input.last_artifacts || {},\r\n                workspace_location: input.workspace_location || 'office'\r\n            })\r\n            .select()\r\n            .single();\r\n\r\n        if (!error && data) {\r\n            fetchContextDumps();\r\n            return data as ContextDump;\r\n        }\r\n        return null;\r\n    };\r\n\r\n    const markAsRead = async (dumpId: string) => {\r\n        const { error } = await supabase\r\n            .from('context_dumps')\r\n            .update({ is_read: true })\r\n            .eq('id', dumpId);\r\n\r\n        if (!error) {\r\n            setContextDumps(prev =>\r\n                prev.map(d => d.id === dumpId ? { ...d, is_read: true } : d)\r\n            );\r\n            if (latestDump?.id === dumpId) {\r\n                setLatestDump(prev => prev ? { ...prev, is_read: true } : null);\r\n            }\r\n        }\r\n    };\r\n\r\n    const getUnreadDump = useCallback(() => {\r\n        return contextDumps.find(d => !d.is_read) || null;\r\n    }, [contextDumps]);\r\n\r\n    useEffect(() => {\r\n        fetchContextDumps();\r\n    }, [fetchContextDumps]);\r\n\r\n    return {\r\n        contextDumps,\r\n        latestDump,\r\n        loading,\r\n        fetchContextDumps,\r\n        createContextDump,\r\n        markAsRead,\r\n        getUnreadDump\r\n    };\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\VersionControl\\my-version-manager\\src\\hooks\\useProjects.ts","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nD:\\VersionControl\\my-version-manager\\src\\hooks\\useProjects.ts:36:9\n  34 |\n  35 |     useEffect(() => {\n> 36 |         fetchProjects();\n     |         ^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  37 |     }, [fetchProjects]);\n  38 |\n  39 |     const createProject = async (name: string): Promise<Project | null> => {","line":36,"column":9,"nodeType":null,"endLine":36,"endColumn":22}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useEffect, useCallback } from 'react';\r\nimport { supabase } from '@/lib/supabase';\r\nimport type { Project } from '@/lib/types';\r\nimport { useActivities } from './useActivities';\r\n\r\nexport function useProjects() {\r\n    const [projects, setProjects] = useState<Project[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [error, setError] = useState<string | null>(null);\r\n    const { logActivity } = useActivities(null);\r\n\r\n    const fetchProjects = useCallback(async () => {\r\n        setLoading(true);\r\n        const { data, error } = await supabase\r\n            .from('projects')\r\n            .select('*')\r\n            .order('created_at', { ascending: false });\r\n\r\n        if (error) {\r\n            setError(error.message);\r\n        } else {\r\n            setProjects(\r\n                data.map((p) => ({\r\n                    id: p.id,\r\n                    name: p.name,\r\n                    createdAt: p.created_at,\r\n                }))\r\n            );\r\n        }\r\n        setLoading(false);\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        fetchProjects();\r\n    }, [fetchProjects]);\r\n\r\n    const createProject = async (name: string): Promise<Project | null> => {\r\n        const { data, error } = await supabase\r\n            .from('projects')\r\n            .insert({ name })\r\n            .select()\r\n            .single();\r\n\r\n        if (error) {\r\n            setError(error.message);\r\n            return null;\r\n        }\r\n\r\n        const newProject: Project = {\r\n            id: data.id,\r\n            name: data.name,\r\n            createdAt: data.created_at,\r\n        };\r\n        setProjects((prev) => [newProject, ...prev]);\r\n\r\n        logActivity('create_project', 'project', newProject.id, `Created project: ${name}`, {}, newProject.id);\r\n\r\n        return newProject;\r\n    };\r\n\r\n    const updateProject = async (id: string, name: string): Promise<boolean> => {\r\n        const { error } = await supabase\r\n            .from('projects')\r\n            .update({ name })\r\n            .eq('id', id);\r\n\r\n        if (error) {\r\n            setError(error.message);\r\n            return false;\r\n        }\r\n\r\n        setProjects((prev) =>\r\n            prev.map((p) => (p.id === id ? { ...p, name } : p))\r\n        );\r\n        return true;\r\n    };\r\n\r\n    const deleteProject = async (id: string): Promise<boolean> => {\r\n        const { error } = await supabase.from('projects').delete().eq('id', id);\r\n\r\n        if (error) {\r\n            setError(error.message);\r\n            return false;\r\n        }\r\n\r\n        setProjects((prev) => prev.filter((p) => p.id !== id));\r\n        return true;\r\n    };\r\n\r\n    return {\r\n        projects,\r\n        loading,\r\n        error,\r\n        createProject,\r\n        updateProject,\r\n        deleteProject,\r\n        refetch: fetchProjects,\r\n    };\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\VersionControl\\my-version-manager\\src\\hooks\\useSettings.ts","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nD:\\VersionControl\\my-version-manager\\src\\hooks\\useSettings.ts:30:9\n  28 |\n  29 |     useEffect(() => {\n> 30 |         fetchSettings();\n     |         ^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  31 |     }, [fetchSettings]);\n  32 |\n  33 |     const updateLastProject = async (projectId: string): Promise<boolean> => {","line":30,"column":9,"nodeType":null,"endLine":30,"endColumn":22}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useEffect, useCallback } from 'react';\r\nimport { supabase } from '@/lib/supabase';\r\nimport type { Settings } from '@/lib/types';\r\n\r\nexport function useSettings() {\r\n    const [settings, setSettings] = useState<Settings>({ lastProjectId: null });\r\n    const [loading, setLoading] = useState(true);\r\n    const [error, setError] = useState<string | null>(null);\r\n\r\n    const fetchSettings = useCallback(async () => {\r\n        setLoading(true);\r\n        const { data, error } = await supabase\r\n            .from('settings')\r\n            .select('*')\r\n            .limit(1)\r\n            .single();\r\n\r\n        if (error && error.code !== 'PGRST116') {\r\n            // PGRST116 = no rows, which is fine\r\n            setError(error.message);\r\n        } else if (data) {\r\n            setSettings({ lastProjectId: data.last_project_id });\r\n        }\r\n        setLoading(false);\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        fetchSettings();\r\n    }, [fetchSettings]);\r\n\r\n    const updateLastProject = async (projectId: string): Promise<boolean> => {\r\n        // Check if settings row exists\r\n        const { data: existing } = await supabase\r\n            .from('settings')\r\n            .select('id')\r\n            .limit(1)\r\n            .single();\r\n\r\n        let result;\r\n        if (existing) {\r\n            result = await supabase\r\n                .from('settings')\r\n                .update({ last_project_id: projectId })\r\n                .eq('id', existing.id);\r\n        } else {\r\n            result = await supabase\r\n                .from('settings')\r\n                .insert({ last_project_id: projectId });\r\n        }\r\n\r\n        if (result.error) {\r\n            setError(result.error.message);\r\n            return false;\r\n        }\r\n\r\n        setSettings({ lastProjectId: projectId });\r\n        return true;\r\n    };\r\n\r\n    return {\r\n        settings,\r\n        loading,\r\n        error,\r\n        updateLastProject,\r\n        refetch: fetchSettings,\r\n    };\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\VersionControl\\my-version-manager\\src\\hooks\\useTasks.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\VersionControl\\my-version-manager\\src\\hooks\\useVersions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\VersionControl\\my-version-manager\\src\\lib\\api-utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\VersionControl\\my-version-manager\\src\\lib\\mockData.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\VersionControl\\my-version-manager\\src\\lib\\promptGenerator.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\VersionControl\\my-version-manager\\src\\lib\\supabase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\VersionControl\\my-version-manager\\src\\lib\\types.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":43,"column":15,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":43,"endColumn":18,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[923,926],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[923,926],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"export interface Project {\r\n    id: string;\r\n    name: string;\r\n    createdAt: string;\r\n}\r\n\r\nexport interface Version {\r\n    id: string;\r\n    projectId: string;\r\n    name: string;\r\n    isActive: boolean;\r\n    changelog?: string;\r\n    createdAt: string;\r\n}\r\n\r\nexport interface Task {\r\n    id: string;\r\n    projectId: string;\r\n    versionId: string | null;\r\n    content: string;\r\n    isDone: boolean;\r\n    createdAt: string;\r\n    doneAt: string | null;\r\n    position: number;\r\n    description?: string;\r\n    labels?: string[];\r\n    priority?: 'none' | 'low' | 'medium' | 'high' | 'urgent';\r\n}\r\n\r\nexport interface Settings {\r\n    lastProjectId: string | null;\r\n}\r\n\r\nexport interface Activity {\r\n    id: string;\r\n    project_id: string;\r\n    action_type: string;\r\n    entity_type: string;\r\n    entity_id: string | null;\r\n    description: string | null;\r\n    diff_summary: string | null;\r\n    created_at: string;\r\n    metadata: any;\r\n}\r\n","usedDeprecatedRules":[]}]